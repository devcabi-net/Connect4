var Dl=Object.defineProperty;var xl=(n,e,t)=>e in n?Dl(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ue=(n,e,t)=>xl(n,typeof e!="symbol"?e+"":e,t);function tp(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();let gn=class{constructor(){ue(this,"events",new Map)}on(e,t){return this.events.has(e)||this.events.set(e,[]),this.events.get(e).push(t),this}once(e,t){const r=(...s)=>{t(...s),this.removeListener(e,r)};return this.on(e,r)}emit(e,...t){const r=this.events.get(e);return!r||r.length===0?!1:(r.forEach(s=>{try{s(...t)}catch(i){console.error("Error in event listener for '".concat(e,"':"),i)}}),!0)}removeListener(e,t){const r=this.events.get(e);if(r){const s=r.indexOf(t);s!==-1&&(r.splice(s,1),r.length===0&&this.events.delete(e))}return this}removeAllListeners(e){return e?this.events.delete(e):this.events.clear(),this}listenerCount(e){const t=this.events.get(e);return t?t.length:0}eventNames(){return Array.from(this.events.keys())}};const Ll="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Li=(n=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(n|=0));for(;n--;)e+=Ll[t[n]&63];return e};class Ul extends gn{constructor(t){super();ue(this,"rooms");ue(this,"games");ue(this,"players");ue(this,"gameRegistry");ue(this,"supabaseService");this.rooms=new Map,this.games=new Map,this.players=new Map,this.gameRegistry=new Map,this.supabaseService=t||null,this.supabaseService&&this.setupSupabaseEventHandlers()}setupSupabaseEventHandlers(){this.supabaseService&&(this.supabaseService.on("roomUpdate",t=>{this.handleRoomUpdate(t)}),this.supabaseService.on("playerUpdate",t=>{this.handlePlayerUpdate(t)}),console.log("📡 Supabase event handlers set up"))}handleRoomUpdate(t){switch(console.log("🏠 Room update received:",t),t.eventType){case"INSERT":this.broadcast({type:"game_created",data:{room:t.new},timestamp:new Date});break;case"DELETE":this.broadcast({type:"game_deleted",data:{roomId:t.old.id},timestamp:new Date});break}}handlePlayerUpdate(t){console.log("👤 Player update received:",t),this.broadcast({type:"player_update",data:t,timestamp:new Date})}registerGame(t,r){this.gameRegistry.set(t.id,{constructor:r,config:t}),console.log("🎮 Registered game: ".concat(t.displayName))}getAvailableGames(){return Array.from(this.gameRegistry.values()).map(t=>t.config)}addPlayer(t){this.players.set(t.id,t),this.broadcast({type:"player_joined",data:{player:t},timestamp:new Date,sender:t.id}),console.log("👤 Player joined lobby: ".concat(t.name))}removePlayer(t){const r=this.players.get(t);if(r){for(const s of this.rooms.values())this.leaveRoom(t,s.id);this.players.delete(t),this.broadcast({type:"player_left",data:{playerId:t,playerName:r.name},timestamp:new Date}),console.log("👤 Player left lobby: ".concat(r.name))}}async createRoom(t,r,s){const i=this.gameRegistry.get(r);if(!i)return console.error("❌ Unknown game type: ".concat(r)),null;const a=this.players.get(t);if(!a)return console.error("❌ Player not found: ".concat(t)),null;const o=Li(8),l={id:o,name:s||"".concat(a.name,"'s ").concat(i.config.displayName),gameType:r,players:[{...a,isHost:!0,isReady:!0}],maxPlayers:i.config.maxPlayers,status:"waiting",isPrivate:!1,created:new Date,lastActivity:new Date};if(this.supabaseService&&this.supabaseService.isConnected()){if(!await this.supabaseService.createRoom(l))return console.error("❌ Failed to create room in Supabase"),null}else this.rooms.set(o,l),this.broadcast({type:"game_created",data:{room:l},timestamp:new Date,sender:t});return console.log("🎮 Created room: ".concat(l.name," (").concat(o,")")),o}async joinRoom(t,r){const s=this.players.get(t);if(!s)return console.error("❌ Player not found: ".concat(t)),!1;let i=null;if(this.supabaseService&&this.supabaseService.isConnected()){if(i=await this.supabaseService.getRoom(r),!i)return console.log("❌ Room ".concat(r," not found")),!1;if(i.status!=="waiting")return console.log("❌ Cannot join room ".concat(r," - game already started")),!1;if(i.players.length>=i.maxPlayers)return console.log("❌ Cannot join room ".concat(r," - room is full")),!1;if(i.players.some(o=>o.id===t))return console.log("❌ Player ".concat(t," already in room ").concat(r)),!1;if(!await this.supabaseService.joinRoom(r,{...s,isHost:!1,isReady:!1}))return console.error("❌ Failed to join room in Supabase"),!1}else{if(i=this.rooms.get(r)||null,!i||!s)return!1;if(i.status!=="waiting")return console.log("❌ Cannot join room ".concat(r," - game already started")),!1;if(i.players.length>=i.maxPlayers)return console.log("❌ Cannot join room ".concat(r," - room is full")),!1;if(i.players.some(a=>a.id===t))return console.log("❌ Player ".concat(t," already in room ").concat(r)),!1;i.players.push({...s,isHost:!1,isReady:!1}),i.lastActivity=new Date,this.broadcast({type:"player_joined",data:{room:i,player:s},timestamp:new Date,sender:t})}return console.log("👤 ".concat(s.name," joined room: ").concat(i.name)),!0}leaveRoom(t,r){const s=this.rooms.get(r);if(!s)return!1;const i=s.players.findIndex(o=>o.id===t);if(i===-1)return!1;const a=s.players[i];return s.players.splice(i,1),s.lastActivity=new Date,a.isHost&&s.players.length>0&&(s.players[0].isHost=!0),s.players.length===0&&(this.rooms.delete(r),console.log("🗑️  Deleted empty room: ".concat(s.name))),this.broadcast({type:"player_left",data:{room:s,playerId:t,playerName:a.name},timestamp:new Date}),console.log("👤 ".concat(a.name," left room: ").concat(s.name)),!0}setPlayerReady(t,r,s){const i=this.rooms.get(r);if(!i)return!1;const a=i.players.find(o=>o.id===t);return a?(a.isReady=s,i.lastActivity=new Date,this.broadcast({type:"player_left",data:{room:i,playerId:t,ready:s},timestamp:new Date}),this.canStartGame(r)&&this.startGame(r),!0):!1}startGame(t){const r=this.rooms.get(t);if(!r)return!1;const s=this.gameRegistry.get(r.gameType);if(!s)return!1;if(!this.canStartGame(t))return console.log("❌ Cannot start game in room ".concat(t," - not all players ready")),!1;const i=new s.constructor(t,r.players);return i.on("moveMade",a=>{this.broadcast({type:"move_made",data:{roomId:t,move:a,gameState:i.getState()},timestamp:new Date})}),i.on("gameEnded",a=>{r.status="finished",this.broadcast({type:"game_ended",data:{roomId:t,result:a},timestamp:new Date}),setTimeout(()=>{this.games.delete(t),this.rooms.delete(t)},3e4)}),this.games.set(t,i),r.status="playing",i.startGame()?(this.broadcast({type:"game_started",data:{roomId:t,gameState:i.getState()},timestamp:new Date}),console.log("🚀 Started game in room: ".concat(r.name)),!0):!1}makeMove(t,r,s){const i=this.games.get(r);if(!i)return!1;const a={id:Li(),playerId:t,type:"game_move",data:s,timestamp:new Date,sequence:0};return i.attemptMove(a,t)}async getPublicRooms(){return this.supabaseService&&this.supabaseService.isConnected()?await this.supabaseService.getPublicRooms():Array.from(this.rooms.values()).filter(t=>!t.isPrivate&&t.status==="waiting").sort((t,r)=>r.lastActivity.getTime()-t.lastActivity.getTime())}async getRoom(t){return this.supabaseService&&this.supabaseService.isConnected()?await this.supabaseService.getRoom(t):this.rooms.get(t)||null}getGame(t){return this.games.get(t)||null}getOnlinePlayers(){return Array.from(this.players.values())}canStartGame(t){const r=this.rooms.get(t);if(!r)return!1;const s=this.gameRegistry.get(r.gameType);return s?r.players.length>=s.config.minPlayers&&r.players.every(i=>i.isReady)&&r.status==="waiting":!1}broadcast(t){this.emit("broadcast",t)}getStats(){return{totalPlayers:this.players.size,activeRooms:this.rooms.size,gamesInProgress:Array.from(this.rooms.values()).filter(t=>t.status==="playing").length,registeredGames:this.gameRegistry.size}}}var Gn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fa(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Ps={exports:{}},Ui;function Ml(){return Ui||(Ui=1,function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function s(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function i(l,u,c,f,v){if(typeof c!="function")throw new TypeError("The listener must be a function");var T=new s(c,f||l,v),N=t?t+u:u;return l._events[N]?l._events[N].fn?l._events[N]=[l._events[N],T]:l._events[N].push(T):(l._events[N]=T,l._eventsCount++),l}function a(l,u){--l._eventsCount===0?l._events=new r:delete l._events[u]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],c,f;if(this._eventsCount===0)return u;for(f in c=this._events)e.call(c,f)&&u.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},o.prototype.listeners=function(u){var c=t?t+u:u,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var v=0,T=f.length,N=new Array(T);v<T;v++)N[v]=f[v].fn;return N},o.prototype.listenerCount=function(u){var c=t?t+u:u,f=this._events[c];return f?f.fn?1:f.length:0},o.prototype.emit=function(u,c,f,v,T,N){var D=t?t+u:u;if(!this._events[D])return!1;var I=this._events[D],F=arguments.length,q,U;if(I.fn){switch(I.once&&this.removeListener(u,I.fn,void 0,!0),F){case 1:return I.fn.call(I.context),!0;case 2:return I.fn.call(I.context,c),!0;case 3:return I.fn.call(I.context,c,f),!0;case 4:return I.fn.call(I.context,c,f,v),!0;case 5:return I.fn.call(I.context,c,f,v,T),!0;case 6:return I.fn.call(I.context,c,f,v,T,N),!0}for(U=1,q=new Array(F-1);U<F;U++)q[U-1]=arguments[U];I.fn.apply(I.context,q)}else{var Y=I.length,fe;for(U=0;U<Y;U++)switch(I[U].once&&this.removeListener(u,I[U].fn,void 0,!0),F){case 1:I[U].fn.call(I[U].context);break;case 2:I[U].fn.call(I[U].context,c);break;case 3:I[U].fn.call(I[U].context,c,f);break;case 4:I[U].fn.call(I[U].context,c,f,v);break;default:if(!q)for(fe=1,q=new Array(F-1);fe<F;fe++)q[fe-1]=arguments[fe];I[U].fn.apply(I[U].context,q)}}return!0},o.prototype.on=function(u,c,f){return i(this,u,c,f,!1)},o.prototype.once=function(u,c,f){return i(this,u,c,f,!0)},o.prototype.removeListener=function(u,c,f,v){var T=t?t+u:u;if(!this._events[T])return this;if(!c)return a(this,T),this;var N=this._events[T];if(N.fn)N.fn===c&&(!v||N.once)&&(!f||N.context===f)&&a(this,T);else{for(var D=0,I=[],F=N.length;D<F;D++)(N[D].fn!==c||v&&!N[D].once||f&&N[D].context!==f)&&I.push(N[D]);I.length?this._events[T]=I.length===1?I[0]:I:a(this,T)}return this},o.prototype.removeAllListeners=function(u){var c;return u?(c=t?t+u:u,this._events[c]&&a(this,c)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,n.exports=o}(Ps)),Ps.exports}var jl=Ml(),$l=fa(jl),ce;(function(n){n.assertEqual=s=>s;function e(s){}n.assertIs=e;function t(s){throw new Error}n.assertNever=t,n.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},n.getValidEnumValues=s=>{const i=n.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(const o of i)a[o]=s[o];return n.objectValues(a)},n.objectValues=s=>n.objectKeys(s).map(function(i){return s[i]}),n.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},n.find=(s,i)=>{for(const a of s)if(i(a))return a},n.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(a=>typeof a=="string"?"'".concat(a,"'"):a).join(i)}n.joinValues=r,n.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(ce||(ce={}));var Fs;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(Fs||(Fs={}));const j=ce.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Mt=n=>{switch(typeof n){case"undefined":return j.undefined;case"string":return j.string;case"number":return isNaN(n)?j.nan:j.number;case"boolean":return j.boolean;case"function":return j.function;case"bigint":return j.bigint;case"symbol":return j.symbol;case"object":return Array.isArray(n)?j.array:n===null?j.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?j.promise:typeof Map<"u"&&n instanceof Map?j.map:typeof Set<"u"&&n instanceof Set?j.set:typeof Date<"u"&&n instanceof Date?j.date:j.object;default:return j.unknown}},R=ce.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Cl=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:");class ze extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)r._errors.push(t(a));else{let o=r,l=0;for(;l<a.path.length;){const u=a.path[l];l===a.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(t(a))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return s(this),r}static assert(e){if(!(e instanceof ze))throw new Error("Not a ZodError: ".concat(e))}toString(){return this.message}get message(){return JSON.stringify(this.issues,ce.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}ze.create=n=>new ze(n);const wr=(n,e)=>{let t;switch(n.code){case R.invalid_type:n.received===j.undefined?t="Required":t="Expected ".concat(n.expected,", received ").concat(n.received);break;case R.invalid_literal:t="Invalid literal value, expected ".concat(JSON.stringify(n.expected,ce.jsonStringifyReplacer));break;case R.unrecognized_keys:t="Unrecognized key(s) in object: ".concat(ce.joinValues(n.keys,", "));break;case R.invalid_union:t="Invalid input";break;case R.invalid_union_discriminator:t="Invalid discriminator value. Expected ".concat(ce.joinValues(n.options));break;case R.invalid_enum_value:t="Invalid enum value. Expected ".concat(ce.joinValues(n.options),", received '").concat(n.received,"'");break;case R.invalid_arguments:t="Invalid function arguments";break;case R.invalid_return_type:t="Invalid function return type";break;case R.invalid_date:t="Invalid date";break;case R.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t='Invalid input: must include "'.concat(n.validation.includes,'"'),typeof n.validation.position=="number"&&(t="".concat(t," at one or more positions greater than or equal to ").concat(n.validation.position))):"startsWith"in n.validation?t='Invalid input: must start with "'.concat(n.validation.startsWith,'"'):"endsWith"in n.validation?t='Invalid input: must end with "'.concat(n.validation.endsWith,'"'):ce.assertNever(n.validation):n.validation!=="regex"?t="Invalid ".concat(n.validation):t="Invalid";break;case R.too_small:n.type==="array"?t="Array must contain ".concat(n.exact?"exactly":n.inclusive?"at least":"more than"," ").concat(n.minimum," element(s)"):n.type==="string"?t="String must contain ".concat(n.exact?"exactly":n.inclusive?"at least":"over"," ").concat(n.minimum," character(s)"):n.type==="number"?t="Number must be ".concat(n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than ").concat(n.minimum):n.type==="date"?t="Date must be ".concat(n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than ").concat(new Date(Number(n.minimum))):t="Invalid input";break;case R.too_big:n.type==="array"?t="Array must contain ".concat(n.exact?"exactly":n.inclusive?"at most":"less than"," ").concat(n.maximum," element(s)"):n.type==="string"?t="String must contain ".concat(n.exact?"exactly":n.inclusive?"at most":"under"," ").concat(n.maximum," character(s)"):n.type==="number"?t="Number must be ".concat(n.exact?"exactly":n.inclusive?"less than or equal to":"less than"," ").concat(n.maximum):n.type==="bigint"?t="BigInt must be ".concat(n.exact?"exactly":n.inclusive?"less than or equal to":"less than"," ").concat(n.maximum):n.type==="date"?t="Date must be ".concat(n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"," ").concat(new Date(Number(n.maximum))):t="Invalid input";break;case R.custom:t="Invalid input";break;case R.invalid_intersection_types:t="Intersection results could not be merged";break;case R.not_multiple_of:t="Number must be a multiple of ".concat(n.multipleOf);break;case R.not_finite:t="Number must be finite";break;default:t=e.defaultError,ce.assertNever(n)}return{message:t}};let pa=wr;function Bl(n){pa=n}function zn(){return pa}const Jn=n=>{const{data:e,path:t,errorMaps:r,issueData:s}=n,i=[...t,...s.path||[]],a={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const l=r.filter(u=>!!u).slice().reverse();for(const u of l)o=u(a,{data:e,defaultError:o}).message;return{...s,path:i,message:o}},Gl=[];function M(n,e){const t=zn(),r=Jn({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===wr?void 0:wr].filter(s=>!!s)});n.common.issues.push(r)}class xe{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const s of t){if(s.status==="aborted")return W;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const s of t){const i=await s.key,a=await s.value;r.push({key:i,value:a})}return xe.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const s of t){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return W;i.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(r[i.value]=a.value)}return{status:e.value,value:r}}}const W=Object.freeze({status:"aborted"}),yr=n=>({status:"dirty",value:n}),Ce=n=>({status:"valid",value:n}),qs=n=>n.status==="aborted",Vs=n=>n.status==="dirty",Yr=n=>n.status==="valid",Xr=n=>typeof Promise<"u"&&n instanceof Promise;function Yn(n,e,t,r){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(n)}function ga(n,e,t,r,s){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(n,t),t}var B;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(B||(B={}));var Fr,qr;class ht{constructor(e,t,r,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Mi=(n,e)=>{if(Yr(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new ze(n.common.issues);return this._error=t,this._error}}};function te(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:s}=n;if(e&&(t||r))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return e?{errorMap:e,description:s}:{errorMap:(a,o)=>{var l,u;const{message:c}=n;return a.code==="invalid_enum_value"?{message:c!=null?c:o.defaultError}:typeof o.data>"u"?{message:(l=c!=null?c:r)!==null&&l!==void 0?l:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(u=c!=null?c:t)!==null&&u!==void 0?u:o.defaultError}},description:s}}class re{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Mt(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Mt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new xe,ctx:{common:e.parent.common,data:e.data,parsedType:Mt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Xr(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const s={common:{issues:[],async:(r=t==null?void 0:t.async)!==null&&r!==void 0?r:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Mt(e)},i=this._parseSync({data:e,path:s.path,parent:s});return Mi(s,i)}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Mt(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(Xr(s)?s:Promise.resolve(s));return Mi(r,i)}refine(e,t){const r=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,i)=>{const a=e(s),o=()=>i.addIssue({code:R.custom,...r(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,t){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof t=="function"?t(r,s):t),!1))}_refinement(e){return new at({schema:this,typeName:K.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return dt.create(this,this._def)}nullable(){return Ht.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return it.create(this,this._def)}promise(){return Sr.create(this,this._def)}or(e){return rn.create([this,e],this._def)}and(e){return nn.create(this,e,this._def)}transform(e){return new at({...te(this._def),schema:this,typeName:K.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new cn({...te(this._def),innerType:this,defaultValue:t,typeName:K.ZodDefault})}brand(){return new li({typeName:K.ZodBranded,type:this,...te(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new un({...te(this._def),innerType:this,catchValue:t,typeName:K.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return mn.create(this,e)}readonly(){return dn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Hl=/^c[^\s-]{8,}$/i,Fl=/^[0-9a-z]+$/,ql=/^[0-9A-HJKMNP-TV-Z]{26}$/,Vl=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Kl=/^[a-z0-9_-]{21}$/i,Zl=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Wl=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,zl="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Ds;const Jl=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Yl=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,Xl=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,ma="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Ql=new RegExp("^".concat(ma,"$"));function va(n){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return n.precision?e="".concat(e,"\\.\\d{").concat(n.precision,"}"):n.precision==null&&(e="".concat(e,"(\\.\\d+)?")),e}function ec(n){return new RegExp("^".concat(va(n),"$"))}function _a(n){let e="".concat(ma,"T").concat(va(n));const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e="".concat(e,"(").concat(t.join("|"),")"),new RegExp("^".concat(e,"$"))}function tc(n,e){return!!((e==="v4"||!e)&&Jl.test(n)||(e==="v6"||!e)&&Yl.test(n))}class st extends re{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==j.string){const i=this._getOrReturnCtx(e);return M(i,{code:R.invalid_type,expected:j.string,received:i.parsedType}),W}const r=new xe;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),M(s,{code:R.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),M(s,{code:R.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const a=e.data.length>i.value,o=e.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(e,s),a?M(s,{code:R.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&M(s,{code:R.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")Wl.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"email",code:R.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")Ds||(Ds=new RegExp(zl,"u")),Ds.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"emoji",code:R.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")Vl.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"uuid",code:R.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")Kl.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"nanoid",code:R.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")Hl.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"cuid",code:R.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")Fl.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"cuid2",code:R.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")ql.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"ulid",code:R.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch(a){s=this._getOrReturnCtx(e,s),M(s,{validation:"url",code:R.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"regex",code:R.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),M(s,{code:R.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),M(s,{code:R.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),M(s,{code:R.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?_a(i).test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{code:R.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?Ql.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{code:R.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?ec(i).test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{code:R.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?Zl.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"duration",code:R.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?tc(e.data,i.version)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"ip",code:R.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?Xl.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"base64",code:R.invalid_string,message:i.message}),r.dirty()):ce.assertNever(i);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(s=>e.test(s),{validation:t,code:R.invalid_string,...B.errToObj(r)})}_addCheck(e){return new st({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...B.errToObj(e)})}url(e){return this._addCheck({kind:"url",...B.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...B.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...B.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...B.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...B.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...B.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...B.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...B.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...B.errToObj(e)})}datetime(e){var t,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,local:(r=e==null?void 0:e.local)!==null&&r!==void 0?r:!1,...B.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...B.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...B.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...B.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...B.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...B.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...B.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...B.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...B.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...B.errToObj(t)})}nonempty(e){return this.min(1,B.errToObj(e))}trim(){return new st({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new st({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new st({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}st.create=n=>{var e;return new st({checks:[],typeName:K.ZodString,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...te(n)})};function rc(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=t>r?t:r,i=parseInt(n.toFixed(s).replace(".","")),a=parseInt(e.toFixed(s).replace(".",""));return i%a/Math.pow(10,s)}class Ct extends re{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==j.number){const i=this._getOrReturnCtx(e);return M(i,{code:R.invalid_type,expected:j.number,received:i.parsedType}),W}let r;const s=new xe;for(const i of this._def.checks)i.kind==="int"?ce.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),M(r,{code:R.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),M(r,{code:R.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),M(r,{code:R.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?rc(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),M(r,{code:R.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),M(r,{code:R.not_finite,message:i.message}),s.dirty()):ce.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,B.toString(t))}gt(e,t){return this.setLimit("min",e,!1,B.toString(t))}lte(e,t){return this.setLimit("max",e,!0,B.toString(t))}lt(e,t){return this.setLimit("max",e,!1,B.toString(t))}setLimit(e,t,r,s){return new Ct({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:B.toString(s)}]})}_addCheck(e){return new Ct({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:B.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:B.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:B.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:B.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:B.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:B.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:B.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:B.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:B.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ce.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Ct.create=n=>new Ct({checks:[],typeName:K.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...te(n)});class Bt extends re{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==j.bigint){const i=this._getOrReturnCtx(e);return M(i,{code:R.invalid_type,expected:j.bigint,received:i.parsedType}),W}let r;const s=new xe;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),M(r,{code:R.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),M(r,{code:R.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),M(r,{code:R.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):ce.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,B.toString(t))}gt(e,t){return this.setLimit("min",e,!1,B.toString(t))}lte(e,t){return this.setLimit("max",e,!0,B.toString(t))}lt(e,t){return this.setLimit("max",e,!1,B.toString(t))}setLimit(e,t,r,s){return new Bt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:B.toString(s)}]})}_addCheck(e){return new Bt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:B.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:B.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:B.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:B.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:B.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Bt.create=n=>{var e;return new Bt({checks:[],typeName:K.ZodBigInt,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...te(n)})};class Qr extends re{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==j.boolean){const r=this._getOrReturnCtx(e);return M(r,{code:R.invalid_type,expected:j.boolean,received:r.parsedType}),W}return Ce(e.data)}}Qr.create=n=>new Qr({typeName:K.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...te(n)});class sr extends re{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==j.date){const i=this._getOrReturnCtx(e);return M(i,{code:R.invalid_type,expected:j.date,received:i.parsedType}),W}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return M(i,{code:R.invalid_date}),W}const r=new xe;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),M(s,{code:R.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),M(s,{code:R.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):ce.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new sr({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:B.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:B.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}sr.create=n=>new sr({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:K.ZodDate,...te(n)});class Xn extends re{_parse(e){if(this._getType(e)!==j.symbol){const r=this._getOrReturnCtx(e);return M(r,{code:R.invalid_type,expected:j.symbol,received:r.parsedType}),W}return Ce(e.data)}}Xn.create=n=>new Xn({typeName:K.ZodSymbol,...te(n)});class en extends re{_parse(e){if(this._getType(e)!==j.undefined){const r=this._getOrReturnCtx(e);return M(r,{code:R.invalid_type,expected:j.undefined,received:r.parsedType}),W}return Ce(e.data)}}en.create=n=>new en({typeName:K.ZodUndefined,...te(n)});class tn extends re{_parse(e){if(this._getType(e)!==j.null){const r=this._getOrReturnCtx(e);return M(r,{code:R.invalid_type,expected:j.null,received:r.parsedType}),W}return Ce(e.data)}}tn.create=n=>new tn({typeName:K.ZodNull,...te(n)});class Er extends re{constructor(){super(...arguments),this._any=!0}_parse(e){return Ce(e.data)}}Er.create=n=>new Er({typeName:K.ZodAny,...te(n)});class rr extends re{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ce(e.data)}}rr.create=n=>new rr({typeName:K.ZodUnknown,...te(n)});class Nt extends re{_parse(e){const t=this._getOrReturnCtx(e);return M(t,{code:R.invalid_type,expected:j.never,received:t.parsedType}),W}}Nt.create=n=>new Nt({typeName:K.ZodNever,...te(n)});class Qn extends re{_parse(e){if(this._getType(e)!==j.undefined){const r=this._getOrReturnCtx(e);return M(r,{code:R.invalid_type,expected:j.void,received:r.parsedType}),W}return Ce(e.data)}}Qn.create=n=>new Qn({typeName:K.ZodVoid,...te(n)});class it extends re{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),s=this._def;if(t.parsedType!==j.array)return M(t,{code:R.invalid_type,expected:j.array,received:t.parsedType}),W;if(s.exactLength!==null){const a=t.data.length>s.exactLength.value,o=t.data.length<s.exactLength.value;(a||o)&&(M(t,{code:a?R.too_big:R.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(M(t,{code:R.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(M(t,{code:R.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((a,o)=>s.type._parseAsync(new ht(t,a,t.path,o)))).then(a=>xe.mergeArray(r,a));const i=[...t.data].map((a,o)=>s.type._parseSync(new ht(t,a,t.path,o)));return xe.mergeArray(r,i)}get element(){return this._def.type}min(e,t){return new it({...this._def,minLength:{value:e,message:B.toString(t)}})}max(e,t){return new it({...this._def,maxLength:{value:e,message:B.toString(t)}})}length(e,t){return new it({...this._def,exactLength:{value:e,message:B.toString(t)}})}nonempty(e){return this.min(1,e)}}it.create=(n,e)=>new it({type:n,minLength:null,maxLength:null,exactLength:null,typeName:K.ZodArray,...te(e)});function mr(n){if(n instanceof we){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=dt.create(mr(r))}return new we({...n._def,shape:()=>e})}else return n instanceof it?new it({...n._def,type:mr(n.element)}):n instanceof dt?dt.create(mr(n.unwrap())):n instanceof Ht?Ht.create(mr(n.unwrap())):n instanceof ft?ft.create(n.items.map(e=>mr(e))):n}class we extends re{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=ce.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==j.object){const u=this._getOrReturnCtx(e);return M(u,{code:R.invalid_type,expected:j.object,received:u.parsedType}),W}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof Nt&&this._def.unknownKeys==="strip"))for(const u in s.data)a.includes(u)||o.push(u);const l=[];for(const u of a){const c=i[u],f=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new ht(s,f,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof Nt){const u=this._def.unknownKeys;if(u==="passthrough")for(const c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")o.length>0&&(M(s,{code:R.unrecognized_keys,keys:o}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const c of o){const f=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new ht(s,f,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const u=[];for(const c of l){const f=await c.key,v=await c.value;u.push({key:f,value:v,alwaysSet:c.alwaysSet})}return u}).then(u=>xe.mergeObjectSync(r,u)):xe.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return B.errToObj,new we({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{var s,i,a,o;const l=(a=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,t,r).message)!==null&&a!==void 0?a:r.defaultError;return t.code==="unrecognized_keys"?{message:(o=B.errToObj(e).message)!==null&&o!==void 0?o:l}:{message:l}}}:{}})}strip(){return new we({...this._def,unknownKeys:"strip"})}passthrough(){return new we({...this._def,unknownKeys:"passthrough"})}extend(e){return new we({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new we({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:K.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new we({...this._def,catchall:e})}pick(e){const t={};return ce.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new we({...this._def,shape:()=>t})}omit(e){const t={};return ce.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new we({...this._def,shape:()=>t})}deepPartial(){return mr(this)}partial(e){const t={};return ce.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?t[r]=s:t[r]=s.optional()}),new we({...this._def,shape:()=>t})}required(e){const t={};return ce.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof dt;)i=i._def.innerType;t[r]=i}}),new we({...this._def,shape:()=>t})}keyof(){return ya(ce.objectKeys(this.shape))}}we.create=(n,e)=>new we({shape:()=>n,unknownKeys:"strip",catchall:Nt.create(),typeName:K.ZodObject,...te(e)});we.strictCreate=(n,e)=>new we({shape:()=>n,unknownKeys:"strict",catchall:Nt.create(),typeName:K.ZodObject,...te(e)});we.lazycreate=(n,e)=>new we({shape:n,unknownKeys:"strip",catchall:Nt.create(),typeName:K.ZodObject,...te(e)});class rn extends re{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new ze(o.ctx.common.issues));return M(t,{code:R.invalid_union,unionErrors:a}),W}if(t.common.async)return Promise.all(r.map(async i=>{const a={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const l of r){const u={...t,common:{...t.common,issues:[]},parent:null},c=l._parseSync({data:t.data,path:t.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!i&&(i={result:c,ctx:u}),u.common.issues.length&&a.push(u.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(l=>new ze(l));return M(t,{code:R.invalid_union,unionErrors:o}),W}}get options(){return this._def.options}}rn.create=(n,e)=>new rn({options:n,typeName:K.ZodUnion,...te(e)});const Tt=n=>n instanceof an?Tt(n.schema):n instanceof at?Tt(n.innerType()):n instanceof on?[n.value]:n instanceof Gt?n.options:n instanceof ln?ce.objectValues(n.enum):n instanceof cn?Tt(n._def.innerType):n instanceof en?[void 0]:n instanceof tn?[null]:n instanceof dt?[void 0,...Tt(n.unwrap())]:n instanceof Ht?[null,...Tt(n.unwrap())]:n instanceof li||n instanceof dn?Tt(n.unwrap()):n instanceof un?Tt(n._def.innerType):[];class as extends re{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==j.object)return M(t,{code:R.invalid_type,expected:j.object,received:t.parsedType}),W;const r=this.discriminator,s=t.data[r],i=this.optionsMap.get(s);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(M(t,{code:R.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),W)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const s=new Map;for(const i of t){const a=Tt(i.shape[e]);if(!a.length)throw new Error("A discriminator value for key `".concat(e,"` could not be extracted from all schema options"));for(const o of a){if(s.has(o))throw new Error("Discriminator property ".concat(String(e)," has duplicate value ").concat(String(o)));s.set(o,i)}}return new as({typeName:K.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...te(r)})}}function Ks(n,e){const t=Mt(n),r=Mt(e);if(n===e)return{valid:!0,data:n};if(t===j.object&&r===j.object){const s=ce.objectKeys(e),i=ce.objectKeys(n).filter(o=>s.indexOf(o)!==-1),a={...n,...e};for(const o of i){const l=Ks(n[o],e[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(t===j.array&&r===j.array){if(n.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<n.length;i++){const a=n[i],o=e[i],l=Ks(a,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return t===j.date&&r===j.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class nn extends re{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=(i,a)=>{if(qs(i)||qs(a))return W;const o=Ks(i.value,a.value);return o.valid?((Vs(i)||Vs(a))&&t.dirty(),{status:t.value,value:o.data}):(M(r,{code:R.invalid_intersection_types}),W)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}nn.create=(n,e,t)=>new nn({left:n,right:e,typeName:K.ZodIntersection,...te(t)});class ft extends re{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==j.array)return M(r,{code:R.invalid_type,expected:j.array,received:r.parsedType}),W;if(r.data.length<this._def.items.length)return M(r,{code:R.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),W;!this._def.rest&&r.data.length>this._def.items.length&&(M(r,{code:R.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...r.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new ht(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(i).then(a=>xe.mergeArray(t,a)):xe.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new ft({...this._def,rest:e})}}ft.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ft({items:n,typeName:K.ZodTuple,rest:null,...te(e)})};class sn extends re{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==j.object)return M(r,{code:R.invalid_type,expected:j.object,received:r.parsedType}),W;const s=[],i=this._def.keyType,a=this._def.valueType;for(const o in r.data)s.push({key:i._parse(new ht(r,o,r.path,o)),value:a._parse(new ht(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?xe.mergeObjectAsync(t,s):xe.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof re?new sn({keyType:e,valueType:t,typeName:K.ZodRecord,...te(r)}):new sn({keyType:st.create(),valueType:e,typeName:K.ZodRecord,...te(t)})}}class es extends re{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==j.map)return M(r,{code:R.invalid_type,expected:j.map,received:r.parsedType}),W;const s=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([o,l],u)=>({key:s._parse(new ht(r,o,r.path,[u,"key"])),value:i._parse(new ht(r,l,r.path,[u,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return W;(u.status==="dirty"||c.status==="dirty")&&t.dirty(),o.set(u.value,c.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const l of a){const u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return W;(u.status==="dirty"||c.status==="dirty")&&t.dirty(),o.set(u.value,c.value)}return{status:t.value,value:o}}}}es.create=(n,e,t)=>new es({valueType:e,keyType:n,typeName:K.ZodMap,...te(t)});class ir extends re{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==j.set)return M(r,{code:R.invalid_type,expected:j.set,received:r.parsedType}),W;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(M(r,{code:R.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(M(r,{code:R.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const i=this._def.valueType;function a(l){const u=new Set;for(const c of l){if(c.status==="aborted")return W;c.status==="dirty"&&t.dirty(),u.add(c.value)}return{status:t.value,value:u}}const o=[...r.data.values()].map((l,u)=>i._parse(new ht(r,l,r.path,u)));return r.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(e,t){return new ir({...this._def,minSize:{value:e,message:B.toString(t)}})}max(e,t){return new ir({...this._def,maxSize:{value:e,message:B.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ir.create=(n,e)=>new ir({valueType:n,minSize:null,maxSize:null,typeName:K.ZodSet,...te(e)});class br extends re{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==j.function)return M(t,{code:R.invalid_type,expected:j.function,received:t.parsedType}),W;function r(o,l){return Jn({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,zn(),wr].filter(u=>!!u),issueData:{code:R.invalid_arguments,argumentsError:l}})}function s(o,l){return Jn({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,zn(),wr].filter(u=>!!u),issueData:{code:R.invalid_return_type,returnTypeError:l}})}const i={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof Sr){const o=this;return Ce(async function(...l){const u=new ze([]),c=await o._def.args.parseAsync(l,i).catch(T=>{throw u.addIssue(r(l,T)),u}),f=await Reflect.apply(a,this,c);return await o._def.returns._def.type.parseAsync(f,i).catch(T=>{throw u.addIssue(s(f,T)),u})})}else{const o=this;return Ce(function(...l){const u=o._def.args.safeParse(l,i);if(!u.success)throw new ze([r(l,u.error)]);const c=Reflect.apply(a,this,u.data),f=o._def.returns.safeParse(c,i);if(!f.success)throw new ze([s(c,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new br({...this._def,args:ft.create(e).rest(rr.create())})}returns(e){return new br({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new br({args:e||ft.create([]).rest(rr.create()),returns:t||rr.create(),typeName:K.ZodFunction,...te(r)})}}class an extends re{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}an.create=(n,e)=>new an({getter:n,typeName:K.ZodLazy,...te(e)});class on extends re{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return M(t,{received:t.data,code:R.invalid_literal,expected:this._def.value}),W}return{status:"valid",value:e.data}}get value(){return this._def.value}}on.create=(n,e)=>new on({value:n,typeName:K.ZodLiteral,...te(e)});function ya(n,e){return new Gt({values:n,typeName:K.ZodEnum,...te(e)})}class Gt extends re{constructor(){super(...arguments),Fr.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return M(t,{expected:ce.joinValues(r),received:t.parsedType,code:R.invalid_type}),W}if(Yn(this,Fr)||ga(this,Fr,new Set(this._def.values)),!Yn(this,Fr).has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return M(t,{received:t.data,code:R.invalid_enum_value,options:r}),W}return Ce(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Gt.create(e,{...this._def,...t})}exclude(e,t=this._def){return Gt.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}Fr=new WeakMap;Gt.create=ya;class ln extends re{constructor(){super(...arguments),qr.set(this,void 0)}_parse(e){const t=ce.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==j.string&&r.parsedType!==j.number){const s=ce.objectValues(t);return M(r,{expected:ce.joinValues(s),received:r.parsedType,code:R.invalid_type}),W}if(Yn(this,qr)||ga(this,qr,new Set(ce.getValidEnumValues(this._def.values))),!Yn(this,qr).has(e.data)){const s=ce.objectValues(t);return M(r,{received:r.data,code:R.invalid_enum_value,options:s}),W}return Ce(e.data)}get enum(){return this._def.values}}qr=new WeakMap;ln.create=(n,e)=>new ln({values:n,typeName:K.ZodNativeEnum,...te(e)});class Sr extends re{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==j.promise&&t.common.async===!1)return M(t,{code:R.invalid_type,expected:j.promise,received:t.parsedType}),W;const r=t.parsedType===j.promise?t.data:Promise.resolve(t.data);return Ce(r.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Sr.create=(n,e)=>new Sr({type:n,typeName:K.ZodPromise,...te(e)});class at extends re{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===K.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:a=>{M(r,a),a.fatal?t.abort():t.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(r.data,i);if(r.common.async)return Promise.resolve(a).then(async o=>{if(t.value==="aborted")return W;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?W:l.status==="dirty"||t.value==="dirty"?yr(l.value):l});{if(t.value==="aborted")return W;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?W:o.status==="dirty"||t.value==="dirty"?yr(o.value):o}}if(s.type==="refinement"){const a=o=>{const l=s.refinement(o,i);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?W:(o.status==="dirty"&&t.dirty(),a(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?W:(o.status==="dirty"&&t.dirty(),a(o.value).then(()=>({status:t.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Yr(a))return a;const o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>Yr(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:t.value,value:o})):a);ce.assertNever(s)}}at.create=(n,e,t)=>new at({schema:n,typeName:K.ZodEffects,effect:e,...te(t)});at.createWithPreprocess=(n,e,t)=>new at({schema:e,effect:{type:"preprocess",transform:n},typeName:K.ZodEffects,...te(t)});class dt extends re{_parse(e){return this._getType(e)===j.undefined?Ce(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}dt.create=(n,e)=>new dt({innerType:n,typeName:K.ZodOptional,...te(e)});class Ht extends re{_parse(e){return this._getType(e)===j.null?Ce(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ht.create=(n,e)=>new Ht({innerType:n,typeName:K.ZodNullable,...te(e)});class cn extends re{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===j.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}cn.create=(n,e)=>new cn({innerType:n,typeName:K.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...te(e)});class un extends re{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Xr(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ze(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ze(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}un.create=(n,e)=>new un({innerType:n,typeName:K.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...te(e)});class ts extends re{_parse(e){if(this._getType(e)!==j.nan){const r=this._getOrReturnCtx(e);return M(r,{code:R.invalid_type,expected:j.nan,received:r.parsedType}),W}return{status:"valid",value:e.data}}}ts.create=n=>new ts({typeName:K.ZodNaN,...te(n)});const nc=Symbol("zod_brand");class li extends re{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class mn extends re{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?W:i.status==="dirty"?(t.dirty(),yr(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?W:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,t){return new mn({in:e,out:t,typeName:K.ZodPipeline})}}class dn extends re{_parse(e){const t=this._def.innerType._parse(e),r=s=>(Yr(s)&&(s.value=Object.freeze(s.value)),s);return Xr(t)?t.then(s=>r(s)):r(t)}unwrap(){return this._def.innerType}}dn.create=(n,e)=>new dn({innerType:n,typeName:K.ZodReadonly,...te(e)});function ci(n,e={},t){return n?Er.create().superRefine((r,s)=>{var i,a;if(!n(r)){const o=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,l=(a=(i=o.fatal)!==null&&i!==void 0?i:t)!==null&&a!==void 0?a:!0,u=typeof o=="string"?{message:o}:o;s.addIssue({code:"custom",...u,fatal:l})}}):Er.create()}const sc={object:we.lazycreate};var K;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(K||(K={}));const ic=(n,e={message:"Input not instance of ".concat(n.name)})=>ci(t=>t instanceof n,e),_=st.create,G=Ct.create,ac=ts.create,ba=Bt.create,J=Qr.create,oc=sr.create,lc=Xn.create,cc=en.create,os=tn.create,uc=Er.create,hn=rr.create,dc=Nt.create,hc=Qn.create,le=it.create,x=we.create,fc=we.strictCreate,ui=rn.create,pc=as.create,gc=nn.create,mc=ft.create,vc=sn.create,_c=es.create,yc=ir.create,bc=br.create,wc=an.create,ke=on.create,Ec=Gt.create,Ir=ln.create,Sc=Sr.create,ji=at.create,wa=dt.create,Tc=Ht.create,Ea=at.createWithPreprocess,Ac=mn.create,Ic=()=>_().optional(),kc=()=>G().optional(),Oc=()=>J().optional(),Rc={string:n=>st.create({...n,coerce:!0}),number:n=>Ct.create({...n,coerce:!0}),boolean:n=>Qr.create({...n,coerce:!0}),bigint:n=>Bt.create({...n,coerce:!0}),date:n=>sr.create({...n,coerce:!0})},Nc=W;var L=Object.freeze({__proto__:null,defaultErrorMap:wr,setErrorMap:Bl,getErrorMap:zn,makeIssue:Jn,EMPTY_PATH:Gl,addIssueToContext:M,ParseStatus:xe,INVALID:W,DIRTY:yr,OK:Ce,isAborted:qs,isDirty:Vs,isValid:Yr,isAsync:Xr,get util(){return ce},get objectUtil(){return Fs},ZodParsedType:j,getParsedType:Mt,ZodType:re,datetimeRegex:_a,ZodString:st,ZodNumber:Ct,ZodBigInt:Bt,ZodBoolean:Qr,ZodDate:sr,ZodSymbol:Xn,ZodUndefined:en,ZodNull:tn,ZodAny:Er,ZodUnknown:rr,ZodNever:Nt,ZodVoid:Qn,ZodArray:it,ZodObject:we,ZodUnion:rn,ZodDiscriminatedUnion:as,ZodIntersection:nn,ZodTuple:ft,ZodRecord:sn,ZodMap:es,ZodSet:ir,ZodFunction:br,ZodLazy:an,ZodLiteral:on,ZodEnum:Gt,ZodNativeEnum:ln,ZodPromise:Sr,ZodEffects:at,ZodTransformer:at,ZodOptional:dt,ZodNullable:Ht,ZodDefault:cn,ZodCatch:un,ZodNaN:ts,BRAND:nc,ZodBranded:li,ZodPipeline:mn,ZodReadonly:dn,custom:ci,Schema:re,ZodSchema:re,late:sc,get ZodFirstPartyTypeKind(){return K},coerce:Rc,any:uc,array:le,bigint:ba,boolean:J,date:oc,discriminatedUnion:pc,effect:ji,enum:Ec,function:bc,instanceof:ic,intersection:gc,lazy:wc,literal:ke,map:_c,nan:ac,nativeEnum:Ir,never:dc,null:os,nullable:Tc,number:G,object:x,oboolean:Oc,onumber:kc,optional:wa,ostring:Ic,pipeline:Ac,preprocess:Ea,promise:Sc,record:vc,set:yc,strictObject:fc,string:_,symbol:lc,transformer:ji,tuple:mc,undefined:cc,union:ui,unknown:hn,void:hc,NEVER:Nc,ZodIssueCode:R,quotelessJson:Cl,ZodError:ze}),xs={exports:{}},$i;function Pc(){return $i||($i=1,function(n){var e=function(t){var r=1e7,s=7,i=9007199254740992,a=N(i),o="0123456789abcdefghijklmnopqrstuvwxyz",l=typeof BigInt=="function";function u(d,p,m,y){return typeof d>"u"?u[0]:typeof p<"u"?+p==10&&!m?Z(d):ys(d,p,m,y):Z(d)}function c(d,p){this.value=d,this.sign=p,this.isSmall=!1}c.prototype=Object.create(u.prototype);function f(d){this.value=d,this.sign=d<0,this.isSmall=!0}f.prototype=Object.create(u.prototype);function v(d){this.value=d}v.prototype=Object.create(u.prototype);function T(d){return-i<d&&d<i}function N(d){return d<1e7?[d]:d<1e14?[d%1e7,Math.floor(d/1e7)]:[d%1e7,Math.floor(d/1e7)%1e7,Math.floor(d/1e14)]}function D(d){I(d);var p=d.length;if(p<4&&vt(d,a)<0)switch(p){case 0:return 0;case 1:return d[0];case 2:return d[0]+d[1]*r;default:return d[0]+(d[1]+d[2]*r)*r}return d}function I(d){for(var p=d.length;d[--p]===0;);d.length=p+1}function F(d){for(var p=new Array(d),m=-1;++m<d;)p[m]=0;return p}function q(d){return d>0?Math.floor(d):Math.ceil(d)}function U(d,p){var m=d.length,y=p.length,E=new Array(m),w=0,k=r,A,O;for(O=0;O<y;O++)A=d[O]+p[O]+w,w=A>=k?1:0,E[O]=A-w*k;for(;O<m;)A=d[O]+w,w=A===k?1:0,E[O++]=A-w*k;return w>0&&E.push(w),E}function Y(d,p){return d.length>=p.length?U(d,p):U(p,d)}function fe(d,p){var m=d.length,y=new Array(m),E=r,w,k;for(k=0;k<m;k++)w=d[k]-E+p,p=Math.floor(w/E),y[k]=w-p*E,p+=1;for(;p>0;)y[k++]=p%E,p=Math.floor(p/E);return y}c.prototype.add=function(d){var p=Z(d);if(this.sign!==p.sign)return this.subtract(p.negate());var m=this.value,y=p.value;return p.isSmall?new c(fe(m,Math.abs(y)),this.sign):new c(Y(m,y),this.sign)},c.prototype.plus=c.prototype.add,f.prototype.add=function(d){var p=Z(d),m=this.value;if(m<0!==p.sign)return this.subtract(p.negate());var y=p.value;if(p.isSmall){if(T(m+y))return new f(m+y);y=N(Math.abs(y))}return new c(fe(y,Math.abs(m)),m<0)},f.prototype.plus=f.prototype.add,v.prototype.add=function(d){return new v(this.value+Z(d).value)},v.prototype.plus=v.prototype.add;function oe(d,p){var m=d.length,y=p.length,E=new Array(m),w=0,k=r,A,O;for(A=0;A<y;A++)O=d[A]-w-p[A],O<0?(O+=k,w=1):w=0,E[A]=O;for(A=y;A<m;A++){if(O=d[A]-w,O<0)O+=k;else{E[A++]=O;break}E[A]=O}for(;A<m;A++)E[A]=d[A];return I(E),E}function ne(d,p,m){var y;return vt(d,p)>=0?y=oe(d,p):(y=oe(p,d),m=!m),y=D(y),typeof y=="number"?(m&&(y=-y),new f(y)):new c(y,m)}function Je(d,p,m){var y=d.length,E=new Array(y),w=-p,k=r,A,O;for(A=0;A<y;A++)O=d[A]+w,w=Math.floor(O/k),O%=k,E[A]=O<0?O+k:O;return E=D(E),typeof E=="number"?(m&&(E=-E),new f(E)):new c(E,m)}c.prototype.subtract=function(d){var p=Z(d);if(this.sign!==p.sign)return this.add(p.negate());var m=this.value,y=p.value;return p.isSmall?Je(m,Math.abs(y),this.sign):ne(m,y,this.sign)},c.prototype.minus=c.prototype.subtract,f.prototype.subtract=function(d){var p=Z(d),m=this.value;if(m<0!==p.sign)return this.add(p.negate());var y=p.value;return p.isSmall?new f(m-y):Je(y,Math.abs(m),m>=0)},f.prototype.minus=f.prototype.subtract,v.prototype.subtract=function(d){return new v(this.value-Z(d).value)},v.prototype.minus=v.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},f.prototype.negate=function(){var d=this.sign,p=new f(-this.value);return p.sign=!d,p},v.prototype.negate=function(){return new v(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},f.prototype.abs=function(){return new f(Math.abs(this.value))},v.prototype.abs=function(){return new v(this.value>=0?this.value:-this.value)};function qe(d,p){var m=d.length,y=p.length,E=m+y,w=F(E),k=r,A,O,z,se,X;for(z=0;z<m;++z){se=d[z];for(var de=0;de<y;++de)X=p[de],A=se*X+w[z+de],O=Math.floor(A/k),w[z+de]=A-O*k,w[z+de+1]+=O}return I(w),w}function gt(d,p){var m=d.length,y=new Array(m),E=r,w=0,k,A;for(A=0;A<m;A++)k=d[A]*p+w,w=Math.floor(k/E),y[A]=k-w*E;for(;w>0;)y[A++]=w%E,w=Math.floor(w/E);return y}function Ue(d,p){for(var m=[];p-- >0;)m.push(0);return m.concat(d)}function ge(d,p){var m=Math.max(d.length,p.length);if(m<=30)return qe(d,p);m=Math.ceil(m/2);var y=d.slice(m),E=d.slice(0,m),w=p.slice(m),k=p.slice(0,m),A=ge(E,k),O=ge(y,w),z=ge(Y(E,y),Y(k,w)),se=Y(Y(A,Ue(oe(oe(z,A),O),m)),Ue(O,2*m));return I(se),se}function gs(d,p){return-.012*d-.012*p+15e-6*d*p>0}c.prototype.multiply=function(d){var p=Z(d),m=this.value,y=p.value,E=this.sign!==p.sign,w;if(p.isSmall){if(y===0)return u[0];if(y===1)return this;if(y===-1)return this.negate();if(w=Math.abs(y),w<r)return new c(gt(m,w),E);y=N(w)}return gs(m.length,y.length)?new c(ge(m,y),E):new c(qe(m,y),E)},c.prototype.times=c.prototype.multiply;function wn(d,p,m){return d<r?new c(gt(p,d),m):new c(qe(p,N(d)),m)}f.prototype._multiplyBySmall=function(d){return T(d.value*this.value)?new f(d.value*this.value):wn(Math.abs(d.value),N(Math.abs(this.value)),this.sign!==d.sign)},c.prototype._multiplyBySmall=function(d){return d.value===0?u[0]:d.value===1?this:d.value===-1?this.negate():wn(Math.abs(d.value),this.value,this.sign!==d.sign)},f.prototype.multiply=function(d){return Z(d)._multiplyBySmall(this)},f.prototype.times=f.prototype.multiply,v.prototype.multiply=function(d){return new v(this.value*Z(d).value)},v.prototype.times=v.prototype.multiply;function En(d){var p=d.length,m=F(p+p),y=r,E,w,k,A,O;for(k=0;k<p;k++){A=d[k],w=0-A*A;for(var z=k;z<p;z++)O=d[z],E=2*(A*O)+m[k+z]+w,w=Math.floor(E/y),m[k+z]=E-w*y;m[k+p]=w}return I(m),m}c.prototype.square=function(){return new c(En(this.value),!1)},f.prototype.square=function(){var d=this.value*this.value;return T(d)?new f(d):new c(En(N(Math.abs(this.value))),!1)},v.prototype.square=function(d){return new v(this.value*this.value)};function ms(d,p){var m=d.length,y=p.length,E=r,w=F(p.length),k=p[y-1],A=Math.ceil(E/(2*k)),O=gt(d,A),z=gt(p,A),se,X,de,Me,Pe,$r,Cr;for(O.length<=m&&O.push(0),z.push(0),k=z[y-1],X=m-y;X>=0;X--){for(se=E-1,O[X+y]!==k&&(se=Math.floor((O[X+y]*E+O[X+y-1])/k)),de=0,Me=0,$r=z.length,Pe=0;Pe<$r;Pe++)de+=se*z[Pe],Cr=Math.floor(de/E),Me+=O[X+Pe]-(de-Cr*E),de=Cr,Me<0?(O[X+Pe]=Me+E,Me=-1):(O[X+Pe]=Me,Me=0);for(;Me!==0;){for(se-=1,de=0,Pe=0;Pe<$r;Pe++)de+=O[X+Pe]-E+z[Pe],de<0?(O[X+Pe]=de+E,de=0):(O[X+Pe]=de,de=1);Me+=de}w[X]=se}return O=Sn(O,A)[0],[D(w),D(O)]}function vs(d,p){for(var m=d.length,y=p.length,E=[],w=[],k=r,A,O,z,se,X;m;){if(w.unshift(d[--m]),I(w),vt(w,p)<0){E.push(0);continue}O=w.length,z=w[O-1]*k+w[O-2],se=p[y-1]*k+p[y-2],O>y&&(z=(z+1)*k),A=Math.ceil(z/se);do{if(X=gt(p,A),vt(X,w)<=0)break;A--}while(A);E.push(A),w=oe(w,X)}return E.reverse(),[D(E),D(w)]}function Sn(d,p){var m=d.length,y=F(m),E=r,w,k,A,O;for(A=0,w=m-1;w>=0;--w)O=A*E+d[w],k=q(O/p),A=O-k*p,y[w]=k|0;return[y,A|0]}function mt(d,p){var m,y=Z(p);if(l)return[new v(d.value/y.value),new v(d.value%y.value)];var E=d.value,w=y.value,k;if(w===0)throw new Error("Cannot divide by zero");if(d.isSmall)return y.isSmall?[new f(q(E/w)),new f(E%w)]:[u[0],d];if(y.isSmall){if(w===1)return[d,u[0]];if(w==-1)return[d.negate(),u[0]];var A=Math.abs(w);if(A<r){m=Sn(E,A),k=D(m[0]);var O=m[1];return d.sign&&(O=-O),typeof k=="number"?(d.sign!==y.sign&&(k=-k),[new f(k),new f(O)]):[new c(k,d.sign!==y.sign),new f(O)]}w=N(A)}var z=vt(E,w);if(z===-1)return[u[0],d];if(z===0)return[u[d.sign===y.sign?1:-1],u[0]];E.length+w.length<=200?m=ms(E,w):m=vs(E,w),k=m[0];var se=d.sign!==y.sign,X=m[1],de=d.sign;return typeof k=="number"?(se&&(k=-k),k=new f(k)):k=new c(k,se),typeof X=="number"?(de&&(X=-X),X=new f(X)):X=new c(X,de),[k,X]}c.prototype.divmod=function(d){var p=mt(this,d);return{quotient:p[0],remainder:p[1]}},v.prototype.divmod=f.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(d){return mt(this,d)[0]},v.prototype.over=v.prototype.divide=function(d){return new v(this.value/Z(d).value)},f.prototype.over=f.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(d){return mt(this,d)[1]},v.prototype.mod=v.prototype.remainder=function(d){return new v(this.value%Z(d).value)},f.prototype.remainder=f.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(d){var p=Z(d),m=this.value,y=p.value,E,w,k;if(y===0)return u[1];if(m===0)return u[0];if(m===1)return u[1];if(m===-1)return p.isEven()?u[1]:u[-1];if(p.sign)return u[0];if(!p.isSmall)throw new Error("The exponent "+p.toString()+" is too large.");if(this.isSmall&&T(E=Math.pow(m,y)))return new f(q(E));for(w=this,k=u[1];y&!0&&(k=k.times(w),--y),y!==0;)y/=2,w=w.square();return k},f.prototype.pow=c.prototype.pow,v.prototype.pow=function(d){var p=Z(d),m=this.value,y=p.value,E=BigInt(0),w=BigInt(1),k=BigInt(2);if(y===E)return u[1];if(m===E)return u[0];if(m===w)return u[1];if(m===BigInt(-1))return p.isEven()?u[1]:u[-1];if(p.isNegative())return new v(E);for(var A=this,O=u[1];(y&w)===w&&(O=O.times(A),--y),y!==E;)y/=k,A=A.square();return O},c.prototype.modPow=function(d,p){if(d=Z(d),p=Z(p),p.isZero())throw new Error("Cannot take modPow with modulus 0");var m=u[1],y=this.mod(p);for(d.isNegative()&&(d=d.multiply(u[-1]),y=y.modInv(p));d.isPositive();){if(y.isZero())return u[0];d.isOdd()&&(m=m.multiply(y).mod(p)),d=d.divide(2),y=y.square().mod(p)}return m},v.prototype.modPow=f.prototype.modPow=c.prototype.modPow;function vt(d,p){if(d.length!==p.length)return d.length>p.length?1:-1;for(var m=d.length-1;m>=0;m--)if(d[m]!==p[m])return d[m]>p[m]?1:-1;return 0}c.prototype.compareAbs=function(d){var p=Z(d),m=this.value,y=p.value;return p.isSmall?1:vt(m,y)},f.prototype.compareAbs=function(d){var p=Z(d),m=Math.abs(this.value),y=p.value;return p.isSmall?(y=Math.abs(y),m===y?0:m>y?1:-1):-1},v.prototype.compareAbs=function(d){var p=this.value,m=Z(d).value;return p=p>=0?p:-p,m=m>=0?m:-m,p===m?0:p>m?1:-1},c.prototype.compare=function(d){if(d===1/0)return-1;if(d===-1/0)return 1;var p=Z(d),m=this.value,y=p.value;return this.sign!==p.sign?p.sign?1:-1:p.isSmall?this.sign?-1:1:vt(m,y)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,f.prototype.compare=function(d){if(d===1/0)return-1;if(d===-1/0)return 1;var p=Z(d),m=this.value,y=p.value;return p.isSmall?m==y?0:m>y?1:-1:m<0!==p.sign?m<0?-1:1:m<0?1:-1},f.prototype.compareTo=f.prototype.compare,v.prototype.compare=function(d){if(d===1/0)return-1;if(d===-1/0)return 1;var p=this.value,m=Z(d).value;return p===m?0:p>m?1:-1},v.prototype.compareTo=v.prototype.compare,c.prototype.equals=function(d){return this.compare(d)===0},v.prototype.eq=v.prototype.equals=f.prototype.eq=f.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(d){return this.compare(d)!==0},v.prototype.neq=v.prototype.notEquals=f.prototype.neq=f.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(d){return this.compare(d)>0},v.prototype.gt=v.prototype.greater=f.prototype.gt=f.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(d){return this.compare(d)<0},v.prototype.lt=v.prototype.lesser=f.prototype.lt=f.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(d){return this.compare(d)>=0},v.prototype.geq=v.prototype.greaterOrEquals=f.prototype.geq=f.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(d){return this.compare(d)<=0},v.prototype.leq=v.prototype.lesserOrEquals=f.prototype.leq=f.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return(this.value[0]&1)===0},f.prototype.isEven=function(){return(this.value&1)===0},v.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return(this.value[0]&1)===1},f.prototype.isOdd=function(){return(this.value&1)===1},v.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},f.prototype.isPositive=function(){return this.value>0},v.prototype.isPositive=f.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},f.prototype.isNegative=function(){return this.value<0},v.prototype.isNegative=f.prototype.isNegative,c.prototype.isUnit=function(){return!1},f.prototype.isUnit=function(){return Math.abs(this.value)===1},v.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},f.prototype.isZero=function(){return this.value===0},v.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(d){var p=Z(d);return p.isZero()?!1:p.isUnit()?!0:p.compareAbs(2)===0?this.isEven():this.mod(p).isZero()},v.prototype.isDivisibleBy=f.prototype.isDivisibleBy=c.prototype.isDivisibleBy;function Tn(d){var p=d.abs();if(p.isUnit())return!1;if(p.equals(2)||p.equals(3)||p.equals(5))return!0;if(p.isEven()||p.isDivisibleBy(3)||p.isDivisibleBy(5))return!1;if(p.lesser(49))return!0}function Dr(d,p){for(var m=d.prev(),y=m,E=0,w,k,A;y.isEven();)y=y.divide(2),E++;e:for(k=0;k<p.length;k++)if(!d.lesser(p[k])&&(A=e(p[k]).modPow(y,d),!(A.isUnit()||A.equals(m)))){for(w=E-1;w!=0;w--){if(A=A.square().mod(d),A.isUnit())return!1;if(A.equals(m))continue e}return!1}return!0}c.prototype.isPrime=function(d){var p=Tn(this);if(p!==t)return p;var m=this.abs(),y=m.bitLength();if(y<=64)return Dr(m,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var E=Math.log(2)*y.toJSNumber(),w=Math.ceil(d===!0?2*Math.pow(E,2):E),k=[],A=0;A<w;A++)k.push(e(A+2));return Dr(m,k)},v.prototype.isPrime=f.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(d,p){var m=Tn(this);if(m!==t)return m;for(var y=this.abs(),E=d===t?5:d,w=[],k=0;k<E;k++)w.push(e.randBetween(2,y.minus(2),p));return Dr(y,w)},v.prototype.isProbablePrime=f.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(d){for(var p=e.zero,m=e.one,y=Z(d),E=this.abs(),w,k,A;!E.isZero();)w=y.divide(E),k=p,A=y,p=m,y=E,m=k.subtract(w.multiply(m)),E=A.subtract(w.multiply(E));if(!y.isUnit())throw new Error(this.toString()+" and "+d.toString()+" are not co-prime");return p.compare(0)===-1&&(p=p.add(d)),this.isNegative()?p.negate():p},v.prototype.modInv=f.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var d=this.value;return this.sign?Je(d,1,this.sign):new c(fe(d,1),this.sign)},f.prototype.next=function(){var d=this.value;return d+1<i?new f(d+1):new c(a,!1)},v.prototype.next=function(){return new v(this.value+BigInt(1))},c.prototype.prev=function(){var d=this.value;return this.sign?new c(fe(d,1),!0):Je(d,1,this.sign)},f.prototype.prev=function(){var d=this.value;return d-1>-i?new f(d-1):new c(a,!0)},v.prototype.prev=function(){return new v(this.value-BigInt(1))};for(var tt=[1];2*tt[tt.length-1]<=r;)tt.push(2*tt[tt.length-1]);var Kt=tt.length,_t=tt[Kt-1];function An(d){return Math.abs(d)<=r}c.prototype.shiftLeft=function(d){var p=Z(d).toJSNumber();if(!An(p))throw new Error(String(p)+" is too large for shifting.");if(p<0)return this.shiftRight(-p);var m=this;if(m.isZero())return m;for(;p>=Kt;)m=m.multiply(_t),p-=Kt-1;return m.multiply(tt[p])},v.prototype.shiftLeft=f.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(d){var p,m=Z(d).toJSNumber();if(!An(m))throw new Error(String(m)+" is too large for shifting.");if(m<0)return this.shiftLeft(-m);for(var y=this;m>=Kt;){if(y.isZero()||y.isNegative()&&y.isUnit())return y;p=mt(y,_t),y=p[1].isNegative()?p[0].prev():p[0],m-=Kt-1}return p=mt(y,tt[m]),p[1].isNegative()?p[0].prev():p[0]},v.prototype.shiftRight=f.prototype.shiftRight=c.prototype.shiftRight;function pe(d,p,m){p=Z(p);for(var y=d.isNegative(),E=p.isNegative(),w=y?d.not():d,k=E?p.not():p,A=0,O=0,z=null,se=null,X=[];!w.isZero()||!k.isZero();)z=mt(w,_t),A=z[1].toJSNumber(),y&&(A=_t-1-A),se=mt(k,_t),O=se[1].toJSNumber(),E&&(O=_t-1-O),w=z[0],k=se[0],X.push(m(A,O));for(var de=m(y?1:0,E?1:0)!==0?e(-1):e(0),Me=X.length-1;Me>=0;Me-=1)de=de.multiply(_t).add(e(X[Me]));return de}c.prototype.not=function(){return this.negate().prev()},v.prototype.not=f.prototype.not=c.prototype.not,c.prototype.and=function(d){return pe(this,d,function(p,m){return p&m})},v.prototype.and=f.prototype.and=c.prototype.and,c.prototype.or=function(d){return pe(this,d,function(p,m){return p|m})},v.prototype.or=f.prototype.or=c.prototype.or,c.prototype.xor=function(d){return pe(this,d,function(p,m){return p^m})},v.prototype.xor=f.prototype.xor=c.prototype.xor;var lr=1<<30,_s=(r&-r)*(r&-r)|lr;function Ve(d){var p=d.value,m=typeof p=="number"?p|lr:typeof p=="bigint"?p|BigInt(lr):p[0]+p[1]*r|_s;return m&-m}function xr(d,p){if(p.compareTo(d)<=0){var m=xr(d,p.square(p)),y=m.p,E=m.e,w=y.multiply(p);return w.compareTo(d)<=0?{p:w,e:E*2+1}:{p:y,e:E*2}}return{p:e(1),e:0}}c.prototype.bitLength=function(){var d=this;return d.compareTo(e(0))<0&&(d=d.negate().subtract(e(1))),d.compareTo(e(0))===0?e(0):e(xr(d,e(2)).e).add(e(1))},v.prototype.bitLength=f.prototype.bitLength=c.prototype.bitLength;function Lr(d,p){return d=Z(d),p=Z(p),d.greater(p)?d:p}function Ur(d,p){return d=Z(d),p=Z(p),d.lesser(p)?d:p}function Mr(d,p){if(d=Z(d).abs(),p=Z(p).abs(),d.equals(p))return d;if(d.isZero())return p;if(p.isZero())return d;for(var m=u[1],y,E;d.isEven()&&p.isEven();)y=Ur(Ve(d),Ve(p)),d=d.divide(y),p=p.divide(y),m=m.multiply(y);for(;d.isEven();)d=d.divide(Ve(d));do{for(;p.isEven();)p=p.divide(Ve(p));d.greater(p)&&(E=p,p=d,d=E),p=p.subtract(d)}while(!p.isZero());return m.isUnit()?d:d.multiply(m)}function In(d,p){return d=Z(d).abs(),p=Z(p).abs(),d.divide(Mr(d,p)).multiply(p)}function kn(d,p,m){d=Z(d),p=Z(p);var y=m||Math.random,E=Ur(d,p),w=Lr(d,p),k=w.subtract(E).add(1);if(k.isSmall)return E.add(Math.floor(y()*k));for(var A=Zt(k,r).value,O=[],z=!0,se=0;se<A.length;se++){var X=z?A[se]+(se+1<A.length?A[se+1]/r:0):r,de=q(y()*X);O.push(de),de<A[se]&&(z=!1)}return E.add(u.fromArray(O,r,!1))}var ys=function(d,p,m,y){m=m||o,d=String(d),y||(d=d.toLowerCase(),m=m.toLowerCase());var E=d.length,w,k=Math.abs(p),A={};for(w=0;w<m.length;w++)A[m[w]]=w;for(w=0;w<E;w++){var O=d[w];if(O!=="-"&&O in A&&A[O]>=k){if(O==="1"&&k===1)continue;throw new Error(O+" is not a valid digit in base "+p+".")}}p=Z(p);var z=[],se=d[0]==="-";for(w=se?1:0;w<d.length;w++){var O=d[w];if(O in A)z.push(Z(A[O]));else if(O==="<"){var X=w;do w++;while(d[w]!==">"&&w<d.length);z.push(Z(d.slice(X+1,w)))}else throw new Error(O+" is not a valid character")}return On(z,p,se)};function On(d,p,m){var y=u[0],E=u[1],w;for(w=d.length-1;w>=0;w--)y=y.add(d[w].times(E)),E=E.times(p);return m?y.negate():y}function bs(d,p){return p=p||o,d<p.length?p[d]:"<"+d+">"}function Zt(d,p){if(p=e(p),p.isZero()){if(d.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(p.equals(-1)){if(d.isZero())return{value:[0],isNegative:!1};if(d.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-d.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var m=Array.apply(null,Array(d.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return m.unshift([1]),{value:[].concat.apply([],m),isNegative:!1}}var y=!1;if(d.isNegative()&&p.isPositive()&&(y=!0,d=d.abs()),p.isUnit())return d.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(d.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:y};for(var E=[],w=d,k;w.isNegative()||w.compareAbs(p)>=0;){k=w.divmod(p),w=k.quotient;var A=k.remainder;A.isNegative()&&(A=p.minus(A).abs(),w=w.next()),E.push(A.toJSNumber())}return E.push(w.toJSNumber()),{value:E.reverse(),isNegative:y}}function Rn(d,p,m){var y=Zt(d,p);return(y.isNegative?"-":"")+y.value.map(function(E){return bs(E,m)}).join("")}c.prototype.toArray=function(d){return Zt(this,d)},f.prototype.toArray=function(d){return Zt(this,d)},v.prototype.toArray=function(d){return Zt(this,d)},c.prototype.toString=function(d,p){if(d===t&&(d=10),d!==10||p)return Rn(this,d,p);for(var m=this.value,y=m.length,E=String(m[--y]),w="0000000",k;--y>=0;)k=String(m[y]),E+=w.slice(k.length)+k;var A=this.sign?"-":"";return A+E},f.prototype.toString=function(d,p){return d===t&&(d=10),d!=10||p?Rn(this,d,p):String(this.value)},v.prototype.toString=f.prototype.toString,v.prototype.toJSON=c.prototype.toJSON=f.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,f.prototype.valueOf=function(){return this.value},f.prototype.toJSNumber=f.prototype.valueOf,v.prototype.valueOf=v.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function Nn(d){if(T(+d)){var p=+d;if(p===q(p))return l?new v(BigInt(p)):new f(p);throw new Error("Invalid integer: "+d)}var m=d[0]==="-";m&&(d=d.slice(1));var y=d.split(/e/i);if(y.length>2)throw new Error("Invalid integer: "+y.join("e"));if(y.length===2){var E=y[1];if(E[0]==="+"&&(E=E.slice(1)),E=+E,E!==q(E)||!T(E))throw new Error("Invalid integer: "+E+" is not a valid exponent.");var w=y[0],k=w.indexOf(".");if(k>=0&&(E-=w.length-k-1,w=w.slice(0,k)+w.slice(k+1)),E<0)throw new Error("Cannot include negative exponent part for integers");w+=new Array(E+1).join("0"),d=w}var A=/^([0-9][0-9]*)$/.test(d);if(!A)throw new Error("Invalid integer: "+d);if(l)return new v(BigInt(m?"-"+d:d));for(var O=[],z=d.length,se=s,X=z-se;z>0;)O.push(+d.slice(X,z)),X-=se,X<0&&(X=0),z-=se;return I(O),new c(O,m)}function jr(d){if(l)return new v(BigInt(d));if(T(d)){if(d!==q(d))throw new Error(d+" is not an integer.");return new f(d)}return Nn(d.toString())}function Z(d){return typeof d=="number"?jr(d):typeof d=="string"?Nn(d):typeof d=="bigint"?new v(d):d}for(var ot=0;ot<1e3;ot++)u[ot]=Z(ot),ot>0&&(u[-ot]=Z(-ot));return u.one=u[1],u.zero=u[0],u.minusOne=u[-1],u.max=Lr,u.min=Ur,u.gcd=Mr,u.lcm=In,u.isInstance=function(d){return d instanceof c||d instanceof f||d instanceof v},u.randBetween=kn,u.fromArray=function(d,p,m){return On(d.map(Z),Z(p||10),m)},u}();n.hasOwnProperty("exports")&&(n.exports=e)}(xs)),xs.exports}var Dc=Pc(),xc=fa(Dc);const Sa=64,Zs=16,jt=Sa/Zs;function Lc(){try{return!0}catch(n){return!1}}function Uc(n,e,t){let r=0;for(let s=0;s<t;s++){const i=n[e+s];if(i===void 0)break;r+=i*16**s}return r}function Ta(n){const e=[];for(let t=0;t<n.length;t++){let r=Number(n[t]);for(let s=0;r||s<e.length;s++)r+=(e[s]||0)*10,e[s]=r%16,r=(r-e[s])/16}return e}function Mc(n){const e=Ta(n),t=Array(jt);for(let r=0;r<jt;r++)t[jt-1-r]=Uc(e,r*jt,jt);return t}class ct{static fromString(e){return new ct(Mc(e),e)}static fromBit(e){const t=Array(jt),r=Math.floor(e/Zs);for(let s=0;s<jt;s++)t[jt-1-s]=s===r?1<<e-r*Zs:0;return new ct(t)}constructor(e,t){this.parts=e,this.str=t}and({parts:e}){return new ct(this.parts.map((t,r)=>t&e[r]))}or({parts:e}){return new ct(this.parts.map((t,r)=>t|e[r]))}xor({parts:e}){return new ct(this.parts.map((t,r)=>t^e[r]))}not(){return new ct(this.parts.map(e=>~e))}equals({parts:e}){return this.parts.every((t,r)=>t===e[r])}toString(){if(this.str!=null)return this.str;const e=new Array(Sa/4);return this.parts.forEach((t,r)=>{const s=Ta(t.toString());for(let i=0;i<4;i++)e[i+r*4]=s[3-i]||0}),this.str=xc.fromArray(e,16).toString()}toJSON(){return this.toString()}}const qt=Lc();qt&&BigInt.prototype.toJSON==null&&(BigInt.prototype.toJSON=function(){return this.toString()});const Hn={},Aa=qt?function(e){return BigInt(e)}:function(e){return e instanceof ct?e:(typeof e=="number"&&(e=e.toString()),Hn[e]!=null||(Hn[e]=ct.fromString(e)),Hn[e])},Ne=Aa(0),ls=qt?function(e=Ne,t=Ne){return e&t}:function(e=Ne,t=Ne){return e.and(t)},Ia=qt?function(e=Ne,t=Ne){return e|t}:function(e=Ne,t=Ne){return e.or(t)},jc=qt?function(e=Ne,t=Ne){return e^t}:function(e=Ne,t=Ne){return e.xor(t)},$c=qt?function(e=Ne){return~e}:function(e=Ne){return e.not()},di=qt?function(e,t){return e===t}:function(e,t){return e==null||t==null?e==t:e.equals(t)};function Cc(...n){let e=n[0];for(let t=1;t<n.length;t++)e=Ia(e,n[t]);return e}function Bc(n,e){return di(ls(n,e),e)}function Gc(n,e){return!di(ls(n,e),Ne)}function Hc(n,e){return e===Ne?n:Ia(n,e)}function Fc(n,e){return e===Ne?n:jc(n,ls(n,e))}const qc=qt?function(e){return BigInt(1)<<BigInt(e)}:function(e){return ct.fromBit(e)};var V={combine:Cc,add:Hc,remove:Fc,filter:ls,invert:$c,has:Bc,hasAny:Gc,equals:di,deserialize:Aa,getFlag:qc},Ci;(function(n){n[n.CLOSE_NORMAL=1e3]="CLOSE_NORMAL",n[n.CLOSE_UNSUPPORTED=1003]="CLOSE_UNSUPPORTED",n[n.CLOSE_ABNORMAL=1006]="CLOSE_ABNORMAL",n[n.INVALID_CLIENTID=4e3]="INVALID_CLIENTID",n[n.INVALID_ORIGIN=4001]="INVALID_ORIGIN",n[n.RATELIMITED=4002]="RATELIMITED",n[n.TOKEN_REVOKED=4003]="TOKEN_REVOKED",n[n.INVALID_VERSION=4004]="INVALID_VERSION",n[n.INVALID_ENCODING=4005]="INVALID_ENCODING"})(Ci||(Ci={}));var Ws;(function(n){n[n.INVALID_PAYLOAD=4e3]="INVALID_PAYLOAD",n[n.INVALID_COMMAND=4002]="INVALID_COMMAND",n[n.INVALID_EVENT=4004]="INVALID_EVENT",n[n.INVALID_PERMISSIONS=4006]="INVALID_PERMISSIONS"})(Ws||(Ws={}));var zs;(function(n){n.LANDSCAPE="landscape",n.PORTRAIT="portrait"})(zs||(zs={}));var Ot;(function(n){n.MOBILE="mobile",n.DESKTOP="desktop"})(Ot||(Ot={}));Object.freeze({CREATE_INSTANT_INVITE:V.getFlag(0),KICK_MEMBERS:V.getFlag(1),BAN_MEMBERS:V.getFlag(2),ADMINISTRATOR:V.getFlag(3),MANAGE_CHANNELS:V.getFlag(4),MANAGE_GUILD:V.getFlag(5),ADD_REACTIONS:V.getFlag(6),VIEW_AUDIT_LOG:V.getFlag(7),PRIORITY_SPEAKER:V.getFlag(8),STREAM:V.getFlag(9),VIEW_CHANNEL:V.getFlag(10),SEND_MESSAGES:V.getFlag(11),SEND_TTS_MESSAGES:V.getFlag(12),MANAGE_MESSAGES:V.getFlag(13),EMBED_LINKS:V.getFlag(14),ATTACH_FILES:V.getFlag(15),READ_MESSAGE_HISTORY:V.getFlag(16),MENTION_EVERYONE:V.getFlag(17),USE_EXTERNAL_EMOJIS:V.getFlag(18),VIEW_GUILD_INSIGHTS:V.getFlag(19),CONNECT:V.getFlag(20),SPEAK:V.getFlag(21),MUTE_MEMBERS:V.getFlag(22),DEAFEN_MEMBERS:V.getFlag(23),MOVE_MEMBERS:V.getFlag(24),USE_VAD:V.getFlag(25),CHANGE_NICKNAME:V.getFlag(26),MANAGE_NICKNAMES:V.getFlag(27),MANAGE_ROLES:V.getFlag(28),MANAGE_WEBHOOKS:V.getFlag(29),MANAGE_GUILD_EXPRESSIONS:V.getFlag(30),USE_APPLICATION_COMMANDS:V.getFlag(31),REQUEST_TO_SPEAK:V.getFlag(32),MANAGE_EVENTS:V.getFlag(33),MANAGE_THREADS:V.getFlag(34),CREATE_PUBLIC_THREADS:V.getFlag(35),CREATE_PRIVATE_THREADS:V.getFlag(36),USE_EXTERNAL_STICKERS:V.getFlag(37),SEND_MESSAGES_IN_THREADS:V.getFlag(38),USE_EMBEDDED_ACTIVITIES:V.getFlag(39),MODERATE_MEMBERS:V.getFlag(40),VIEW_CREATOR_MONETIZATION_ANALYTICS:V.getFlag(41),USE_SOUNDBOARD:V.getFlag(42),CREATE_GUILD_EXPRESSIONS:V.getFlag(43),CREATE_EVENTS:V.getFlag(44),USE_EXTERNAL_SOUNDS:V.getFlag(45),SEND_VOICE_MESSAGES:V.getFlag(46),SEND_POLLS:V.getFlag(49),USE_EXTERNAL_APPS:V.getFlag(50)});const Bi=-1,Vc=250;function Le(n){return Ea(e=>{var t;const[r]=(t=Object.entries(n).find(([,s])=>s===e))!==null&&t!==void 0?t:[];return e!=null&&r===void 0?n.UNHANDLED:e},_().or(G()))}function ka(n){const e=ci().transform(t=>{const r=n.safeParse(t);return r.success?r.data:n._def.defaultValue()});return e.overlayType=n,e}const Kc=L.object({image_url:L.string()}),Zc=L.object({mediaUrl:L.string().max(1024)}),Wc=L.object({access_token:L.union([L.string(),L.null()]).optional()}),Oa=L.object({access_token:L.string(),user:L.object({username:L.string(),discriminator:L.string(),id:L.string(),avatar:L.union([L.string(),L.null()]).optional(),public_flags:L.number(),global_name:L.union([L.string(),L.null()]).optional()}),scopes:L.array(ka(L.enum(["identify","email","connections","guilds","guilds.join","guilds.members.read","guilds.channels.read","gdm.join","bot","rpc","rpc.notifications.read","rpc.voice.read","rpc.voice.write","rpc.video.read","rpc.video.write","rpc.screenshare.read","rpc.screenshare.write","rpc.activities.write","webhook.incoming","messages.read","applications.builds.upload","applications.builds.read","applications.commands","applications.commands.permissions.update","applications.commands.update","applications.store.update","applications.entitlements","activities.read","activities.write","relationships.read","relationships.write","voice","dm_channels.read","role_connections.write","presences.read","presences.write","openid","dm_channels.messages.read","dm_channels.messages.write","gateway.connect","account.global_name.update","payment_sources.country_code","sdk.social_layer"]).or(L.literal(-1)).default(-1))),expires:L.string(),application:L.object({description:L.string(),icon:L.union([L.string(),L.null()]).optional(),id:L.string(),rpc_origins:L.array(L.string()).optional(),name:L.string()})}),Ra=L.object({participants:L.array(L.object({id:L.string(),username:L.string(),global_name:L.union([L.string(),L.null()]).optional(),discriminator:L.string(),avatar:L.union([L.string(),L.null()]).optional(),flags:L.number(),bot:L.boolean(),avatar_decoration_data:L.union([L.object({asset:L.string(),skuId:L.string().optional()}),L.null()]).optional(),premium_type:L.union([L.number(),L.null()]).optional(),nickname:L.string().optional()}))}),zc=L.object({command:L.string(),content:L.string().max(2e3).optional(),preview_image:L.object({height:L.number(),url:L.string(),width:L.number()}).optional(),components:L.array(L.object({type:L.literal(1),components:L.array(L.object({type:L.literal(2),style:L.number().gte(1).lte(5),label:L.string().max(80).optional(),custom_id:L.string().max(100).describe("Developer-defined identifier for the button; max 100 characters").optional()})).max(5).optional()})).optional()}),Jc=L.object({referrer_id:L.string().max(64).optional(),custom_id:L.string().max(64).optional(),message:L.string().max(1e3)}),Yc=L.object({success:L.boolean()});var Ze;(function(n){n.INITIATE_IMAGE_UPLOAD="INITIATE_IMAGE_UPLOAD",n.OPEN_SHARE_MOMENT_DIALOG="OPEN_SHARE_MOMENT_DIALOG",n.AUTHENTICATE="AUTHENTICATE",n.GET_ACTIVITY_INSTANCE_CONNECTED_PARTICIPANTS="GET_ACTIVITY_INSTANCE_CONNECTED_PARTICIPANTS",n.SHARE_INTERACTION="SHARE_INTERACTION",n.SHARE_LINK="SHARE_LINK"})(Ze||(Ze={}));const Gi=L.object({}).optional().nullable(),Hi=L.void(),Na={[Ze.INITIATE_IMAGE_UPLOAD]:{request:Hi,response:Kc},[Ze.OPEN_SHARE_MOMENT_DIALOG]:{request:Zc,response:Gi},[Ze.AUTHENTICATE]:{request:Wc,response:Oa},[Ze.GET_ACTIVITY_INSTANCE_CONNECTED_PARTICIPANTS]:{request:Hi,response:Ra},[Ze.SHARE_INTERACTION]:{request:zc,response:Gi},[Ze.SHARE_LINK]:{request:Jc,response:Yc}},Xc="DISPATCH";var H;(function(n){n.AUTHORIZE="AUTHORIZE",n.AUTHENTICATE="AUTHENTICATE",n.GET_GUILDS="GET_GUILDS",n.GET_GUILD="GET_GUILD",n.GET_CHANNEL="GET_CHANNEL",n.GET_CHANNELS="GET_CHANNELS",n.SELECT_VOICE_CHANNEL="SELECT_VOICE_CHANNEL",n.SELECT_TEXT_CHANNEL="SELECT_TEXT_CHANNEL",n.SUBSCRIBE="SUBSCRIBE",n.UNSUBSCRIBE="UNSUBSCRIBE",n.CAPTURE_SHORTCUT="CAPTURE_SHORTCUT",n.SET_CERTIFIED_DEVICES="SET_CERTIFIED_DEVICES",n.SET_ACTIVITY="SET_ACTIVITY",n.GET_SKUS="GET_SKUS",n.GET_ENTITLEMENTS="GET_ENTITLEMENTS",n.GET_SKUS_EMBEDDED="GET_SKUS_EMBEDDED",n.GET_ENTITLEMENTS_EMBEDDED="GET_ENTITLEMENTS_EMBEDDED",n.START_PURCHASE="START_PURCHASE",n.SET_CONFIG="SET_CONFIG",n.SEND_ANALYTICS_EVENT="SEND_ANALYTICS_EVENT",n.USER_SETTINGS_GET_LOCALE="USER_SETTINGS_GET_LOCALE",n.OPEN_EXTERNAL_LINK="OPEN_EXTERNAL_LINK",n.ENCOURAGE_HW_ACCELERATION="ENCOURAGE_HW_ACCELERATION",n.CAPTURE_LOG="CAPTURE_LOG",n.SET_ORIENTATION_LOCK_STATE="SET_ORIENTATION_LOCK_STATE",n.OPEN_INVITE_DIALOG="OPEN_INVITE_DIALOG",n.GET_PLATFORM_BEHAVIORS="GET_PLATFORM_BEHAVIORS",n.GET_CHANNEL_PERMISSIONS="GET_CHANNEL_PERMISSIONS",n.OPEN_SHARE_MOMENT_DIALOG="OPEN_SHARE_MOMENT_DIALOG",n.INITIATE_IMAGE_UPLOAD="INITIATE_IMAGE_UPLOAD",n.GET_ACTIVITY_INSTANCE_CONNECTED_PARTICIPANTS="GET_ACTIVITY_INSTANCE_CONNECTED_PARTICIPANTS",n.SHARE_LINK="SHARE_LINK"})(H||(H={}));const kr=x({cmd:_(),data:hn(),evt:os(),nonce:_()}).passthrough(),Qc=Object.assign(Object.assign({},Oa.shape.scopes.element.overlayType._def.innerType.options[0].Values),{UNHANDLED:-1});Le(Qc);const Ft=x({id:_(),username:_(),discriminator:_(),global_name:_().optional().nullable(),avatar:_().optional().nullable(),avatar_decoration_data:x({asset:_(),sku_id:_().optional()}).nullable(),bot:J(),flags:G().optional().nullable(),premium_type:G().optional().nullable()}),hi=x({user:Ft,nick:_().optional().nullable(),roles:le(_()),joined_at:_(),deaf:J(),mute:J()}),eu=x({user_id:_(),nick:_().optional().nullable(),guild_id:_(),avatar:_().optional().nullable(),avatar_decoration_data:x({asset:_(),sku_id:_().optional().nullable()}).optional().nullable(),color_string:_().optional().nullable()}),fi=x({id:_(),name:_().optional().nullable(),roles:le(_()).optional().nullable(),user:Ft.optional().nullable(),require_colons:J().optional().nullable(),managed:J().optional().nullable(),animated:J().optional().nullable(),available:J().optional().nullable()}),Pa=x({mute:J(),deaf:J(),self_mute:J(),self_deaf:J(),suppress:J()}),Da=x({mute:J(),nick:_(),user:Ft,voice_state:Pa,volume:G()}),tu={UNHANDLED:-1,IDLE:"idle",DND:"dnd",ONLINE:"online",OFFLINE:"offline"},Fn=Le(tu),Zr=x({name:_(),type:G(),url:_().optional().nullable(),created_at:G().optional().nullable(),timestamps:x({start:G(),end:G()}).partial().optional().nullable(),application_id:_().optional().nullable(),details:_().optional().nullable(),state:_().optional().nullable(),emoji:fi.optional().nullable(),party:x({id:_().optional().nullable(),size:le(G()).optional().nullable()}).optional().nullable(),assets:x({large_image:_().nullable(),large_text:_().nullable(),small_image:_().nullable(),small_text:_().nullable()}).partial().optional().nullable(),secrets:x({join:_(),match:_()}).partial().optional().nullable(),instance:J().optional().nullable(),flags:G().optional().nullable()}),ru={UNHANDLED:-1,ROLE:0,MEMBER:1},nu=x({id:_(),type:Le(ru),allow:_(),deny:_()}),xa={UNHANDLED:-1,DM:1,GROUP_DM:3,GUILD_TEXT:0,GUILD_VOICE:2,GUILD_CATEGORY:4,GUILD_ANNOUNCEMENT:5,GUILD_STORE:6,ANNOUNCEMENT_THREAD:10,PUBLIC_THREAD:11,PRIVATE_THREAD:12,GUILD_STAGE_VOICE:13,GUILD_DIRECTORY:14,GUILD_FORUM:15},La=x({id:_(),type:Le(xa),guild_id:_().optional().nullable(),position:G().optional().nullable(),permission_overwrites:le(nu).optional().nullable(),name:_().optional().nullable(),topic:_().optional().nullable(),nsfw:J().optional().nullable(),last_message_id:_().optional().nullable(),bitrate:G().optional().nullable(),user_limit:G().optional().nullable(),rate_limit_per_user:G().optional().nullable(),recipients:le(Ft).optional().nullable(),icon:_().optional().nullable(),owner_id:_().optional().nullable(),application_id:_().optional().nullable(),parent_id:_().optional().nullable(),last_pin_timestamp:_().optional().nullable()}),su=x({user:Ft,guild_id:_(),status:Fn,activities:le(Zr),client_status:x({desktop:Fn,mobile:Fn,web:Fn}).partial()}),iu=x({id:_(),name:_(),color:G(),hoist:J(),position:G(),permissions:_(),managed:J(),mentionable:J()});x({id:_(),name:_(),owner_id:_(),icon:_().nullable(),icon_hash:_().optional().nullable(),splash:_().nullable(),discovery_splash:_().nullable(),owner:J().optional().nullable(),permissions:_().optional().nullable(),region:_(),afk_channel_id:_().nullable(),afk_timeout:G(),widget_enabled:J().optional().nullable(),widget_channel_id:_().optional().nullable(),verification_level:G(),default_message_notifications:G(),explicit_content_filter:G(),roles:le(iu),emojis:le(fi),features:le(_()),mfa_level:G(),application_id:_().nullable(),system_channel_id:_().nullable(),system_channel_flags:G(),rules_channel_id:_().nullable(),joined_at:_().optional().nullable(),large:J().optional().nullable(),unavailable:J().optional().nullable(),member_count:G().optional().nullable(),voice_states:le(Pa).optional().nullable(),members:le(hi).optional().nullable(),channels:le(La).optional().nullable(),presences:le(su).optional().nullable(),max_presences:G().optional().nullable(),max_members:G().optional().nullable(),vanity_url_code:_().nullable(),description:_().nullable(),banner:_().nullable(),premium_tier:G(),premium_subscription_count:G().optional().nullable(),preferred_locale:_(),public_updates_channel_id:_().nullable(),max_video_channel_users:G().optional().nullable(),approximate_member_count:G().optional().nullable(),approximate_presence_count:G().optional().nullable()});const au=x({id:_(),guild_id:_(),type:G(),name:_()}),ou=x({id:_(),filename:_(),size:G(),url:_(),proxy_url:_(),height:G().optional().nullable(),width:G().optional().nullable()}),lu=x({text:_(),icon_url:_().optional().nullable(),proxy_icon_url:_().optional().nullable()}),Js=x({url:_().optional().nullable(),proxy_url:_().optional().nullable(),height:G().optional().nullable(),width:G().optional().nullable()}),cu=Js.omit({proxy_url:!0}),uu=x({name:_().optional().nullable(),url:_().optional().nullable()}),du=x({name:_().optional().nullable(),url:_().optional().nullable(),icon_url:_().optional().nullable(),proxy_icon_url:_().optional().nullable()}),hu=x({name:_(),value:_(),inline:J()}),fu=x({title:_().optional().nullable(),type:_().optional().nullable(),description:_().optional().nullable(),url:_().optional().nullable(),timestamp:_().optional().nullable(),color:G().optional().nullable(),footer:lu.optional().nullable(),image:Js.optional().nullable(),thumbnail:Js.optional().nullable(),video:cu.optional().nullable(),provider:uu.optional().nullable(),author:du.optional().nullable(),fields:le(hu).optional().nullable()}),pu=x({count:G(),me:J(),emoji:fi}),gu=x({type:G(),party_id:_().optional().nullable()}),mu=x({id:_(),cover_image:_().optional().nullable(),description:_(),icon:_().optional().nullable(),name:_()}),vu=x({message_id:_().optional().nullable(),channel_id:_().optional().nullable(),guild_id:_().optional().nullable()}),_u=x({id:_(),channel_id:_(),guild_id:_().optional().nullable(),author:Ft.optional().nullable(),member:hi.optional().nullable(),content:_(),timestamp:_(),edited_timestamp:_().optional().nullable(),tts:J(),mention_everyone:J(),mentions:le(Ft),mention_roles:le(_()),mention_channels:le(au),attachments:le(ou),embeds:le(fu),reactions:le(pu).optional().nullable(),nonce:ui([_(),G()]).optional().nullable(),pinned:J(),webhook_id:_().optional().nullable(),type:G(),activity:gu.optional().nullable(),application:mu.optional().nullable(),message_reference:vu.optional().nullable(),flags:G().optional().nullable(),stickers:le(hn()).optional().nullable(),referenced_message:hn().optional().nullable()}),yu=x({id:_(),name:_()}),bu={UNHANDLED:-1,KEYBOARD_KEY:0,MOUSE_BUTTON:1,KEYBOARD_MODIFIER_KEY:2,GAMEPAD_BUTTON:3},Ua=x({type:Le(bu),code:G(),name:_()}),wu={UNHANDLED:-1,PUSH_TO_TALK:"PUSH_TO_TALK",VOICE_ACTIVITY:"VOICE_ACTIVITY"},Eu=x({type:Le(wu),auto_threshold:J(),threshold:G(),shortcut:le(Ua),delay:G()}),Fi=x({device_id:_(),volume:G(),available_devices:le(yu)}),Su={UNHANDLED:-1,AUDIO_INPUT:"AUDIO_INPUT",AUDIO_OUTPUT:"AUDIO_OUTPUT",VIDEO_INPUT:"VIDEO_INPUT"};x({type:Le(Su),id:_(),vendor:x({name:_(),url:_()}),model:x({name:_(),url:_()}),related:le(_()),echo_cancellation:J().optional().nullable(),noise_suppression:J().optional().nullable(),automatic_gain_control:J().optional().nullable(),hardware_mute:J().optional().nullable()});const Tu={UNHANDLED:-1,APPLICATION:1,DLC:2,CONSUMABLE:3,BUNDLE:4,SUBSCRIPTION:5},Au=x({id:_(),name:_(),type:Le(Tu),price:x({amount:G(),currency:_()}),application_id:_(),flags:G(),release_date:_().nullable()}),Iu={UNHANDLED:-1,PURCHASE:1,PREMIUM_SUBSCRIPTION:2,DEVELOPER_GIFT:3,TEST_MODE_PURCHASE:4,FREE_PURCHASE:5,USER_GIFT:6,PREMIUM_PURCHASE:7},pi=x({id:_(),sku_id:_(),application_id:_(),user_id:_(),gift_code_flags:G(),type:Le(Iu),gifter_user_id:_().optional().nullable(),branches:le(_()).optional().nullable(),starts_at:_().optional().nullable(),ends_at:_().optional().nullable(),parent_id:_().optional().nullable(),consumed:J().optional().nullable(),deleted:J().optional().nullable(),gift_code_batch_id:_().optional().nullable()}),ku={UNHANDLED:-1,UNLOCKED:1,PORTRAIT:2,LANDSCAPE:3};Le(ku);const Ou={UNHANDLED:-1,NOMINAL:0,FAIR:1,SERIOUS:2,CRITICAL:3},Ru=Le(Ou),Ma={UNHANDLED:-1,PORTRAIT:0,LANDSCAPE:1};Le(Ma);const ja={UNHANDLED:-1,FOCUSED:0,PIP:1,GRID:2};Le(ja);const gi="ERROR";var he;(function(n){n.READY="READY",n.VOICE_STATE_UPDATE="VOICE_STATE_UPDATE",n.SPEAKING_START="SPEAKING_START",n.SPEAKING_STOP="SPEAKING_STOP",n.ACTIVITY_LAYOUT_MODE_UPDATE="ACTIVITY_LAYOUT_MODE_UPDATE",n.ORIENTATION_UPDATE="ORIENTATION_UPDATE",n.CURRENT_USER_UPDATE="CURRENT_USER_UPDATE",n.CURRENT_GUILD_MEMBER_UPDATE="CURRENT_GUILD_MEMBER_UPDATE",n.ENTITLEMENT_CREATE="ENTITLEMENT_CREATE",n.THERMAL_STATE_UPDATE="THERMAL_STATE_UPDATE",n.ACTIVITY_INSTANCE_PARTICIPANTS_UPDATE="ACTIVITY_INSTANCE_PARTICIPANTS_UPDATE"})(he||(he={}));const Ke=kr.extend({evt:Ir(he),nonce:_().nullable(),cmd:ke(Xc),data:x({}).passthrough()}),$a=kr.extend({evt:ke(gi),data:x({code:G(),message:_().optional()}).passthrough(),cmd:Ir(H),nonce:_().nullable()}),Nu=Ke.extend({evt:_()}),Pu=ui([Ke,Nu,$a]);function Du(n){const e=n.evt;if(!(e in he))throw new Error("Unrecognized event type ".concat(n.evt));return xu[e].payload.parse(n)}const xu={[he.READY]:{payload:Ke.extend({evt:ke(he.READY),data:x({v:G(),config:x({cdn_host:_().optional(),api_endpoint:_(),environment:_()}),user:x({id:_(),username:_(),discriminator:_(),avatar:_().optional()}).optional()})})},[he.VOICE_STATE_UPDATE]:{payload:Ke.extend({evt:ke(he.VOICE_STATE_UPDATE),data:Da}),subscribeArgs:x({channel_id:_()})},[he.SPEAKING_START]:{payload:Ke.extend({evt:ke(he.SPEAKING_START),data:x({lobby_id:_().optional(),channel_id:_().optional(),user_id:_()})}),subscribeArgs:x({lobby_id:_().nullable().optional(),channel_id:_().nullable().optional()})},[he.SPEAKING_STOP]:{payload:Ke.extend({evt:ke(he.SPEAKING_STOP),data:x({lobby_id:_().optional(),channel_id:_().optional(),user_id:_()})}),subscribeArgs:x({lobby_id:_().nullable().optional(),channel_id:_().nullable().optional()})},[he.ACTIVITY_LAYOUT_MODE_UPDATE]:{payload:Ke.extend({evt:ke(he.ACTIVITY_LAYOUT_MODE_UPDATE),data:x({layout_mode:Le(ja)})})},[he.ORIENTATION_UPDATE]:{payload:Ke.extend({evt:ke(he.ORIENTATION_UPDATE),data:x({screen_orientation:Le(Ma),orientation:Ir(zs)})})},[he.CURRENT_USER_UPDATE]:{payload:Ke.extend({evt:ke(he.CURRENT_USER_UPDATE),data:Ft})},[he.CURRENT_GUILD_MEMBER_UPDATE]:{payload:Ke.extend({evt:ke(he.CURRENT_GUILD_MEMBER_UPDATE),data:eu}),subscribeArgs:x({guild_id:_()})},[he.ENTITLEMENT_CREATE]:{payload:Ke.extend({evt:ke(he.ENTITLEMENT_CREATE),data:x({entitlement:pi})})},[he.THERMAL_STATE_UPDATE]:{payload:Ke.extend({evt:ke(he.THERMAL_STATE_UPDATE),data:x({thermal_state:Ru})})},[he.ACTIVITY_INSTANCE_PARTICIPANTS_UPDATE]:{payload:Ke.extend({evt:ke(he.ACTIVITY_INSTANCE_PARTICIPANTS_UPDATE),data:x({participants:Ra.shape.participants})})}};function Lu(n,e){throw e}const cs=x({}).nullable(),Ca=x({code:_()}),Uu=x({guilds:le(x({id:_(),name:_()}))}),Mu=x({id:_(),name:_(),icon_url:_().optional(),members:le(hi)}),Tr=x({id:_(),type:Le(xa),guild_id:_().optional().nullable(),name:_().optional().nullable(),topic:_().optional().nullable(),bitrate:G().optional().nullable(),user_limit:G().optional().nullable(),position:G().optional().nullable(),voice_states:le(Da),messages:le(_u)}),ju=x({channels:le(La)});Tr.nullable();const $u=Tr.nullable(),Cu=Tr.nullable();x({input:Fi,output:Fi,mode:Eu,automatic_gain_control:J(),echo_cancellation:J(),noise_suppression:J(),qos:J(),silence_warning:J(),deaf:J(),mute:J()});const Bu=x({evt:_()}),Gu=x({shortcut:Ua}),Ba=Zr,Ga=x({skus:le(Au)}),Ha=x({entitlements:le(pi)}),Fa=le(pi).nullable(),qa=x({use_interactive_pip:J()}),Va=x({locale:_()}),Ka=x({enabled:J()}),Za=x({permissions:ba().or(_())}),Wa=ka(x({opened:J().or(os())}).default({opened:null})),za=x({iosKeyboardResizesView:wa(J())}),Hu=kr.extend({cmd:Ir(H),evt:os()});function Fu({cmd:n,data:e}){switch(n){case H.AUTHORIZE:return Ca.parse(e);case H.CAPTURE_SHORTCUT:return Gu.parse(e);case H.ENCOURAGE_HW_ACCELERATION:return Ka.parse(e);case H.GET_CHANNEL:return Tr.parse(e);case H.GET_CHANNELS:return ju.parse(e);case H.GET_CHANNEL_PERMISSIONS:return Za.parse(e);case H.GET_GUILD:return Mu.parse(e);case H.GET_GUILDS:return Uu.parse(e);case H.GET_PLATFORM_BEHAVIORS:return za.parse(e);case H.GET_CHANNEL:return Tr.parse(e);case H.SELECT_TEXT_CHANNEL:return Cu.parse(e);case H.SELECT_VOICE_CHANNEL:return $u.parse(e);case H.SET_ACTIVITY:return Ba.parse(e);case H.GET_SKUS_EMBEDDED:return Ga.parse(e);case H.GET_ENTITLEMENTS_EMBEDDED:return Ha.parse(e);case H.SET_CONFIG:return qa.parse(e);case H.START_PURCHASE:return Fa.parse(e);case H.SUBSCRIBE:case H.UNSUBSCRIBE:return Bu.parse(e);case H.USER_SETTINGS_GET_LOCALE:return Va.parse(e);case H.OPEN_EXTERNAL_LINK:return Wa.parse(e);case H.SET_ORIENTATION_LOCK_STATE:case H.SET_CERTIFIED_DEVICES:case H.SEND_ANALYTICS_EVENT:case H.OPEN_INVITE_DIALOG:case H.CAPTURE_LOG:case H.GET_SKUS:case H.GET_ENTITLEMENTS:return cs.parse(e);case H.AUTHENTICATE:case H.INITIATE_IMAGE_UPLOAD:case H.OPEN_SHARE_MOMENT_DIALOG:case H.GET_ACTIVITY_INSTANCE_CONNECTED_PARTICIPANTS:case H.SHARE_LINK:const{response:t}=Na[n];return t.parse(e);default:Lu(n,new Error("Unrecognized command ".concat(n)))}}function qu(n){return Object.assign(Object.assign({},n),{data:Fu(n)})}x({frame_id:_(),platform:Ir(Ot).optional().nullable()});x({v:ke(1),encoding:ke("json").optional(),client_id:_(),frame_id:_()});const Vu=x({code:G(),message:_().optional()}),Ku=x({evt:_().nullable(),nonce:_().nullable(),data:hn().nullable(),cmd:_()}).passthrough();function Zu(n){const e=Ku.parse(n);return e.evt!=null?e.evt===gi?$a.parse(e):Du(Pu.parse(e)):qu(Hu.passthrough().parse(e))}function Fe(n,e,t,r=()=>{}){const s=kr.extend({cmd:ke(e),data:t});return async i=>{const a=await n({cmd:e,args:i,transfer:r(i)});return s.parse(a).data}}function vn(n,e=()=>{}){const t=Na[n].response,r=kr.extend({cmd:ke(n),data:t});return s=>async i=>{const a=await s({cmd:n,args:i,transfer:e(i)});return r.parse(a).data}}const Wu=vn(Ze.AUTHENTICATE),zu=n=>Fe(n,H.AUTHORIZE,Ca),Ju=n=>Fe(n,H.CAPTURE_LOG,cs),Yu=n=>Fe(n,H.ENCOURAGE_HW_ACCELERATION,Ka),Xu=n=>Fe(n,H.GET_ENTITLEMENTS_EMBEDDED,Ha),Qu=n=>Fe(n,H.GET_SKUS_EMBEDDED,Ga),ed=n=>Fe(n,H.GET_CHANNEL_PERMISSIONS,Za),td=n=>Fe(n,H.GET_PLATFORM_BEHAVIORS,za),rd=n=>Fe(n,H.OPEN_EXTERNAL_LINK,Wa),nd=n=>Fe(n,H.OPEN_INVITE_DIALOG,cs),sd=vn(Ze.OPEN_SHARE_MOMENT_DIALOG);Zr.pick({state:!0,details:!0,timestamps:!0,assets:!0,party:!0,secrets:!0,instance:!0,type:!0}).extend({type:Zr.shape.type.optional(),instance:Zr.shape.instance.optional()}).nullable();const id=n=>Fe(n,H.SET_ACTIVITY,Ba),ad=n=>Fe(n,H.SET_CONFIG,qa);function od({sendCommand:n,cmd:e,response:t,fallbackTransform:r,transferTransform:s=()=>{}}){const i=kr.extend({cmd:ke(e),data:t});return async a=>{try{const o=await n({cmd:e,args:a,transfer:s(a)});return i.parse(o).data}catch(o){if(o.code===Ws.INVALID_PAYLOAD){const l=r(a),u=await n({cmd:e,args:l,transfer:s(l)});return i.parse(u).data}else throw o}}}const ld=n=>({lock_state:n.lock_state,picture_in_picture_lock_state:n.picture_in_picture_lock_state}),cd=n=>od({sendCommand:n,cmd:H.SET_ORIENTATION_LOCK_STATE,response:cs,fallbackTransform:ld}),ud=vn(Ze.SHARE_LINK),dd=n=>Fe(n,H.START_PURCHASE,Fa),hd=n=>Fe(n,H.USER_SETTINGS_GET_LOCALE,Va),fd=vn(Ze.INITIATE_IMAGE_UPLOAD),pd=n=>Fe(n,H.GET_CHANNEL,Tr),gd=vn(Ze.GET_ACTIVITY_INSTANCE_CONNECTED_PARTICIPANTS);function md(n){return{authenticate:Wu(n),authorize:zu(n),captureLog:Ju(n),encourageHardwareAcceleration:Yu(n),getChannel:pd(n),getChannelPermissions:ed(n),getEntitlements:Xu(n),getPlatformBehaviors:td(n),getSkus:Qu(n),openExternalLink:rd(n),openInviteDialog:nd(n),openShareMomentDialog:sd(n),setActivity:id(n),setConfig:ad(n),setOrientationLockState:cd(n),shareLink:ud(n),startPurchase:dd(n),userSettingsGetLocale:hd(n),initiateImageUpload:fd(n),getInstanceConnectedParticipants:gd(n)}}class vd extends Error{constructor(e,t=""){super(t),this.code=e,this.message=t,this.name="Discord SDK Error"}}function _d(){return{disableConsoleLogOverride:!1}}const yd=["log","warn","debug","info","error"];function bd(n,e,t){const r=n[e],s=n;r&&(n[e]=function(){const i=[].slice.call(arguments),a=""+i.join(" ");t(e,a),r.apply(s,i)})}var wd="1.9.0",Ed=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),qi={randomUUID:Ed},qn,Sd=new Uint8Array(16);function Td(){if(!qn&&(qn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!qn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return qn(Sd)}var Re=[];for(var Ls=0;Ls<256;++Ls)Re.push((Ls+256).toString(16).slice(1));function Ad(n,e=0){return(Re[n[e+0]]+Re[n[e+1]]+Re[n[e+2]]+Re[n[e+3]]+"-"+Re[n[e+4]]+Re[n[e+5]]+"-"+Re[n[e+6]]+Re[n[e+7]]+"-"+Re[n[e+8]]+Re[n[e+9]]+"-"+Re[n[e+10]]+Re[n[e+11]]+Re[n[e+12]]+Re[n[e+13]]+Re[n[e+14]]+Re[n[e+15]]).toLowerCase()}function Vi(n,e,t){if(qi.randomUUID&&!n)return qi.randomUUID();n=n||{};var r=n.random||(n.rng||Td)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Ad(r)}var It;(function(n){n[n.HANDSHAKE=0]="HANDSHAKE",n[n.FRAME=1]="FRAME",n[n.CLOSE=2]="CLOSE",n[n.HELLO=3]="HELLO"})(It||(It={}));const Id=new Set(kd());function kd(){return typeof window>"u"?[]:[window.location.origin,"https://discord.com","https://discordapp.com","https://ptb.discord.com","https://ptb.discordapp.com","https://canary.discord.com","https://canary.discordapp.com","https://staging.discord.co","http://localhost:3333","https://pax.discord.com","null"]}function Od(){var n;return[(n=window.parent.opener)!==null&&n!==void 0?n:window.parent,document.referrer?document.referrer:"*"]}class Rd{getTransfer(e){var t;switch(e.cmd){case H.SUBSCRIBE:case H.UNSUBSCRIBE:return;default:return(t=e.transfer)!==null&&t!==void 0?t:void 0}}constructor(e,t){if(this.sdkVersion=wd,this.mobileAppVersion=null,this.source=null,this.sourceOrigin="",this.eventBus=new $l,this.pendingCommands=new Map,this.sendCommand=o=>{var l;if(this.source==null)throw new Error("Attempting to send message before initialization");const u=Vi();return(l=this.source)===null||l===void 0||l.postMessage([It.FRAME,Object.assign(Object.assign({},o),{nonce:u})],this.sourceOrigin,this.getTransfer(o)),new Promise((f,v)=>{this.pendingCommands.set(u,{resolve:f,reject:v})})},this.commands=md(this.sendCommand),this.handleMessage=o=>{if(!Id.has(o.origin))return;const l=o.data;if(!Array.isArray(l))return;const[u,c]=l;switch(u){case It.HELLO:return;case It.CLOSE:return this.handleClose(c);case It.HANDSHAKE:return this.handleHandshake();case It.FRAME:return this.handleFrame(c);default:throw new Error("Invalid message format")}},this.isReady=!1,this.clientId=e,this.configuration=t!=null?t:_d(),typeof window<"u"&&window.addEventListener("message",this.handleMessage),typeof window>"u"){this.frameId="",this.instanceId="",this.customId=null,this.referrerId=null,this.platform=Ot.DESKTOP,this.guildId=null,this.channelId=null,this.locationId=null;return}const r=new URLSearchParams(this._getSearch()),s=r.get("frame_id");if(!s)throw new Error("frame_id query param is not defined");this.frameId=s;const i=r.get("instance_id");if(!i)throw new Error("instance_id query param is not defined");this.instanceId=i;const a=r.get("platform");if(a){if(a!==Ot.DESKTOP&&a!==Ot.MOBILE)throw new Error('Invalid query param "platform" of "'.concat(a,'". Valid values are "').concat(Ot.DESKTOP,'" or "').concat(Ot.MOBILE,'"'))}else throw new Error("platform query param is not defined");this.platform=a,this.customId=r.get("custom_id"),this.referrerId=r.get("referrer_id"),this.guildId=r.get("guild_id"),this.channelId=r.get("channel_id"),this.locationId=r.get("location_id"),this.mobileAppVersion=r.get("mobile_app_version"),[this.source,this.sourceOrigin]=Od(),this.addOnReadyListener(),this.handshake()}close(e,t){var r;window.removeEventListener("message",this.handleMessage);const s=Vi();(r=this.source)===null||r===void 0||r.postMessage([It.CLOSE,{code:e,message:t,nonce:s}],this.sourceOrigin)}async subscribe(e,t,...r){const[s]=r,i=this.eventBus.listenerCount(e),a=this.eventBus.on(e,t);return Object.values(he).includes(e)&&e!==he.READY&&i===0&&await this.sendCommand({cmd:H.SUBSCRIBE,args:s,evt:e}),a}async unsubscribe(e,t,...r){const[s]=r;return e!==he.READY&&this.eventBus.listenerCount(e)===1&&await this.sendCommand({cmd:H.UNSUBSCRIBE,evt:e,args:s}),this.eventBus.off(e,t)}async ready(){this.isReady||await new Promise(e=>{this.eventBus.once(he.READY,e)})}parseMajorMobileVersion(){if(this.mobileAppVersion&&this.mobileAppVersion.includes("."))try{return parseInt(this.mobileAppVersion.split(".")[0])}catch(e){return Bi}return Bi}handshake(){var e;const t={v:1,encoding:"json",client_id:this.clientId,frame_id:this.frameId},r=this.parseMajorMobileVersion();(this.platform===Ot.DESKTOP||r>=Vc)&&(t.sdk_version=this.sdkVersion),(e=this.source)===null||e===void 0||e.postMessage([It.HANDSHAKE,t],this.sourceOrigin)}addOnReadyListener(){this.eventBus.once(he.READY,()=>{this.overrideConsoleLogging(),this.isReady=!0})}overrideConsoleLogging(){if(this.configuration.disableConsoleLogOverride)return;const e=(t,r)=>{this.commands.captureLog({level:t,message:r})};yd.forEach(t=>{bd(console,t,e)})}handleClose(e){Vu.parse(e)}handleHandshake(){}handleFrame(e){var t,r;let s;try{s=Zu(e)}catch(i){console.error("Failed to parse",e),console.error(i);return}if(s.cmd==="DISPATCH")this.eventBus.emit(s.evt,s.data);else{if(s.evt===gi){if(s.nonce!=null){(t=this.pendingCommands.get(s.nonce))===null||t===void 0||t.reject(s.data),this.pendingCommands.delete(s.nonce);return}this.eventBus.emit("error",new vd(s.data.code,s.data.message))}if(s.nonce==null){console.error("Missing nonce",e);return}(r=this.pendingCommands.get(s.nonce))===null||r===void 0||r.resolve(s),this.pendingCommands.delete(s.nonce)}}_getSearch(){return typeof window>"u"?"":window.location.search}}var Or=1e9,Nd={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},to,ye=!0,Qe="[DecimalError] ",nr=Qe+"Invalid argument: ",mi=Qe+"Exponent out of range: ",Rr=Math.floor,Qt=Math.pow,Pd=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,We,Oe=1e7,_e=7,Ja=9007199254740991,rs=Rr(Ja/_e),$={};$.absoluteValue=$.abs=function(){var n=new this.constructor(this);return n.s&&(n.s=1),n};$.comparedTo=$.cmp=function(n){var e,t,r,s,i=this;if(n=new i.constructor(n),i.s!==n.s)return i.s||-n.s;if(i.e!==n.e)return i.e>n.e^i.s<0?1:-1;for(r=i.d.length,s=n.d.length,e=0,t=r<s?r:s;e<t;++e)if(i.d[e]!==n.d[e])return i.d[e]>n.d[e]^i.s<0?1:-1;return r===s?0:r>s^i.s<0?1:-1};$.decimalPlaces=$.dp=function(){var n=this,e=n.d.length-1,t=(e-n.e)*_e;if(e=n.d[e],e)for(;e%10==0;e/=10)t--;return t<0?0:t};$.dividedBy=$.div=function(n){return Rt(this,new this.constructor(n))};$.dividedToIntegerBy=$.idiv=function(n){var e=this,t=e.constructor;return me(Rt(e,new t(n),0,1),t.precision)};$.equals=$.eq=function(n){return!this.cmp(n)};$.exponent=function(){return Te(this)};$.greaterThan=$.gt=function(n){return this.cmp(n)>0};$.greaterThanOrEqualTo=$.gte=function(n){return this.cmp(n)>=0};$.isInteger=$.isint=function(){return this.e>this.d.length-2};$.isNegative=$.isneg=function(){return this.s<0};$.isPositive=$.ispos=function(){return this.s>0};$.isZero=function(){return this.s===0};$.lessThan=$.lt=function(n){return this.cmp(n)<0};$.lessThanOrEqualTo=$.lte=function(n){return this.cmp(n)<1};$.logarithm=$.log=function(n){var e,t=this,r=t.constructor,s=r.precision,i=s+5;if(n===void 0)n=new r(10);else if(n=new r(n),n.s<1||n.eq(We))throw Error(Qe+"NaN");if(t.s<1)throw Error(Qe+(t.s?"NaN":"-Infinity"));return t.eq(We)?new r(0):(ye=!1,e=Rt(fn(t,i),fn(n,i),i),ye=!0,me(e,s))};$.minus=$.sub=function(n){var e=this;return n=new e.constructor(n),e.s==n.s?Qa(e,n):Ya(e,(n.s=-n.s,n))};$.modulo=$.mod=function(n){var e,t=this,r=t.constructor,s=r.precision;if(n=new r(n),!n.s)throw Error(Qe+"NaN");return t.s?(ye=!1,e=Rt(t,n,0,1).times(n),ye=!0,t.minus(e)):me(new r(t),s)};$.naturalExponential=$.exp=function(){return Xa(this)};$.naturalLogarithm=$.ln=function(){return fn(this)};$.negated=$.neg=function(){var n=new this.constructor(this);return n.s=-n.s||0,n};$.plus=$.add=function(n){var e=this;return n=new e.constructor(n),e.s==n.s?Ya(e,n):Qa(e,(n.s=-n.s,n))};$.precision=$.sd=function(n){var e,t,r,s=this;if(n!==void 0&&n!==!!n&&n!==1&&n!==0)throw Error(nr+n);if(e=Te(s)+1,r=s.d.length-1,t=r*_e+1,r=s.d[r],r){for(;r%10==0;r/=10)t--;for(r=s.d[0];r>=10;r/=10)t++}return n&&e>t?e:t};$.squareRoot=$.sqrt=function(){var n,e,t,r,s,i,a,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(Qe+"NaN")}for(n=Te(o),ye=!1,s=Math.sqrt(+o),s==0||s==1/0?(e=ut(o.d),(e.length+n)%2==0&&(e+="0"),s=Math.sqrt(e),n=Rr((n+1)/2)-(n<0||n%2),s==1/0?e="5e"+n:(e=s.toExponential(),e=e.slice(0,e.indexOf("e")+1)+n),r=new l(e)):r=new l(s.toString()),t=l.precision,s=a=t+3;;)if(i=r,r=i.plus(Rt(o,i,a+2)).times(.5),ut(i.d).slice(0,a)===(e=ut(r.d)).slice(0,a)){if(e=e.slice(a-3,a+1),s==a&&e=="4999"){if(me(i,t+1,0),i.times(i).eq(o)){r=i;break}}else if(e!="9999")break;a+=4}return ye=!0,me(r,t)};$.times=$.mul=function(n){var e,t,r,s,i,a,o,l,u,c=this,f=c.constructor,v=c.d,T=(n=new f(n)).d;if(!c.s||!n.s)return new f(0);for(n.s*=c.s,t=c.e+n.e,l=v.length,u=T.length,l<u&&(i=v,v=T,T=i,a=l,l=u,u=a),i=[],a=l+u,r=a;r--;)i.push(0);for(r=u;--r>=0;){for(e=0,s=l+r;s>r;)o=i[s]+T[r]*v[s-r-1]+e,i[s--]=o%Oe|0,e=o/Oe|0;i[s]=(i[s]+e)%Oe|0}for(;!i[--a];)i.pop();return e?++t:i.shift(),n.d=i,n.e=t,ye?me(n,f.precision):n};$.toDecimalPlaces=$.todp=function(n,e){var t=this,r=t.constructor;return t=new r(t),n===void 0?t:(pt(n,0,Or),e===void 0?e=r.rounding:pt(e,0,8),me(t,n+Te(t)+1,e))};$.toExponential=function(n,e){var t,r=this,s=r.constructor;return n===void 0?t=ar(r,!0):(pt(n,0,Or),e===void 0?e=s.rounding:pt(e,0,8),r=me(new s(r),n+1,e),t=ar(r,!0,n+1)),t};$.toFixed=function(n,e){var t,r,s=this,i=s.constructor;return n===void 0?ar(s):(pt(n,0,Or),e===void 0?e=i.rounding:pt(e,0,8),r=me(new i(s),n+Te(s)+1,e),t=ar(r.abs(),!1,n+Te(r)+1),s.isneg()&&!s.isZero()?"-"+t:t)};$.toInteger=$.toint=function(){var n=this,e=n.constructor;return me(new e(n),Te(n)+1,e.rounding)};$.toNumber=function(){return+this};$.toPower=$.pow=function(n){var e,t,r,s,i,a,o=this,l=o.constructor,u=12,c=+(n=new l(n));if(!n.s)return new l(We);if(o=new l(o),!o.s){if(n.s<1)throw Error(Qe+"Infinity");return o}if(o.eq(We))return o;if(r=l.precision,n.eq(We))return me(o,r);if(e=n.e,t=n.d.length-1,a=e>=t,i=o.s,a){if((t=c<0?-c:c)<=Ja){for(s=new l(We),e=Math.ceil(r/_e+4),ye=!1;t%2&&(s=s.times(o),Zi(s.d,e)),t=Rr(t/2),t!==0;)o=o.times(o),Zi(o.d,e);return ye=!0,n.s<0?new l(We).div(s):me(s,r)}}else if(i<0)throw Error(Qe+"NaN");return i=i<0&&n.d[Math.max(e,t)]&1?-1:1,o.s=1,ye=!1,s=n.times(fn(o,r+u)),ye=!0,s=Xa(s),s.s=i,s};$.toPrecision=function(n,e){var t,r,s=this,i=s.constructor;return n===void 0?(t=Te(s),r=ar(s,t<=i.toExpNeg||t>=i.toExpPos)):(pt(n,1,Or),e===void 0?e=i.rounding:pt(e,0,8),s=me(new i(s),n,e),t=Te(s),r=ar(s,n<=t||t<=i.toExpNeg,n)),r};$.toSignificantDigits=$.tosd=function(n,e){var t=this,r=t.constructor;return n===void 0?(n=r.precision,e=r.rounding):(pt(n,1,Or),e===void 0?e=r.rounding:pt(e,0,8)),me(new r(t),n,e)};$.toString=$.valueOf=$.val=$.toJSON=$[Symbol.for("nodejs.util.inspect.custom")]=function(){var n=this,e=Te(n),t=n.constructor;return ar(n,e<=t.toExpNeg||e>=t.toExpPos)};function Ya(n,e){var t,r,s,i,a,o,l,u,c=n.constructor,f=c.precision;if(!n.s||!e.s)return e.s||(e=new c(n)),ye?me(e,f):e;if(l=n.d,u=e.d,a=n.e,s=e.e,l=l.slice(),i=a-s,i){for(i<0?(r=l,i=-i,o=u.length):(r=u,s=a,o=l.length),a=Math.ceil(f/_e),o=a>o?a+1:o+1,i>o&&(i=o,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for(o=l.length,i=u.length,o-i<0&&(i=o,r=u,u=l,l=r),t=0;i;)t=(l[--i]=l[i]+u[i]+t)/Oe|0,l[i]%=Oe;for(t&&(l.unshift(t),++s),o=l.length;l[--o]==0;)l.pop();return e.d=l,e.e=s,ye?me(e,f):e}function pt(n,e,t){if(n!==~~n||n<e||n>t)throw Error(nr+n)}function ut(n){var e,t,r,s=n.length-1,i="",a=n[0];if(s>0){for(i+=a,e=1;e<s;e++)r=n[e]+"",t=_e-r.length,t&&(i+=Ut(t)),i+=r;a=n[e],r=a+"",t=_e-r.length,t&&(i+=Ut(t))}else if(a===0)return"0";for(;a%10===0;)a/=10;return i+a}var Rt=function(){function n(r,s){var i,a=0,o=r.length;for(r=r.slice();o--;)i=r[o]*s+a,r[o]=i%Oe|0,a=i/Oe|0;return a&&r.unshift(a),r}function e(r,s,i,a){var o,l;if(i!=a)l=i>a?1:-1;else for(o=l=0;o<i;o++)if(r[o]!=s[o]){l=r[o]>s[o]?1:-1;break}return l}function t(r,s,i){for(var a=0;i--;)r[i]-=a,a=r[i]<s[i]?1:0,r[i]=a*Oe+r[i]-s[i];for(;!r[0]&&r.length>1;)r.shift()}return function(r,s,i,a){var o,l,u,c,f,v,T,N,D,I,F,q,U,Y,fe,oe,ne,Je,qe=r.constructor,gt=r.s==s.s?1:-1,Ue=r.d,ge=s.d;if(!r.s)return new qe(r);if(!s.s)throw Error(Qe+"Division by zero");for(l=r.e-s.e,ne=ge.length,fe=Ue.length,T=new qe(gt),N=T.d=[],u=0;ge[u]==(Ue[u]||0);)++u;if(ge[u]>(Ue[u]||0)&&--l,i==null?q=i=qe.precision:a?q=i+(Te(r)-Te(s))+1:q=i,q<0)return new qe(0);if(q=q/_e+2|0,u=0,ne==1)for(c=0,ge=ge[0],q++;(u<fe||c)&&q--;u++)U=c*Oe+(Ue[u]||0),N[u]=U/ge|0,c=U%ge|0;else{for(c=Oe/(ge[0]+1)|0,c>1&&(ge=n(ge,c),Ue=n(Ue,c),ne=ge.length,fe=Ue.length),Y=ne,D=Ue.slice(0,ne),I=D.length;I<ne;)D[I++]=0;Je=ge.slice(),Je.unshift(0),oe=ge[0],ge[1]>=Oe/2&&++oe;do c=0,o=e(ge,D,ne,I),o<0?(F=D[0],ne!=I&&(F=F*Oe+(D[1]||0)),c=F/oe|0,c>1?(c>=Oe&&(c=Oe-1),f=n(ge,c),v=f.length,I=D.length,o=e(f,D,v,I),o==1&&(c--,t(f,ne<v?Je:ge,v))):(c==0&&(o=c=1),f=ge.slice()),v=f.length,v<I&&f.unshift(0),t(D,f,I),o==-1&&(I=D.length,o=e(ge,D,ne,I),o<1&&(c++,t(D,ne<I?Je:ge,I))),I=D.length):o===0&&(c++,D=[0]),N[u++]=c,o&&D[0]?D[I++]=Ue[Y]||0:(D=[Ue[Y]],I=1);while((Y++<fe||D[0]!==void 0)&&q--)}return N[0]||N.shift(),T.e=l,me(T,a?i+Te(T)+1:i)}}();function Xa(n,e){var t,r,s,i,a,o,l=0,u=0,c=n.constructor,f=c.precision;if(Te(n)>16)throw Error(mi+Te(n));if(!n.s)return new c(We);for(ye=!1,o=f,a=new c(.03125);n.abs().gte(.1);)n=n.times(a),u+=5;for(r=Math.log(Qt(2,u))/Math.LN10*2+5|0,o+=r,t=s=i=new c(We),c.precision=o;;){if(s=me(s.times(n),o),t=t.times(++l),a=i.plus(Rt(s,t,o)),ut(a.d).slice(0,o)===ut(i.d).slice(0,o)){for(;u--;)i=me(i.times(i),o);return c.precision=f,e==null?(ye=!0,me(i,f)):i}i=a}}function Te(n){for(var e=n.e*_e,t=n.d[0];t>=10;t/=10)e++;return e}function Us(n,e,t){if(e>n.LN10.sd())throw ye=!0,t&&(n.precision=t),Error(Qe+"LN10 precision limit exceeded");return me(new n(n.LN10),e)}function Ut(n){for(var e="";n--;)e+="0";return e}function fn(n,e){var t,r,s,i,a,o,l,u,c,f=1,v=10,T=n,N=T.d,D=T.constructor,I=D.precision;if(T.s<1)throw Error(Qe+(T.s?"NaN":"-Infinity"));if(T.eq(We))return new D(0);if(e==null?(ye=!1,u=I):u=e,T.eq(10))return e==null&&(ye=!0),Us(D,u);if(u+=v,D.precision=u,t=ut(N),r=t.charAt(0),i=Te(T),Math.abs(i)<15e14){for(;r<7&&r!=1||r==1&&t.charAt(1)>3;)T=T.times(n),t=ut(T.d),r=t.charAt(0),f++;i=Te(T),r>1?(T=new D("0."+t),i++):T=new D(r+"."+t.slice(1))}else return l=Us(D,u+2,I).times(i+""),T=fn(new D(r+"."+t.slice(1)),u-v).plus(l),D.precision=I,e==null?(ye=!0,me(T,I)):T;for(o=a=T=Rt(T.minus(We),T.plus(We),u),c=me(T.times(T),u),s=3;;){if(a=me(a.times(c),u),l=o.plus(Rt(a,new D(s),u)),ut(l.d).slice(0,u)===ut(o.d).slice(0,u))return o=o.times(2),i!==0&&(o=o.plus(Us(D,u+2,I).times(i+""))),o=Rt(o,new D(f),u),D.precision=I,e==null?(ye=!0,me(o,I)):o;o=l,s+=2}}function Ki(n,e){var t,r,s;for((t=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(t<0&&(t=r),t+=+e.slice(r+1),e=e.substring(0,r)):t<0&&(t=e.length),r=0;e.charCodeAt(r)===48;)++r;for(s=e.length;e.charCodeAt(s-1)===48;)--s;if(e=e.slice(r,s),e){if(s-=r,t=t-r-1,n.e=Rr(t/_e),n.d=[],r=(t+1)%_e,t<0&&(r+=_e),r<s){for(r&&n.d.push(+e.slice(0,r)),s-=_e;r<s;)n.d.push(+e.slice(r,r+=_e));e=e.slice(r),r=_e-e.length}else r-=s;for(;r--;)e+="0";if(n.d.push(+e),ye&&(n.e>rs||n.e<-rs))throw Error(mi+t)}else n.s=0,n.e=0,n.d=[0];return n}function me(n,e,t){var r,s,i,a,o,l,u,c,f=n.d;for(a=1,i=f[0];i>=10;i/=10)a++;if(r=e-a,r<0)r+=_e,s=e,u=f[c=0];else{if(c=Math.ceil((r+1)/_e),i=f.length,c>=i)return n;for(u=i=f[c],a=1;i>=10;i/=10)a++;r%=_e,s=r-_e+a}if(t!==void 0&&(i=Qt(10,a-s-1),o=u/i%10|0,l=e<0||f[c+1]!==void 0||u%i,l=t<4?(o||l)&&(t==0||t==(n.s<0?3:2)):o>5||o==5&&(t==4||l||t==6&&(r>0?s>0?u/Qt(10,a-s):0:f[c-1])%10&1||t==(n.s<0?8:7))),e<1||!f[0])return l?(i=Te(n),f.length=1,e=e-i-1,f[0]=Qt(10,(_e-e%_e)%_e),n.e=Rr(-e/_e)||0):(f.length=1,f[0]=n.e=n.s=0),n;if(r==0?(f.length=c,i=1,c--):(f.length=c+1,i=Qt(10,_e-r),f[c]=s>0?(u/Qt(10,a-s)%Qt(10,s)|0)*i:0),l)for(;;)if(c==0){(f[0]+=i)==Oe&&(f[0]=1,++n.e);break}else{if(f[c]+=i,f[c]!=Oe)break;f[c--]=0,i=1}for(r=f.length;f[--r]===0;)f.pop();if(ye&&(n.e>rs||n.e<-rs))throw Error(mi+Te(n));return n}function Qa(n,e){var t,r,s,i,a,o,l,u,c,f,v=n.constructor,T=v.precision;if(!n.s||!e.s)return e.s?e.s=-e.s:e=new v(n),ye?me(e,T):e;if(l=n.d,f=e.d,r=e.e,u=n.e,l=l.slice(),a=u-r,a){for(c=a<0,c?(t=l,a=-a,o=f.length):(t=f,r=u,o=l.length),s=Math.max(Math.ceil(T/_e),o)+2,a>s&&(a=s,t.length=1),t.reverse(),s=a;s--;)t.push(0);t.reverse()}else{for(s=l.length,o=f.length,c=s<o,c&&(o=s),s=0;s<o;s++)if(l[s]!=f[s]){c=l[s]<f[s];break}a=0}for(c&&(t=l,l=f,f=t,e.s=-e.s),o=l.length,s=f.length-o;s>0;--s)l[o++]=0;for(s=f.length;s>a;){if(l[--s]<f[s]){for(i=s;i&&l[--i]===0;)l[i]=Oe-1;--l[i],l[s]+=Oe}l[s]-=f[s]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--r;return l[0]?(e.d=l,e.e=r,ye?me(e,T):e):new v(0)}function ar(n,e,t){var r,s=Te(n),i=ut(n.d),a=i.length;return e?(t&&(r=t-a)>0?i=i.charAt(0)+"."+i.slice(1)+Ut(r):a>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(s<0?"e":"e+")+s):s<0?(i="0."+Ut(-s-1)+i,t&&(r=t-a)>0&&(i+=Ut(r))):s>=a?(i+=Ut(s+1-a),t&&(r=t-s-1)>0&&(i=i+"."+Ut(r))):((r=s+1)<a&&(i=i.slice(0,r)+"."+i.slice(r)),t&&(r=t-a)>0&&(s+1===a&&(i+="."),i+=Ut(r))),n.s<0?"-"+i:i}function Zi(n,e){if(n.length>e)return n.length=e,!0}function eo(n){var e,t,r;function s(i){var a=this;if(!(a instanceof s))return new s(i);if(a.constructor=s,i instanceof s){a.s=i.s,a.e=i.e,a.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(nr+i);if(i>0)a.s=1;else if(i<0)i=-i,a.s=-1;else{a.s=0,a.e=0,a.d=[0];return}if(i===~~i&&i<1e7){a.e=0,a.d=[i];return}return Ki(a,i.toString())}else if(typeof i!="string")throw Error(nr+i);if(i.charCodeAt(0)===45?(i=i.slice(1),a.s=-1):a.s=1,Pd.test(i))Ki(a,i);else throw Error(nr+i)}if(s.prototype=$,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=eo,s.config=s.set=Dd,n===void 0&&(n={}),n)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<r.length;)n.hasOwnProperty(t=r[e++])||(n[t]=this[t]);return s.config(n),s}function Dd(n){if(!n||typeof n!="object")throw Error(Qe+"Object expected");var e,t,r,s=["precision",1,Or,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<s.length;e+=3)if((r=n[t=s[e]])!==void 0)if(Rr(r)===r&&r>=s[e+1]&&r<=s[e+2])this[t]=r;else throw Error(nr+t+": "+r);if((r=n[t="LN10"])!==void 0)if(r==Math.LN10)this[t]=new this(r);else throw Error(nr+t+": "+r);return this}var to=eo(Nd);We=new to(1);var b;(function(n){n.AED="aed",n.AFN="afn",n.ALL="all",n.AMD="amd",n.ANG="ang",n.AOA="aoa",n.ARS="ars",n.AUD="aud",n.AWG="awg",n.AZN="azn",n.BAM="bam",n.BBD="bbd",n.BDT="bdt",n.BGN="bgn",n.BHD="bhd",n.BIF="bif",n.BMD="bmd",n.BND="bnd",n.BOB="bob",n.BOV="bov",n.BRL="brl",n.BSD="bsd",n.BTN="btn",n.BWP="bwp",n.BYN="byn",n.BYR="byr",n.BZD="bzd",n.CAD="cad",n.CDF="cdf",n.CHE="che",n.CHF="chf",n.CHW="chw",n.CLF="clf",n.CLP="clp",n.CNY="cny",n.COP="cop",n.COU="cou",n.CRC="crc",n.CUC="cuc",n.CUP="cup",n.CVE="cve",n.CZK="czk",n.DJF="djf",n.DKK="dkk",n.DOP="dop",n.DZD="dzd",n.EGP="egp",n.ERN="ern",n.ETB="etb",n.EUR="eur",n.FJD="fjd",n.FKP="fkp",n.GBP="gbp",n.GEL="gel",n.GHS="ghs",n.GIP="gip",n.GMD="gmd",n.GNF="gnf",n.GTQ="gtq",n.GYD="gyd",n.HKD="hkd",n.HNL="hnl",n.HRK="hrk",n.HTG="htg",n.HUF="huf",n.IDR="idr",n.ILS="ils",n.INR="inr",n.IQD="iqd",n.IRR="irr",n.ISK="isk",n.JMD="jmd",n.JOD="jod",n.JPY="jpy",n.KES="kes",n.KGS="kgs",n.KHR="khr",n.KMF="kmf",n.KPW="kpw",n.KRW="krw",n.KWD="kwd",n.KYD="kyd",n.KZT="kzt",n.LAK="lak",n.LBP="lbp",n.LKR="lkr",n.LRD="lrd",n.LSL="lsl",n.LTL="ltl",n.LVL="lvl",n.LYD="lyd",n.MAD="mad",n.MDL="mdl",n.MGA="mga",n.MKD="mkd",n.MMK="mmk",n.MNT="mnt",n.MOP="mop",n.MRO="mro",n.MUR="mur",n.MVR="mvr",n.MWK="mwk",n.MXN="mxn",n.MXV="mxv",n.MYR="myr",n.MZN="mzn",n.NAD="nad",n.NGN="ngn",n.NIO="nio",n.NOK="nok",n.NPR="npr",n.NZD="nzd",n.OMR="omr",n.PAB="pab",n.PEN="pen",n.PGK="pgk",n.PHP="php",n.PKR="pkr",n.PLN="pln",n.PYG="pyg",n.QAR="qar",n.RON="ron",n.RSD="rsd",n.RUB="rub",n.RWF="rwf",n.SAR="sar",n.SBD="sbd",n.SCR="scr",n.SDG="sdg",n.SEK="sek",n.SGD="sgd",n.SHP="shp",n.SLL="sll",n.SOS="sos",n.SRD="srd",n.SSP="ssp",n.STD="std",n.SVC="svc",n.SYP="syp",n.SZL="szl",n.THB="thb",n.TJS="tjs",n.TMT="tmt",n.TND="tnd",n.TOP="top",n.TRY="try",n.TTD="ttd",n.TWD="twd",n.TZS="tzs",n.UAH="uah",n.UGX="ugx",n.USD="usd",n.USN="usn",n.USS="uss",n.UYI="uyi",n.UYU="uyu",n.UZS="uzs",n.VEF="vef",n.VND="vnd",n.VUV="vuv",n.WST="wst",n.XAF="xaf",n.XAG="xag",n.XAU="xau",n.XBA="xba",n.XBB="xbb",n.XBC="xbc",n.XBD="xbd",n.XCD="xcd",n.XDR="xdr",n.XFU="xfu",n.XOF="xof",n.XPD="xpd",n.XPF="xpf",n.XPT="xpt",n.XSU="xsu",n.XTS="xts",n.XUA="xua",n.YER="yer",n.ZAR="zar",n.ZMW="zmw",n.ZWL="zwl"})(b||(b={}));b.AED+"",b.AFN+"",b.ALL+"",b.AMD+"",b.ANG+"",b.AOA+"",b.ARS+"",b.AUD+"",b.AWG+"",b.AZN+"",b.BAM+"",b.BBD+"",b.BDT+"",b.BGN+"",b.BHD+"",b.BIF+"",b.BMD+"",b.BND+"",b.BOB+"",b.BOV+"",b.BRL+"",b.BSD+"",b.BTN+"",b.BWP+"",b.BYR+"",b.BYN+"",b.BZD+"",b.CAD+"",b.CDF+"",b.CHE+"",b.CHF+"",b.CHW+"",b.CLF+"",b.CLP+"",b.CNY+"",b.COP+"",b.COU+"",b.CRC+"",b.CUC+"",b.CUP+"",b.CVE+"",b.CZK+"",b.DJF+"",b.DKK+"",b.DOP+"",b.DZD+"",b.EGP+"",b.ERN+"",b.ETB+"",b.EUR+"",b.FJD+"",b.FKP+"",b.GBP+"",b.GEL+"",b.GHS+"",b.GIP+"",b.GMD+"",b.GNF+"",b.GTQ+"",b.GYD+"",b.HKD+"",b.HNL+"",b.HRK+"",b.HTG+"",b.HUF+"",b.IDR+"",b.ILS+"",b.INR+"",b.IQD+"",b.IRR+"",b.ISK+"",b.JMD+"",b.JOD+"",b.JPY+"",b.KES+"",b.KGS+"",b.KHR+"",b.KMF+"",b.KPW+"",b.KRW+"",b.KWD+"",b.KYD+"",b.KZT+"",b.LAK+"",b.LBP+"",b.LKR+"",b.LRD+"",b.LSL+"",b.LTL+"",b.LVL+"",b.LYD+"",b.MAD+"",b.MDL+"",b.MGA+"",b.MKD+"",b.MMK+"",b.MNT+"",b.MOP+"",b.MRO+"",b.MUR+"",b.MVR+"",b.MWK+"",b.MXN+"",b.MXV+"",b.MYR+"",b.MZN+"",b.NAD+"",b.NGN+"",b.NIO+"",b.NOK+"",b.NPR+"",b.NZD+"",b.OMR+"",b.PAB+"",b.PEN+"",b.PGK+"",b.PHP+"",b.PKR+"",b.PLN+"",b.PYG+"",b.QAR+"",b.RON+"",b.RSD+"",b.RUB+"",b.RWF+"",b.SAR+"",b.SBD+"",b.SCR+"",b.SDG+"",b.SEK+"",b.SGD+"",b.SHP+"",b.SLL+"",b.SOS+"",b.SRD+"",b.SSP+"",b.STD+"",b.SVC+"",b.SYP+"",b.SZL+"",b.THB+"",b.TJS+"",b.TMT+"",b.TND+"",b.TOP+"",b.TRY+"",b.TTD+"",b.TWD+"",b.TZS+"",b.UAH+"",b.UGX+"",b.USD+"",b.USN+"",b.USS+"",b.UYI+"",b.UYU+"",b.UZS+"",b.VEF+"",b.VND+"",b.VUV+"",b.WST+"",b.XAF+"",b.XAG+"",b.XAU+"",b.XBA+"",b.XBB+"",b.XBC+"",b.XBD+"",b.XCD+"",b.XDR+"",b.XFU+"",b.XOF+"",b.XPD+"",b.XPF+"",b.XPT+"",b.XSU+"",b.XTS+"",b.XUA+"",b.YER+"",b.ZAR+"",b.ZMW+"",b.ZWL+"";var Vr={exports:{}};Vr.exports;var Wi;function xd(){return Wi||(Wi=1,function(n,e){var t=200,r="Expected a function",s="__lodash_hash_undefined__",i=1,a=2,o=9007199254740991,l="[object Arguments]",u="[object Array]",c="[object Boolean]",f="[object Date]",v="[object Error]",T="[object Function]",N="[object GeneratorFunction]",D="[object Map]",I="[object Number]",F="[object Object]",q="[object Promise]",U="[object RegExp]",Y="[object Set]",fe="[object String]",oe="[object Symbol]",ne="[object WeakMap]",Je="[object ArrayBuffer]",qe="[object DataView]",gt="[object Float32Array]",Ue="[object Float64Array]",ge="[object Int8Array]",gs="[object Int16Array]",wn="[object Int32Array]",En="[object Uint8Array]",ms="[object Uint8ClampedArray]",vs="[object Uint16Array]",Sn="[object Uint32Array]",mt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,vt=/^\w*$/,Tn=/^\./,Dr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tt=/[\\^$.*+?()[\]{}|]/g,Kt=/\\(\\)?/g,_t=/^\[object .+?Constructor\]$/,An=/^(?:0|[1-9]\d*)$/,pe={};pe[gt]=pe[Ue]=pe[ge]=pe[gs]=pe[wn]=pe[En]=pe[ms]=pe[vs]=pe[Sn]=!0,pe[l]=pe[u]=pe[Je]=pe[c]=pe[qe]=pe[f]=pe[v]=pe[T]=pe[D]=pe[I]=pe[F]=pe[U]=pe[Y]=pe[fe]=pe[ne]=!1;var lr=typeof Gn=="object"&&Gn&&Gn.Object===Object&&Gn,_s=typeof self=="object"&&self&&self.Object===Object&&self,Ve=lr||_s||Function("return this")(),xr=e&&!e.nodeType&&e,Lr=xr&&!0&&n&&!n.nodeType&&n,Ur=Lr&&Lr.exports===xr,Mr=Ur&&lr.process,In=function(){try{return Mr&&Mr.binding("util")}catch(h){}}(),kn=In&&In.isTypedArray;function ys(h,g){for(var S=-1,P=h?h.length:0;++S<P&&g(h[S],S,h)!==!1;);return h}function On(h,g){for(var S=-1,P=h?h.length:0;++S<P;)if(g(h[S],S,h))return!0;return!1}function bs(h){return function(g){return g==null?void 0:g[h]}}function Zt(h,g){for(var S=-1,P=Array(h);++S<h;)P[S]=g(S);return P}function Rn(h){return function(g){return h(g)}}function Nn(h,g){return h==null?void 0:h[g]}function jr(h){var g=!1;if(h!=null&&typeof h.toString!="function")try{g=!!(h+"")}catch(S){}return g}function Z(h){var g=-1,S=Array(h.size);return h.forEach(function(P,Q){S[++g]=[Q,P]}),S}function ot(h,g){return function(S){return h(g(S))}}function d(h){var g=-1,S=Array(h.size);return h.forEach(function(P){S[++g]=P}),S}var p=Array.prototype,m=Function.prototype,y=Object.prototype,E=Ve["__core-js_shared__"],w=function(){var h=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||"");return h?"Symbol(src)_1."+h:""}(),k=m.toString,A=y.hasOwnProperty,O=y.toString,z=RegExp("^"+k.call(A).replace(tt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),se=Ve.Symbol,X=Ve.Uint8Array,de=ot(Object.getPrototypeOf,Object),Me=Object.create,Pe=y.propertyIsEnumerable,$r=p.splice,Cr=ot(Object.keys,Object),ws=cr(Ve,"DataView"),Br=cr(Ve,"Map"),Es=cr(Ve,"Promise"),Ss=cr(Ve,"Set"),Ts=cr(Ve,"WeakMap"),Gr=cr(Object,"create"),ko=zt(ws),Oo=zt(Br),Ro=zt(Es),No=zt(Ss),Po=zt(Ts),Pn=se?se.prototype:void 0,As=Pn?Pn.valueOf:void 0,Ei=Pn?Pn.toString:void 0;function Wt(h){var g=-1,S=h?h.length:0;for(this.clear();++g<S;){var P=h[g];this.set(P[0],P[1])}}function Do(){this.__data__=Gr?Gr(null):{}}function xo(h){return this.has(h)&&delete this.__data__[h]}function Lo(h){var g=this.__data__;if(Gr){var S=g[h];return S===s?void 0:S}return A.call(g,h)?g[h]:void 0}function Uo(h){var g=this.__data__;return Gr?g[h]!==void 0:A.call(g,h)}function Mo(h,g){var S=this.__data__;return S[h]=Gr&&g===void 0?s:g,this}Wt.prototype.clear=Do,Wt.prototype.delete=xo,Wt.prototype.get=Lo,Wt.prototype.has=Uo,Wt.prototype.set=Mo;function yt(h){var g=-1,S=h?h.length:0;for(this.clear();++g<S;){var P=h[g];this.set(P[0],P[1])}}function jo(){this.__data__=[]}function $o(h){var g=this.__data__,S=xn(g,h);if(S<0)return!1;var P=g.length-1;return S==P?g.pop():$r.call(g,S,1),!0}function Co(h){var g=this.__data__,S=xn(g,h);return S<0?void 0:g[S][1]}function Bo(h){return xn(this.__data__,h)>-1}function Go(h,g){var S=this.__data__,P=xn(S,h);return P<0?S.push([h,g]):S[P][1]=g,this}yt.prototype.clear=jo,yt.prototype.delete=$o,yt.prototype.get=Co,yt.prototype.has=Bo,yt.prototype.set=Go;function bt(h){var g=-1,S=h?h.length:0;for(this.clear();++g<S;){var P=h[g];this.set(P[0],P[1])}}function Ho(){this.__data__={hash:new Wt,map:new(Br||yt),string:new Wt}}function Fo(h){return Ln(this,h).delete(h)}function qo(h){return Ln(this,h).get(h)}function Vo(h){return Ln(this,h).has(h)}function Ko(h,g){return Ln(this,h).set(h,g),this}bt.prototype.clear=Ho,bt.prototype.delete=Fo,bt.prototype.get=qo,bt.prototype.has=Vo,bt.prototype.set=Ko;function Dn(h){var g=-1,S=h?h.length:0;for(this.__data__=new bt;++g<S;)this.add(h[g])}function Zo(h){return this.__data__.set(h,s),this}function Wo(h){return this.__data__.has(h)}Dn.prototype.add=Dn.prototype.push=Zo,Dn.prototype.has=Wo;function wt(h){this.__data__=new yt(h)}function zo(){this.__data__=new yt}function Jo(h){return this.__data__.delete(h)}function Yo(h){return this.__data__.get(h)}function Xo(h){return this.__data__.has(h)}function Qo(h,g){var S=this.__data__;if(S instanceof yt){var P=S.__data__;if(!Br||P.length<t-1)return P.push([h,g]),this;S=this.__data__=new bt(P)}return S.set(h,g),this}wt.prototype.clear=zo,wt.prototype.delete=Jo,wt.prototype.get=Yo,wt.prototype.has=Xo,wt.prototype.set=Qo;function el(h,g){var S=Et(h)||Ni(h)?Zt(h.length,String):[],P=S.length,Q=!!P;for(var C in h)A.call(h,C)&&!(Q&&(C=="length"||Ii(C,P)))&&S.push(C);return S}function xn(h,g){for(var S=h.length;S--;)if(Ri(h[S][0],g))return S;return-1}function tl(h){return ur(h)?Me(h):{}}var rl=ml();function nl(h,g){return h&&rl(h,g,$n)}function Si(h,g){g=Un(g,h)?[g]:Ti(g);for(var S=0,P=g.length;h!=null&&S<P;)h=h[Mn(g[S++])];return S&&S==P?h:void 0}function sl(h){return O.call(h)}function il(h,g){return h!=null&&g in Object(h)}function Is(h,g,S,P,Q){return h===g?!0:h==null||g==null||!ur(h)&&!jn(g)?h!==h&&g!==g:al(h,g,Is,S,P,Q)}function al(h,g,S,P,Q,C){var ie=Et(h),Se=Et(g),Ee=u,De=u;ie||(Ee=Pt(h),Ee=Ee==l?F:Ee),Se||(De=Pt(g),De=De==l?F:De);var Be=Ee==F&&!jr(h),Ge=De==F&&!jr(g),je=Ee==De;if(je&&!Be)return C||(C=new wt),ie||Di(h)?Ai(h,g,S,P,Q,C):vl(h,g,Ee,S,P,Q,C);if(!(Q&a)){var Ye=Be&&A.call(h,"__wrapped__"),Xe=Ge&&A.call(g,"__wrapped__");if(Ye||Xe){var Dt=Ye?h.value():h,St=Xe?g.value():g;return C||(C=new wt),S(Dt,St,P,Q,C)}}return je?(C||(C=new wt),_l(h,g,S,P,Q,C)):!1}function ol(h,g,S,P){var Q=S.length,C=Q;if(h==null)return!C;for(h=Object(h);Q--;){var ie=S[Q];if(ie[2]?ie[1]!==h[ie[0]]:!(ie[0]in h))return!1}for(;++Q<C;){ie=S[Q];var Se=ie[0],Ee=h[Se],De=ie[1];if(ie[2]){if(Ee===void 0&&!(Se in h))return!1}else{var Be=new wt,Ge;if(!(Ge===void 0?Is(De,Ee,P,i|a,Be):Ge))return!1}}return!0}function ll(h){if(!ur(h)||El(h))return!1;var g=Os(h)||jr(h)?z:_t;return g.test(zt(h))}function cl(h){return jn(h)&&Rs(h.length)&&!!pe[O.call(h)]}function ul(h){return typeof h=="function"?h:h==null?Nl:typeof h=="object"?Et(h)?fl(h[0],h[1]):hl(h):Pl(h)}function dl(h){if(!Sl(h))return Cr(h);var g=[];for(var S in Object(h))A.call(h,S)&&S!="constructor"&&g.push(S);return g}function hl(h){var g=yl(h);return g.length==1&&g[0][2]?Oi(g[0][0],g[0][1]):function(S){return S===h||ol(S,h,g)}}function fl(h,g){return Un(h)&&ki(g)?Oi(Mn(h),g):function(S){var P=kl(S,h);return P===void 0&&P===g?Ol(S,h):Is(g,P,void 0,i|a)}}function pl(h){return function(g){return Si(g,h)}}function gl(h){if(typeof h=="string")return h;if(Ns(h))return Ei?Ei.call(h):"";var g=h+"";return g=="0"&&1/h==-1/0?"-0":g}function Ti(h){return Et(h)?h:Tl(h)}function ml(h){return function(g,S,P){for(var Q=-1,C=Object(g),ie=P(g),Se=ie.length;Se--;){var Ee=ie[++Q];if(S(C[Ee],Ee,C)===!1)break}return g}}function Ai(h,g,S,P,Q,C){var ie=Q&a,Se=h.length,Ee=g.length;if(Se!=Ee&&!(ie&&Ee>Se))return!1;var De=C.get(h);if(De&&C.get(g))return De==g;var Be=-1,Ge=!0,je=Q&i?new Dn:void 0;for(C.set(h,g),C.set(g,h);++Be<Se;){var Ye=h[Be],Xe=g[Be];if(P)var Dt=ie?P(Xe,Ye,Be,g,h,C):P(Ye,Xe,Be,h,g,C);if(Dt!==void 0){if(Dt)continue;Ge=!1;break}if(je){if(!On(g,function(St,Jt){if(!je.has(Jt)&&(Ye===St||S(Ye,St,P,Q,C)))return je.add(Jt)})){Ge=!1;break}}else if(!(Ye===Xe||S(Ye,Xe,P,Q,C))){Ge=!1;break}}return C.delete(h),C.delete(g),Ge}function vl(h,g,S,P,Q,C,ie){switch(S){case qe:if(h.byteLength!=g.byteLength||h.byteOffset!=g.byteOffset)return!1;h=h.buffer,g=g.buffer;case Je:return!(h.byteLength!=g.byteLength||!P(new X(h),new X(g)));case c:case f:case I:return Ri(+h,+g);case v:return h.name==g.name&&h.message==g.message;case U:case fe:return h==g+"";case D:var Se=Z;case Y:var Ee=C&a;if(Se||(Se=d),h.size!=g.size&&!Ee)return!1;var De=ie.get(h);if(De)return De==g;C|=i,ie.set(h,g);var Be=Ai(Se(h),Se(g),P,Q,C,ie);return ie.delete(h),Be;case oe:if(As)return As.call(h)==As.call(g)}return!1}function _l(h,g,S,P,Q,C){var ie=Q&a,Se=$n(h),Ee=Se.length,De=$n(g),Be=De.length;if(Ee!=Be&&!ie)return!1;for(var Ge=Ee;Ge--;){var je=Se[Ge];if(!(ie?je in g:A.call(g,je)))return!1}var Ye=C.get(h);if(Ye&&C.get(g))return Ye==g;var Xe=!0;C.set(h,g),C.set(g,h);for(var Dt=ie;++Ge<Ee;){je=Se[Ge];var St=h[je],Jt=g[je];if(P)var xi=ie?P(Jt,St,je,g,h,C):P(St,Jt,je,h,g,C);if(!(xi===void 0?St===Jt||S(St,Jt,P,Q,C):xi)){Xe=!1;break}Dt||(Dt=je=="constructor")}if(Xe&&!Dt){var Cn=h.constructor,Bn=g.constructor;Cn!=Bn&&"constructor"in h&&"constructor"in g&&!(typeof Cn=="function"&&Cn instanceof Cn&&typeof Bn=="function"&&Bn instanceof Bn)&&(Xe=!1)}return C.delete(h),C.delete(g),Xe}function Ln(h,g){var S=h.__data__;return wl(g)?S[typeof g=="string"?"string":"hash"]:S.map}function yl(h){for(var g=$n(h),S=g.length;S--;){var P=g[S],Q=h[P];g[S]=[P,Q,ki(Q)]}return g}function cr(h,g){var S=Nn(h,g);return ll(S)?S:void 0}var Pt=sl;(ws&&Pt(new ws(new ArrayBuffer(1)))!=qe||Br&&Pt(new Br)!=D||Es&&Pt(Es.resolve())!=q||Ss&&Pt(new Ss)!=Y||Ts&&Pt(new Ts)!=ne)&&(Pt=function(h){var g=O.call(h),S=g==F?h.constructor:void 0,P=S?zt(S):void 0;if(P)switch(P){case ko:return qe;case Oo:return D;case Ro:return q;case No:return Y;case Po:return ne}return g});function bl(h,g,S){g=Un(g,h)?[g]:Ti(g);for(var P,Q=-1,ie=g.length;++Q<ie;){var C=Mn(g[Q]);if(!(P=h!=null&&S(h,C)))break;h=h[C]}if(P)return P;var ie=h?h.length:0;return!!ie&&Rs(ie)&&Ii(C,ie)&&(Et(h)||Ni(h))}function Ii(h,g){return g=g==null?o:g,!!g&&(typeof h=="number"||An.test(h))&&h>-1&&h%1==0&&h<g}function Un(h,g){if(Et(h))return!1;var S=typeof h;return S=="number"||S=="symbol"||S=="boolean"||h==null||Ns(h)?!0:vt.test(h)||!mt.test(h)||g!=null&&h in Object(g)}function wl(h){var g=typeof h;return g=="string"||g=="number"||g=="symbol"||g=="boolean"?h!=="__proto__":h===null}function El(h){return!!w&&w in h}function Sl(h){var g=h&&h.constructor,S=typeof g=="function"&&g.prototype||y;return h===S}function ki(h){return h===h&&!ur(h)}function Oi(h,g){return function(S){return S==null?!1:S[h]===g&&(g!==void 0||h in Object(S))}}var Tl=ks(function(h){h=Il(h);var g=[];return Tn.test(h)&&g.push(""),h.replace(Dr,function(S,P,Q,C){g.push(Q?C.replace(Kt,"$1"):P||S)}),g});function Mn(h){if(typeof h=="string"||Ns(h))return h;var g=h+"";return g=="0"&&1/h==-1/0?"-0":g}function zt(h){if(h!=null){try{return k.call(h)}catch(g){}try{return h+""}catch(g){}}return""}function ks(h,g){if(typeof h!="function"||g&&typeof g!="function")throw new TypeError(r);var S=function(){var P=arguments,Q=g?g.apply(this,P):P[0],C=S.cache;if(C.has(Q))return C.get(Q);var ie=h.apply(this,P);return S.cache=C.set(Q,ie),ie};return S.cache=new(ks.Cache||bt),S}ks.Cache=bt;function Ri(h,g){return h===g||h!==h&&g!==g}function Ni(h){return Al(h)&&A.call(h,"callee")&&(!Pe.call(h,"callee")||O.call(h)==l)}var Et=Array.isArray;function Pi(h){return h!=null&&Rs(h.length)&&!Os(h)}function Al(h){return jn(h)&&Pi(h)}function Os(h){var g=ur(h)?O.call(h):"";return g==T||g==N}function Rs(h){return typeof h=="number"&&h>-1&&h%1==0&&h<=o}function ur(h){var g=typeof h;return!!h&&(g=="object"||g=="function")}function jn(h){return!!h&&typeof h=="object"}function Ns(h){return typeof h=="symbol"||jn(h)&&O.call(h)==oe}var Di=kn?Rn(kn):cl;function Il(h){return h==null?"":gl(h)}function kl(h,g,S){var P=h==null?void 0:Si(h,g);return P===void 0?S:P}function Ol(h,g){return h!=null&&bl(h,g,il)}function $n(h){return Pi(h)?el(h):dl(h)}function Rl(h,g,S){var P=Et(h)||Di(h);if(g=ul(g),S==null)if(P||ur(h)){var Q=h.constructor;P?S=Et(h)?new Q:[]:S=Os(Q)?tl(de(h)):{}}else S={};return(P?ys:nl)(h,function(C,ie,Se){return g(S,C,ie,Se)}),S}function Nl(h){return h}function Pl(h){return Un(h)?bs(Mn(h)):pl(h)}n.exports=Rl}(Vr,Vr.exports)),Vr.exports}xd();class Ld extends gn{constructor(t){super();ue(this,"sdk",null);ue(this,"isConnected",!1);ue(this,"isDemo",!1);ue(this,"currentUser",null);ue(this,"config");this.config=t}async initialize(){var t;try{if(!this.isRunningInDiscord()&&!this.config.forceDiscordMode)return console.log("🔧 Running in demo mode - Discord not detected"),await this.initializeDemoMode(),!0;console.log("🎯 Initializing Discord SDK..."),this.config.forceDiscordMode&&console.log("🔧 Force Discord mode enabled - will attempt Discord auth even if not detected"),this.sdk=new Rd(this.config.clientId);const r=this.sdk.ready(),s=new Promise((a,o)=>setTimeout(()=>o(new Error("Discord SDK ready timeout")),1e4));await Promise.race([r,s]),console.log("✅ Discord SDK ready");const i=await this.sdk.commands.authenticate({access_token:null});if(console.log("✅ Authentication successful:",i),i.user)this.currentUser={id:i.user.id,username:i.user.username,discriminator:i.user.discriminator||"0",avatar:i.user.avatar||void 0,globalName:i.user.global_name||i.user.username},console.log("✅ User authenticated:",this.currentUser);else throw new Error("Failed to get user information from Discord");return await this.setupActivity(),this.isConnected=!0,this.emit("connected",this.currentUser),console.log("✅ Discord authenticated: ".concat((t=this.currentUser)==null?void 0:t.username)),!0}catch(r){return console.error("❌ Discord initialization failed:",r),this.config.forceDiscordMode&&(console.error("❌ Force Discord mode was enabled but authentication failed"),console.error("Check that:"),console.error("- Your Discord app is configured correctly"),console.error("- The client ID is correct"),console.error("- The app has proper redirect URLs set up")),console.log("🔧 Falling back to demo mode due to Discord auth failure"),await this.initializeDemoMode(),!0}}async initializeDemoMode(){this.isDemo=!0,this.isConnected=!0,this.currentUser={id:"demo_".concat(Math.random().toString(36).substr(2,9)),username:"DemoUser".concat(Math.floor(Math.random()*1e3)),discriminator:"0000",globalName:"Demo User"},console.log("🎮 Demo mode initialized"),this.emit("connected",this.currentUser)}isRunningInDiscord(){var t,r;try{const s=new URLSearchParams(window.location.search),i=typeof window<"u"&&"DiscordSDK"in window,a=s.has("frame_id"),o=s.has("instance_id"),l=s.has("channel_id"),u=s.has("guild_id"),c=typeof window<"u"&&window.self!==window.top&&(((r=(t=window.location.ancestorOrigins)==null?void 0:t[0])==null?void 0:r.includes("discord"))||document.referrer.includes("discord")),f=s.has("client_id"),v=typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes("discord"),T=i||a||o||l||u||c||f||v;return console.log("🔍 Discord Detection:",{hasDiscordSDK:i,hasDiscordFrameId:a,hasDiscordInstanceId:o,hasDiscordChannelId:l,hasDiscordGuildId:u,isInDiscordFrame:c,hasClientId:f,hasDiscordUserAgent:v,forceMode:this.config.forceDiscordMode,isDiscord:T}),T}catch(s){return console.error("Error during Discord detection:",s),!1}}async setupActivity(){if(!(!this.sdk||this.isDemo))try{await this.sdk.commands.setActivity({activity:{type:0,details:"Playing board games",state:"In lobby",timestamps:{start:Date.now()},assets:{large_image:"game_lobby",large_text:"Discord Game Hub"},instance:!0}}),console.log("✅ Discord activity set")}catch(t){console.warn("⚠️ Failed to set Discord activity:",t)}}async updateActivity(t,r){if(!(!this.sdk||this.isDemo))try{await this.sdk.commands.setActivity({activity:{type:0,details:t,state:r||"In game",timestamps:{start:Date.now()},assets:{large_image:"game_lobby",large_text:"Discord Game Hub"},instance:!0}})}catch(s){console.warn("⚠️ Failed to update Discord activity:",s)}}getCurrentUser(){return this.currentUser}isConnectedToDiscord(){return this.isConnected}isDemoMode(){return this.isDemo}async getChannelInfo(){if(!this.sdk||this.isDemo)return{id:"demo_channel",name:"Demo Voice Channel",type:"voice"};try{return console.warn("⚠️ getChannel requires channel_id in current SDK version"),null}catch(t){return console.warn("⚠️ Failed to get channel info:",t),null}}async getGuildInfo(){if(!this.sdk||this.isDemo)return{id:"demo_guild",name:"Demo Server"};try{return console.warn("⚠️ getGuild not available in current SDK"),null}catch(t){return console.warn("⚠️ Failed to get guild info:",t),null}}broadcastMessage(t,r){this.emit("message",{type:t,data:r,timestamp:new Date})}onMessage(t){this.on("message",t)}disconnect(){this.sdk&&(this.sdk=null),this.isConnected=!1,this.currentUser=null,this.emit("disconnected"),console.log("🔌 Disconnected from Discord")}}const Ud="modulepreload",Md=function(n){return"/"+n},zi={},_n=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(t.map(l=>{if(l=Md(l),l in zi)return;zi[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector('link[href="'.concat(l,'"]').concat(c)))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Ud,u||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((v,T)=>{f.addEventListener("load",v),f.addEventListener("error",()=>T(new Error("Unable to preload CSS for ".concat(l))))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})},jd=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>_n(async()=>{const{default:r}=await Promise.resolve().then(()=>Nr);return{default:r}},[]).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class vi extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class $d extends vi{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Ji extends vi{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Yi extends vi{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Ys;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Ys||(Ys={}));var Cd=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(f){a(f)}}function l(c){try{u(r.throw(c))}catch(f){a(f)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};class Bd{constructor(e,{headers:t={},customFetch:r,region:s=Ys.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=jd(r)}setAuth(e){this.headers.Authorization="Bearer ".concat(e)}invoke(e,t={}){var r;return Cd(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:a}=t;let o={},{region:l}=t;l||(l=this.region);const u=new URL("".concat(this.url,"/").concat(e));l&&l!=="any"&&(o["x-region"]=l,u.searchParams.set("forceFunctionRegion",l));let c;a&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=a):typeof a=="string"?(o["Content-Type"]="text/plain",c=a):typeof FormData<"u"&&a instanceof FormData?c=a:(o["Content-Type"]="application/json",c=JSON.stringify(a)));const f=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:c}).catch(D=>{throw new $d(D)}),v=f.headers.get("x-relay-error");if(v&&v==="true")throw new Ji(f);if(!f.ok)throw new Yi(f);let T=((r=f.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),N;return T==="application/json"?N=yield f.json():T==="application/octet-stream"?N=yield f.blob():T==="text/event-stream"?N=f:T==="multipart/form-data"?N=yield f.formData():N=yield f.text(),{data:N,error:null,response:f}}catch(s){return{data:null,error:s,response:s instanceof Yi||s instanceof Ji?s.context:void 0}}})}}var et=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gd(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var He={},_i={},us={},yn={},ds={},hs={},Hd=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ar=Hd();const Fd=Ar.fetch,ro=Ar.fetch.bind(Ar),no=Ar.Headers,qd=Ar.Request,Vd=Ar.Response,Nr=Object.freeze(Object.defineProperty({__proto__:null,Headers:no,Request:qd,Response:Vd,default:ro,fetch:Fd},Symbol.toStringTag,{value:"Module"})),Kd=Gd(Nr);var fs={};Object.defineProperty(fs,"__esModule",{value:!0});let Zd=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};fs.default=Zd;var so=et&&et.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(hs,"__esModule",{value:!0});const Wd=so(Kd),zd=so(fs);let Jd=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Wd.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,o,l,u;let c=null,f=null,v=null,T=i.status,N=i.statusText;if(i.ok){if(this.method!=="HEAD"){const q=await i.text();q===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((a=this.headers.get("Accept"))===null||a===void 0)&&a.includes("application/vnd.pgrst.plan+text"))?f=q:f=JSON.parse(q))}const I=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),F=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");I&&F&&F.length>1&&(v=parseInt(F[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(c={code:"PGRST116",details:"Results contain ".concat(f.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,v=null,T=406,N="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const I=await i.text();try{c=JSON.parse(I),Array.isArray(c)&&i.status===404&&(f=[],c=null,T=200,N="OK")}catch(F){i.status===404&&I===""?(T=204,N="No Content"):c={message:I}}if(c&&this.isMaybeSingle&&(!((u=c==null?void 0:c.details)===null||u===void 0)&&u.includes("0 rows"))&&(c=null,T=200,N="OK"),c&&this.shouldThrowOnError)throw new zd.default(c)}return{error:c,data:f,count:v,status:T,statusText:N}});return this.shouldThrowOnError||(s=s.catch(i=>{var a,o,l;return{error:{message:"".concat((a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError",": ").concat(i==null?void 0:i.message),details:"".concat((o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""),hint:"",code:"".concat((l=i==null?void 0:i.code)!==null&&l!==void 0?l:"")},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}};hs.default=Jd;var Yd=et&&et.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ds,"__esModule",{value:!0});const Xd=Yd(hs);let Qd=class extends Xd.default{select(e){let t=!1;const r=(e!=null?e:"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}){const a=i?"".concat(i,".order"):"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,"".concat(o?"".concat(o,","):"").concat(e,".").concat(t?"asc":"desc").concat(r===void 0?"":r?".nullsfirst":".nullslast")),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"limit":"".concat(r,".limit");return this.url.searchParams.set(s,"".concat(e)),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const i=typeof s>"u"?"offset":"".concat(s,".offset"),a=typeof s>"u"?"limit":"".concat(s,".limit");return this.url.searchParams.set(i,"".concat(e)),this.url.searchParams.set(a,"".concat(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept","application/vnd.pgrst.plan+".concat(a,'; for="').concat(u,'"; options=').concat(l,";")),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer","max-affected=".concat(e)),this}};ds.default=Qd;var eh=et&&et.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(yn,"__esModule",{value:!0});const th=eh(ds);let rh=class extends th.default{eq(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this}neq(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this}gt(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this}gte(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this}lt(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this}lte(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this}like(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this}likeAllOf(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this}likeAnyOf(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this}ilike(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this}is(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this}in(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?'"'.concat(s,'"'):"".concat(s)).join(",");return this.url.searchParams.append(e,"in.(".concat(r,")")),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this}rangeGt(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this}rangeGte(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this}rangeLt(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this}rangeLte(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this}textSearch(e,t,{config:r,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const a=r===void 0?"":"(".concat(r,")");return this.url.searchParams.append(e,"".concat(i,"fts").concat(a,".").concat(t)),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,"eq.".concat(r))}),this}not(e,t,r){return this.url.searchParams.append(e,"not.".concat(t,".").concat(r)),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?"".concat(r,".or"):"or";return this.url.searchParams.append(s,"(".concat(e,")")),this}filter(e,t,r){return this.url.searchParams.append(e,"".concat(t,".").concat(r)),this}};yn.default=rh;var nh=et&&et.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(us,"__esModule",{value:!0});const Hr=nh(yn);let sh=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=s}select(e,{head:t=!1,count:r}={}){const s=t?"HEAD":"GET";let i=!1;const a=(e!=null?e:"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),r&&this.headers.append("Prefer","count=".concat(r)),new Hr.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var s;const i="POST";if(t&&this.headers.append("Prefer","count=".concat(t)),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>'"'.concat(l,'"'));this.url.searchParams.set("columns",o.join(","))}}return new Hr.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){var a;const o="POST";if(this.headers.append("Prefer","resolution=".concat(r?"ignore":"merge","-duplicates")),t!==void 0&&this.url.searchParams.set("on_conflict",t),s&&this.headers.append("Prefer","count=".concat(s)),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(l.length>0){const u=[...new Set(l)].map(c=>'"'.concat(c,'"'));this.url.searchParams.set("columns",u.join(","))}}return new Hr.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:t}={}){var r;const s="PATCH";return t&&this.headers.append("Prefer","count=".concat(t)),new Hr.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE";return e&&this.headers.append("Prefer","count=".concat(e)),new Hr.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}};us.default=sh;var io=et&&et.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(_i,"__esModule",{value:!0});const ih=io(us),ah=io(yn);let oh=class ao{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=s}from(e){const t=new URL("".concat(this.url,"/").concat(e));return new ih.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new ao(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:s=!1,count:i}={}){var a;let o;const l=new URL("".concat(this.url,"/rpc/").concat(e));let u;r||s?(o=r?"HEAD":"GET",Object.entries(t).filter(([f,v])=>v!==void 0).map(([f,v])=>[f,Array.isArray(v)?"{".concat(v.join(","),"}"):"".concat(v)]).forEach(([f,v])=>{l.searchParams.append(f,v)})):(o="POST",u=t);const c=new Headers(this.headers);return i&&c.set("Prefer","count=".concat(i)),new ah.default({method:o,url:l,headers:c,schema:this.schemaName,body:u,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};_i.default=oh;var Pr=et&&et.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(He,"__esModule",{value:!0});He.PostgrestError=He.PostgrestBuilder=He.PostgrestTransformBuilder=He.PostgrestFilterBuilder=He.PostgrestQueryBuilder=He.PostgrestClient=void 0;const oo=Pr(_i);He.PostgrestClient=oo.default;const lo=Pr(us);He.PostgrestQueryBuilder=lo.default;const co=Pr(yn);He.PostgrestFilterBuilder=co.default;const uo=Pr(ds);He.PostgrestTransformBuilder=uo.default;const ho=Pr(hs);He.PostgrestBuilder=ho.default;const fo=Pr(fs);He.PostgrestError=fo.default;var lh=He.default={PostgrestClient:oo.default,PostgrestQueryBuilder:lo.default,PostgrestFilterBuilder:co.default,PostgrestTransformBuilder:uo.default,PostgrestBuilder:ho.default,PostgrestError:fo.default};const{PostgrestClient:ch,PostgrestQueryBuilder:lp,PostgrestFilterBuilder:cp,PostgrestTransformBuilder:up,PostgrestBuilder:dp,PostgrestError:hp}=lh;class uh{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:"Node.js ".concat(t," detected but native WebSocket not found."),workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:"Node.js ".concat(t," detected without native WebSocket support."),workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+="\n\nSuggested solution: ".concat(e.workaround)),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch(e){return!1}}}const dh="2.15.1",hh="realtime-js/".concat(dh),fh="1.0.0",Xs=1e4,ph=1e3,gh=100;var Wr;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Wr||(Wr={}));var Ae;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Ae||(Ae={}));var nt;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(nt||(nt={}));var Qs;(function(n){n.websocket="websocket"})(Qs||(Qs={}));var tr;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(tr||(tr={}));class mh{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=r.decode(e.slice(a,a+s));a=a+s;const l=r.decode(e.slice(a,a+i));a=a+i;const u=JSON.parse(r.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:u}}}class po{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ve;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(ve||(ve={}));const Xi=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,a)=>(i[a]=vh(a,n,e,s),i),{})},vh=(n,e,t,r)=>{const s=e.find(o=>o.name===n),i=s==null?void 0:s.type,a=t[n];return i&&!r.includes(i)?go(i,a):ei(a)},go=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return wh(e,t)}switch(n){case ve.bool:return _h(e);case ve.float4:case ve.float8:case ve.int2:case ve.int4:case ve.int8:case ve.numeric:case ve.oid:return yh(e);case ve.json:case ve.jsonb:return bh(e);case ve.timestamp:return Eh(e);case ve.abstime:case ve.date:case ve.daterange:case ve.int4range:case ve.int8range:case ve.money:case ve.reltime:case ve.text:case ve.time:case ve.timestamptz:case ve.timetz:case ve.tsrange:case ve.tstzrange:return ei(e);default:return ei(e)}},ei=n=>n,_h=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},yh=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},bh=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log("JSON parse error: ".concat(e)),n}return n},wh=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const a=n.slice(1,t);try{i=JSON.parse("["+a+"]")}catch(o){i=a?a.split(","):[]}return i.map(o=>go(e,o))}return n},Eh=n=>typeof n=="string"?n.replace(" ","T"):n,mo=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Ms{constructor(e,t,r={},s=Xs){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Qi;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Qi||(Qi={}));class zr{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=zr.syncState(this.state,s,i,a),this.pendingDiffs.forEach(l=>{this.state=zr.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=zr.syncDiff(this.state,s,i,a),o())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const i=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(i,(u,c)=>{a[u]||(l[u]=c)}),this.map(a,(u,c)=>{const f=i[u];if(f){const v=c.map(I=>I.presence_ref),T=f.map(I=>I.presence_ref),N=c.filter(I=>T.indexOf(I.presence_ref)<0),D=f.filter(I=>v.indexOf(I.presence_ref)<0);N.length>0&&(o[u]=N),D.length>0&&(l[u]=D)}else o[u]=c}),this.syncDiff(i,{joins:o,leaves:l},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(o,l)=>{var u;const c=(u=e[o])!==null&&u!==void 0?u:[];if(e[o]=this.cloneDeep(l),c.length>0){const f=e[o].map(T=>T.presence_ref),v=c.filter(T=>f.indexOf(T.presence_ref)<0);e[o].unshift(...v)}r(o,c,l)}),this.map(a,(o,l)=>{let u=e[o];if(!u)return;const c=l.map(f=>f.presence_ref);u=u.filter(f=>c.indexOf(f.presence_ref)<0),e[o]=u,s(o,u,l),u.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ea;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(ea||(ea={}));var Jr;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Jr||(Jr={}));var kt;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(kt||(kt={}));class yi{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Ae.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Ms(this,nt.join,this.params,this.timeout),this.rejoinTimer=new po(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ae.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel","close ".concat(this.topic," ").concat(this._joinRef())),this.state=Ae.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),s),this.state=Ae.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel","timeout ".concat(this.topic),this.joinPush.timeout),this.state=Ae.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),s),this.state=Ae.errored,this.rejoinTimer.scheduleTimeout())}),this._on(nt.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new zr(this),this.broadcastEndpointURL=mo(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Ae.closed){const{config:{broadcast:i,presence:a,private:o}}=this.params,l=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(v=>v.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[Jr.PRESENCE]&&this.bindings[Jr.PRESENCE].length>0,c={},f={broadcast:i,presence:Object.assign(Object.assign({},a),{enabled:u}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this._onError(v=>e==null?void 0:e(kt.CHANNEL_ERROR,v)),this._onClose(()=>e==null?void 0:e(kt.CLOSED)),this.updateJoinPayload(Object.assign({config:f},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:v})=>{var T;if(this.socket.setAuth(),v===void 0){e==null||e(kt.SUBSCRIBED);return}else{const N=this.bindings.postgres_changes,D=(T=N==null?void 0:N.length)!==null&&T!==void 0?T:0,I=[];for(let F=0;F<D;F++){const q=N[F],{filter:{event:U,schema:Y,table:fe,filter:oe}}=q,ne=v&&v[F];if(ne&&ne.event===U&&ne.schema===Y&&ne.table===fe&&ne.filter===oe)I.push(Object.assign(Object.assign({},q),{id:ne.id}));else{this.unsubscribe(),this.state=Ae.errored,e==null||e(kt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=I,e&&e(kt.SUBSCRIBED);return}}).receive("error",v=>{this.state=Ae.errored,e==null||e(kt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(kt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===Ae.joined&&e===Jr.PRESENCE&&(this.socket.log("channel","resubscribe to ".concat(this.topic," due to change in presence callbacks on joined channel")),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?"Bearer ".concat(this.socket.accessTokenValue):"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ae.leaving;const t=()=>{this.socket.log("channel","leave ".concat(this.topic)),this._trigger(nt.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new Ms(this,nt.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ae.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),a}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");let s=new Ms(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>gh){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel","discarded push due to buffer overflow: ".concat(t.event),t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:u,join:c}=nt;if(r&&[o,l,u,c].indexOf(a)>=0&&r!==this._joinRef())return;let v=this._onMessage(a,t,r);if(t&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(T=>{var N,D,I;return((N=T.filter)===null||N===void 0?void 0:N.event)==="*"||((I=(D=T.filter)===null||D===void 0?void 0:D.event)===null||I===void 0?void 0:I.toLocaleLowerCase())===a}).map(T=>T.callback(v,r)):(i=this.bindings[a])===null||i===void 0||i.filter(T=>{var N,D,I,F,q,U;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in T){const Y=T.id,fe=(N=T.filter)===null||N===void 0?void 0:N.event;return Y&&((D=t.ids)===null||D===void 0?void 0:D.includes(Y))&&(fe==="*"||(fe==null?void 0:fe.toLocaleLowerCase())===((I=t.data)===null||I===void 0?void 0:I.type.toLocaleLowerCase()))}else{const Y=(q=(F=T==null?void 0:T.filter)===null||F===void 0?void 0:F.event)===null||q===void 0?void 0:q.toLocaleLowerCase();return Y==="*"||Y===((U=t==null?void 0:t.event)===null||U===void 0?void 0:U.toLocaleLowerCase())}else return T.type.toLocaleLowerCase()===a}).map(T=>{if(typeof v=="object"&&"ids"in v){const N=v.data,{schema:D,table:I,commit_timestamp:F,type:q,errors:U}=N;v=Object.assign(Object.assign({},{schema:D,table:I,commit_timestamp:F,eventType:q,new:{},old:{},errors:U}),this._getPayloadRecords(N))}T.callback(v,r)})}_isClosed(){return this.state===Ae.closed}_isJoined(){return this.state===Ae.joined}_isJoining(){return this.state===Ae.joining}_isLeaving(){return this.state===Ae.leaving}_replyEventName(e){return"chan_reply_".concat(e)}_on(e,t,r){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&yi.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(nt.close,{},e)}_onError(e){this._on(nt.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ae.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Xi(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Xi(e.columns,e.old_record)),t}}const ta=()=>{},Vn={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Sh=[1e3,2e3,5e3,1e4],Th=1e4,Ah='\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });';class Ih{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Xs,this.transport=null,this.heartbeatIntervalMs=Vn.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ta,this.ref=0,this.reconnectTimer=null,this.logger=ta,this.conn=null,this.sendBuffer=[],this.serializer=new mh,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...a)=>_n(async()=>{const{default:o}=await Promise.resolve().then(()=>Nr);return{default:o}},void 0).then(({default:o})=>o(...a)).catch(o=>{throw new Error("Failed to load @supabase/node-fetch: ".concat(o.message,". ")+"This is required for HTTP requests in Node.js environments without native fetch.")}):i=fetch,(...a)=>i(...a)},!(!((r=t==null?void 0:t.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint="".concat(e,"/").concat(Qs.websocket),this.httpEndpoint=mo(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=uh.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error("".concat(t,"\n\n")+'To use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })'):new Error("WebSocket not available: ".concat(t))}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:fh}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,t!=null?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Wr.connecting:return tr.Connecting;case Wr.open:return tr.Open;case Wr.closing:return tr.Closing;default:return tr.Closed}}isConnected(){return this.connectionState()===tr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r="realtime:".concat(e),s=this.getChannels().find(i=>i.topic===r);if(s)return s;{const i=new yi("realtime:".concat(e),t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:r,payload:s,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push","".concat(t," ").concat(r," (").concat(i,")"),s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(ph,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Vn.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:i,ref:a}=t,o=a?"(".concat(a,")"):"",l=i.status||"";this.log("receive","".concat(l," ").concat(r," ").concat(s," ").concat(o).trim(),i),this.channels.filter(u=>u._isMember(r)).forEach(u=>u._trigger(s,i,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport","connected to ".concat(this.endpointURL())),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker","starting worker for from ".concat(this.workerUrl)):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport","".concat(e)),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(nt.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return"".concat(e).concat(r).concat(s)}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([Ah],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const s={access_token:t,version:hh};t&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(nt.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error","error setting auth in ".concat(e),t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(s){this.log("error","error in ".concat(e," callback"),s)}})}catch(r){this.log("error","error triggering ".concat(e," callbacks"),r)}}_setupReconnectionTimer(){this.reconnectTimer=new po(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Vn.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,i,a,o,l,u;if(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:Xs,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:Vn.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(o=e==null?void 0:e.reconnectAfterMs)!==null&&o!==void 0?o:c=>Sh[c-1]||Th,this.encode=(l=e==null?void 0:e.encode)!==null&&l!==void 0?l:(c,f)=>f(JSON.stringify(c)),this.decode=(u=e==null?void 0:e.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class bi extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ie(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class kh extends bi{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class ti extends bi{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Oh=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(f){a(f)}}function l(c){try{u(r.throw(c))}catch(f){a(f)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};const vo=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>_n(async()=>{const{default:r}=await Promise.resolve().then(()=>Nr);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Rh=()=>Oh(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield _n(()=>Promise.resolve().then(()=>Nr),void 0)).Response:Response}),ri=n=>{if(Array.isArray(n))return n.map(t=>ri(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=ri(r)}),e},Nh=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var or=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(f){a(f)}}function l(c){try{u(r.throw(c))}catch(f){a(f)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};const js=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Ph=(n,e,t)=>or(void 0,void 0,void 0,function*(){const r=yield Rh();n instanceof r&&!(t!=null&&t.noResolveJson)?n.json().then(s=>{const i=n.status||500,a=(s==null?void 0:s.statusCode)||i+"";e(new kh(js(s),i,a))}).catch(s=>{e(new ti(js(s),s))}):e(new ti(js(n),n))}),Dh=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||!r?s:(Nh(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,e!=null&&e.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),t))};function bn(n,e,t,r,s,i){return or(this,void 0,void 0,function*(){return new Promise((a,o)=>{n(t,Dh(e,r,s,i)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>Ph(l,o,r))})})}function ns(n,e,t,r){return or(this,void 0,void 0,function*(){return bn(n,"GET",e,t,r)})}function lt(n,e,t,r,s){return or(this,void 0,void 0,function*(){return bn(n,"POST",e,r,s,t)})}function ni(n,e,t,r,s){return or(this,void 0,void 0,function*(){return bn(n,"PUT",e,r,s,t)})}function xh(n,e,t,r){return or(this,void 0,void 0,function*(){return bn(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function _o(n,e,t,r,s){return or(this,void 0,void 0,function*(){return bn(n,"DELETE",e,r,s,t)})}var $e=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(f){a(f)}}function l(c){try{u(r.throw(c))}catch(f){a(f)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};const Lh={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ra={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Uh{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=vo(s)}uploadOrUpdate(e,t,r,s){return $e(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},ra),s);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=r,o["cache-control"]="max-age=".concat(a.cacheControl),o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const u=this._removeEmptyFolders(t),c=this._getFinalPath(u),f=yield(e=="PUT"?ni:lt)(this.fetch,"".concat(this.url,"/object/").concat(c),i,Object.assign({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(i){if(Ie(i))return{data:null,error:i};throw i}})}upload(e,t,r){return $e(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return $e(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+"/object/upload/sign/".concat(a));o.searchParams.set("token",t);try{let l;const u=Object.assign({upsert:ra.upsert},s),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",u.cacheControl)):(l=r,c["cache-control"]="max-age=".concat(u.cacheControl),c["content-type"]=u.contentType);const f=yield ni(this.fetch,o.toString(),l,{headers:c});return{data:{path:i,fullPath:f.Key},error:null}}catch(l){if(Ie(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return $e(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const i=yield lt(this.fetch,"".concat(this.url,"/object/upload/sign/").concat(r),{},{headers:s}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new bi("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(r){if(Ie(r))return{data:null,error:r};throw r}})}update(e,t,r){return $e(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return $e(this,void 0,void 0,function*(){try{return{data:yield lt(this.fetch,"".concat(this.url,"/object/move"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Ie(s))return{data:null,error:s};throw s}})}copy(e,t,r){return $e(this,void 0,void 0,function*(){try{return{data:{path:(yield lt(this.fetch,"".concat(this.url,"/object/copy"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Ie(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return $e(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield lt(this.fetch,"".concat(this.url,"/object/sign/").concat(s),Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?"&download=".concat(r.download===!0?"":r.download):"";return i={signedUrl:encodeURI("".concat(this.url).concat(i.signedURL).concat(a))},{data:i,error:null}}catch(s){if(Ie(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return $e(this,void 0,void 0,function*(){try{const s=yield lt(this.fetch,"".concat(this.url,"/object/sign/").concat(this.bucketId),{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?"&download=".concat(r.download===!0?"":r.download):"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI("".concat(this.url).concat(a.signedURL).concat(i)):null})),error:null}}catch(s){if(Ie(s))return{data:null,error:s};throw s}})}download(e,t){return $e(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=i?"?".concat(i):"";try{const o=this._getFinalPath(e);return{data:yield(yield ns(this.fetch,"".concat(this.url,"/").concat(s,"/").concat(o).concat(a),{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Ie(o))return{data:null,error:o};throw o}})}info(e){return $e(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield ns(this.fetch,"".concat(this.url,"/object/info/").concat(t),{headers:this.headers});return{data:ri(r),error:null}}catch(r){if(Ie(r))return{data:null,error:r};throw r}})}exists(e){return $e(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield xh(this.fetch,"".concat(this.url,"/object/").concat(t),{headers:this.headers}),{data:!0,error:null}}catch(r){if(Ie(r)&&r instanceof ti){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],i=t!=null&&t.download?"download=".concat(t.download===!0?"":t.download):"";i!==""&&s.push(i);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&s.push(l);let u=s.join("&");return u!==""&&(u="?".concat(u)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(o,"/public/").concat(r).concat(u))}}}remove(e){return $e(this,void 0,void 0,function*(){try{return{data:yield _o(this.fetch,"".concat(this.url,"/object/").concat(this.bucketId),{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Ie(t))return{data:null,error:t};throw t}})}list(e,t,r){return $e(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Lh),t),{prefix:e||""});return{data:yield lt(this.fetch,"".concat(this.url,"/object/list/").concat(this.bucketId),s,{headers:this.headers},r),error:null}}catch(s){if(Ie(s))return{data:null,error:s};throw s}})}listV2(e,t){return $e(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield lt(this.fetch,"".concat(this.url,"/object/list-v2/").concat(this.bucketId),r,{headers:this.headers},t),error:null}}catch(r){if(Ie(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return"".concat(this.bucketId,"/").concat(e.replace(/^\/+/,""))}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push("width=".concat(e.width)),e.height&&t.push("height=".concat(e.height)),e.resize&&t.push("resize=".concat(e.resize)),e.format&&t.push("format=".concat(e.format)),e.quality&&t.push("quality=".concat(e.quality)),t.join("&")}}const Mh="2.11.0",jh={"X-Client-Info":"storage-js/".concat(Mh)};var dr=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(f){a(f)}}function l(c){try{u(r.throw(c))}catch(f){a(f)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};class $h{constructor(e,t={},r,s){const i=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},jh),t),this.fetch=vo(r)}listBuckets(){return dr(this,void 0,void 0,function*(){try{return{data:yield ns(this.fetch,"".concat(this.url,"/bucket"),{headers:this.headers}),error:null}}catch(e){if(Ie(e))return{data:null,error:e};throw e}})}getBucket(e){return dr(this,void 0,void 0,function*(){try{return{data:yield ns(this.fetch,"".concat(this.url,"/bucket/").concat(e),{headers:this.headers}),error:null}}catch(t){if(Ie(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return dr(this,void 0,void 0,function*(){try{return{data:yield lt(this.fetch,"".concat(this.url,"/bucket"),{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Ie(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return dr(this,void 0,void 0,function*(){try{return{data:yield ni(this.fetch,"".concat(this.url,"/bucket/").concat(e),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Ie(r))return{data:null,error:r};throw r}})}emptyBucket(e){return dr(this,void 0,void 0,function*(){try{return{data:yield lt(this.fetch,"".concat(this.url,"/bucket/").concat(e,"/empty"),{},{headers:this.headers}),error:null}}catch(t){if(Ie(t))return{data:null,error:t};throw t}})}deleteBucket(e){return dr(this,void 0,void 0,function*(){try{return{data:yield _o(this.fetch,"".concat(this.url,"/bucket/").concat(e),{},{headers:this.headers}),error:null}}catch(t){if(Ie(t))return{data:null,error:t};throw t}})}}class Ch extends $h{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new Uh(this.url,this.headers,e,this.fetch)}}const Bh="2.56.0";let Kr="";typeof Deno<"u"?Kr="deno":typeof document<"u"?Kr="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Kr="react-native":Kr="node";const Gh={"X-Client-Info":"supabase-js-".concat(Kr,"/").concat(Bh)},Hh={headers:Gh},Fh={schema:"public"},qh={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Vh={};var Kh=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(f){a(f)}}function l(c){try{u(r.throw(c))}catch(f){a(f)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};const Zh=n=>{let e;return n?e=n:typeof fetch>"u"?e=ro:e=fetch,(...t)=>e(...t)},Wh=()=>typeof Headers>"u"?no:Headers,zh=(n,e,t)=>{const r=Zh(t),s=Wh();return(i,a)=>Kh(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:n;let u=new s(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",n),u.has("Authorization")||u.set("Authorization","Bearer ".concat(l)),r(i,Object.assign(Object.assign({},a),{headers:u}))})};var Jh=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(f){a(f)}}function l(c){try{u(r.throw(c))}catch(f){a(f)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};function Yh(n){return n.endsWith("/")?n:n+"/"}function Xh(n,e){var t,r;const{db:s,auth:i,realtime:a,global:o}=n,{db:l,auth:u,realtime:c,global:f}=e,v={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},c),a),storage:{},global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(t=f==null?void 0:f.headers)!==null&&t!==void 0?t:{}),(r=o==null?void 0:o.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>Jh(this,void 0,void 0,function*(){return""})};return n.accessToken?v.accessToken=n.accessToken:delete v.accessToken,v}const yo="2.71.1",vr=30*1e3,si=3,$s=si*vr,Qh="http://localhost:9999",ef="supabase.auth.token",tf={"X-Client-Info":"gotrue-js/".concat(yo)},ii="X-Supabase-Api-Version",bo={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},rf=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,nf=10*60*1e3;class wi extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function ee(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class sf extends wi{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function af(n){return ee(n)&&n.name==="AuthApiError"}class wo extends wi{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Vt extends wi{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class Lt extends Vt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function of(n){return ee(n)&&n.name==="AuthSessionMissingError"}class Kn extends Vt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Zn extends Vt{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Wn extends Vt{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function lf(n){return ee(n)&&n.name==="AuthImplicitGrantRedirectError"}class na extends Vt{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ai extends Vt{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Cs(n){return ee(n)&&n.name==="AuthRetryableFetchError"}class sa extends Vt{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class oi extends Vt{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const ss="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ia=" 	\n\r=".split(""),cf=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<ia.length;e+=1)n[ia[e].charCodeAt(0)]=-2;for(let e=0;e<ss.length;e+=1)n[ss[e].charCodeAt(0)]=e;return n})();function aa(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(ss[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(ss[r]),e.queuedBits-=6}}function Eo(n,e,t){const r=cf[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error('Invalid Base64-URL character "'.concat(String.fromCharCode(n),'"'))}}function oa(n){const e=[],t=a=>{e.push(String.fromCodePoint(a))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=a=>{hf(a,r,t)};for(let a=0;a<n.length;a+=1)Eo(n.charCodeAt(a),s,i);return e.join("")}function uf(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error("Unrecognized Unicode codepoint: ".concat(n.toString(16)))}function df(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}uf(r,e)}}function hf(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if(!(n>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function ff(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)Eo(n.charCodeAt(s),t,r);return new Uint8Array(e)}function pf(n){const e=[];return df(n,t=>e.push(t)),new Uint8Array(e)}function gf(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};return n.forEach(s=>aa(s,t,r)),aa(null,t,r),e.join("")}function mf(n){return Math.round(Date.now()/1e3)+n}function vf(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const rt=()=>typeof window<"u"&&typeof document<"u",Yt={tested:!1,writable:!1},So=()=>{if(!rt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch(e){return!1}if(Yt.tested)return Yt.writable;const n="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Yt.tested=!0,Yt.writable=!0}catch(e){Yt.tested=!0,Yt.writable=!1}return Yt.writable};function _f(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch(r){}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const To=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>_n(async()=>{const{default:r}=await Promise.resolve().then(()=>Nr);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},yf=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",_r=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Xt=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch(r){return t}},xt=async(n,e)=>{await n.removeItem(e)};class ps{constructor(){this.promise=new ps.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}ps.promiseConstructor=Promise;function Bs(n){const e=n.split(".");if(e.length!==3)throw new oi("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!rf.test(e[r]))throw new oi("JWT not in base64url format");return{header:JSON.parse(oa(e[0])),payload:JSON.parse(oa(e[1])),signature:ff(e[2]),raw:{header:e[0],payload:e[1]}}}async function bf(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function wf(n,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await n(i);if(!e(i,null,a)){r(a);return}}catch(a){if(!e(i,a)){s(a);return}}})()})}function Ef(n){return("0"+n.toString(16)).substr(-2)}function Sf(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,Ef).join("")}async function Tf(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function Af(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Tf(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function hr(n,e,t=!1){const r=Sf();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await _r(n,"".concat(e,"-code-verifier"),s);const i=await Af(r);return[i,r===i?"plain":"s256"]}const If=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function kf(n){const e=n.headers.get(ii);if(!e||!e.match(If))return null;try{return new Date("".concat(e,"T00:00:00.0Z"))}catch(t){return null}}function Of(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function Rf(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Nf=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function fr(n){if(!Nf.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Gs(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "'.concat(t,'" property of the session object is not supported. Please use getUser() instead.'))},set:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))},deleteProperty:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))}})}function la(n){return JSON.parse(JSON.stringify(n))}var Pf=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const er=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Df=[502,503,504];async function ca(n){var e;if(!yf(n))throw new ai(er(n),0);if(Df.includes(n.status))throw new ai(er(n),n.status);let t;try{t=await n.json()}catch(i){throw new wo(er(i),i)}let r;const s=kf(n);if(s&&s.getTime()>=bo["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new sa(er(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Lt}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new sa(er(t),n.status,t.weak_password.reasons);throw new sf(er(t),n.status||500,r)}const xf=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function ae(n,e,t,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[ii]||(i[ii]=bo["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization="Bearer ".concat(r.jwt));const a=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Lf(n,e,t+o,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function Lf(n,e,t,r,s,i){const a=xf(e,r,s,i);let o;try{o=await n(t,Object.assign({},a))}catch(l){throw console.error(l),new ai(er(l),0)}if(o.ok||await ca(o),r!=null&&r.noResolveJson)return o;try{return await o.json()}catch(l){await ca(l)}}function At(n){var e;let t=null;$f(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=mf(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function ua(n){const e=At(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function $t(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function Uf(n){return{data:n,error:null}}function Mf(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i}=n,a=Pf(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function jf(n){return n}function $f(n){return n.access_token&&n.refresh_token&&n.expires_in}const Hs=["global","local","others"];var Cf=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class Bf{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=To(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Hs[0]){if(Hs.indexOf(t)<0)throw new Error("@supabase/auth-js: Parameter scope must be one of ".concat(Hs.join(", ")));try{return await ae(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(t),{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ee(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await ae(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:$t})}catch(r){if(ee(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Cf(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await ae(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:s,headers:this.headers,xform:Mf,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(ee(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await ae(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:$t})}catch(t){if(ee(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,i,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},c=await ae(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:jf});if(c.error)throw c.error;const f=await c.json(),v=(a=c.headers.get("x-total-count"))!==null&&a!==void 0?a:0,T=(l=(o=c.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return T.length>0&&(T.forEach(N=>{const D=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),I=JSON.parse(N.split(";")[1].split("=")[1]);u["".concat(I,"Page")]=D}),u.total=parseInt(v)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(ee(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){fr(e);try{return await ae(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:$t})}catch(t){if(ee(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){fr(e);try{return await ae(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:t,headers:this.headers,xform:$t})}catch(r){if(ee(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){fr(e);try{return await ae(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:t},xform:$t})}catch(r){if(ee(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){fr(e.userId);try{const{data:t,error:r}=await ae(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(ee(t))return{data:null,error:t};throw t}}async _deleteFactor(e){fr(e.userId),fr(e.id);try{return{data:await ae(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers}),error:null}}catch(t){if(ee(t))return{data:null,error:t};throw t}}}function da(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function Gf(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(n){typeof self<"u"&&(self.globalThis=self)}}const pr={debug:!!(globalThis&&So()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ao extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Hf extends Ao{}async function Ff(n,e,t){pr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),pr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){pr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{pr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw pr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Hf('Acquiring an exclusive Navigator LockManager lock "'.concat(n,'" immediately failed'));if(pr.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Gf();const qf={url:Qh,storageKey:ef,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:tf,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ha(n,e,t){return await t()}const gr={};class pn{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=pn.nextInstanceID,pn.nextInstanceID+=1,this.instanceID>0&&rt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},qf),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Bf({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=To(s.fetch),this.lock=s.lock||ha,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:rt()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Ff:this.lock=ha,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:So()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=da(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=da(this.memoryStorage)),rt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=gr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){gr[this.storageKey]=Object.assign(Object.assign({},gr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=gr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){gr[this.storageKey]=Object.assign(Object.assign({},gr[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger("GoTrueClient@".concat(this.instanceID," (").concat(yo,") ").concat(new Date().toISOString()),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=_f(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),rt()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),lf(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ee(t)?{error:t}:{error:new wo("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const i=await ae(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:At}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(ee(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,s;try{let i;if("email"in e){const{email:c,password:f,options:v}=e;let T=null,N=null;this.flowType==="pkce"&&([T,N]=await hr(this.storage,this.storageKey)),i=await ae(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:v==null?void 0:v.emailRedirectTo,body:{email:c,password:f,data:(t=v==null?void 0:v.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:T,code_challenge_method:N},xform:At})}else if("phone"in e){const{phone:c,password:f,options:v}=e;i=await ae(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:c,password:f,data:(r=v==null?void 0:v.data)!==null&&r!==void 0?r:{},channel:(s=v==null?void 0:v.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken}},xform:At})}else throw new Zn("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(ee(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await ae(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:ua})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await ae(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:ua})}else throw new Zn("You must provide either an email or phone number and a password");const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Kn}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(ee(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error('@supabase/auth-js: Unsupported chain "'.concat(t,'"'))}async signInWithSolana(e){var t,r,s,i,a,o,l,u,c,f,v,T;let N,D;if("message"in e)N=e.message,D=e.signature;else{const{chain:I,wallet:F,statement:q,options:U}=e;let Y;if(rt())if(typeof F=="object")Y=F;else{const oe=window;if("solana"in oe&&typeof oe.solana=="object"&&("signIn"in oe.solana&&typeof oe.solana.signIn=="function"||"signMessage"in oe.solana&&typeof oe.solana.signMessage=="function"))Y=oe.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof F!="object"||!(U!=null&&U.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");Y=F}const fe=new URL((t=U==null?void 0:U.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in Y&&Y.signIn){const oe=await Y.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},U==null?void 0:U.signInWithSolana),{version:"1",domain:fe.host,uri:fe.href}),q?{statement:q}:null));let ne;if(Array.isArray(oe)&&oe[0]&&typeof oe[0]=="object")ne=oe[0];else if(oe&&typeof oe=="object"&&"signedMessage"in oe&&"signature"in oe)ne=oe;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in ne&&"signature"in ne&&(typeof ne.signedMessage=="string"||ne.signedMessage instanceof Uint8Array)&&ne.signature instanceof Uint8Array)N=typeof ne.signedMessage=="string"?ne.signedMessage:new TextDecoder().decode(ne.signedMessage),D=ne.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in Y)||typeof Y.signMessage!="function"||!("publicKey"in Y)||typeof Y!="object"||!Y.publicKey||!("toBase58"in Y.publicKey)||typeof Y.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");N=["".concat(fe.host," wants you to sign in with your Solana account:"),Y.publicKey.toBase58(),...q?["",q,""]:[""],"Version: 1","URI: ".concat(fe.href),"Issued At: ".concat((s=(r=U==null?void 0:U.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()),...!((i=U==null?void 0:U.signInWithSolana)===null||i===void 0)&&i.notBefore?["Not Before: ".concat(U.signInWithSolana.notBefore)]:[],...!((a=U==null?void 0:U.signInWithSolana)===null||a===void 0)&&a.expirationTime?["Expiration Time: ".concat(U.signInWithSolana.expirationTime)]:[],...!((o=U==null?void 0:U.signInWithSolana)===null||o===void 0)&&o.chainId?["Chain ID: ".concat(U.signInWithSolana.chainId)]:[],...!((l=U==null?void 0:U.signInWithSolana)===null||l===void 0)&&l.nonce?["Nonce: ".concat(U.signInWithSolana.nonce)]:[],...!((u=U==null?void 0:U.signInWithSolana)===null||u===void 0)&&u.requestId?["Request ID: ".concat(U.signInWithSolana.requestId)]:[],...!((f=(c=U==null?void 0:U.signInWithSolana)===null||c===void 0?void 0:c.resources)===null||f===void 0)&&f.length?["Resources",...U.signInWithSolana.resources.map(ne=>"- ".concat(ne))]:[]].join("\n");const oe=await Y.signMessage(new TextEncoder().encode(N),"utf8");if(!oe||!(oe instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");D=oe}}try{const{data:I,error:F}=await ae(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"solana",message:N,signature:gf(D)},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(T=e.options)===null||T===void 0?void 0:T.captchaToken}}:null),xform:At});if(F)throw F;return!I||!I.session||!I.user?{data:{user:null,session:null},error:new Kn}:(I.session&&(await this._saveSession(I.session),await this._notifyAllSubscribers("SIGNED_IN",I.session)),{data:Object.assign({},I),error:F})}catch(I){if(ee(I))return{data:{user:null,session:null},error:I};throw I}}async _exchangeCodeForSession(e){const t=await Xt(this.storage,"".concat(this.storageKey,"-code-verifier")),[r,s]=(t!=null?t:"").split("/");try{const{data:i,error:a}=await ae(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:At});if(await xt(this.storage,"".concat(this.storageKey,"-code-verifier")),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Kn}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s!=null?s:null}),error:a})}catch(i){if(ee(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:i,nonce:a}=e,o=await ae(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:At}),{data:l,error:u}=o;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Kn}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(t){if(ee(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,i,a;try{if("email"in e){const{email:o,options:l}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await hr(this.storage,this.storageKey));const{error:f}=await ae(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:o,options:l}=e,{data:u,error:c}=await ae(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:o,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new Zn("You must provide either an email or phone number.")}catch(o){if(ee(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,r;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:o}=await ae(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:At});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,u=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(ee(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await hr(this.storage,this.storageKey)),await ae(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:Uf})}catch(i){if(ee(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Lt;const{error:s}=await ae(this.fetch,"GET","".concat(this.url,"/reauthenticate"),{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(ee(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t="".concat(this.url,"/resend");if("email"in e){const{email:r,type:s,options:i}=e,{error:a}=await ae(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:a,error:o}=await ae(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new Zn("You must provide either an email or phone number and a type")}catch(t){if(ee(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(i){}})()),s}return await this.lock("lock:".concat(this.storageKey),e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch(s){}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Xt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<$s:!1;if(this._debug("#__loadSession()","session has".concat(r?"":" not"," expired"),"expires_at",e.expires_at),!r){if(this.userStorage){const a=await Xt(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=Gs()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,c)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,c))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ae(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:$t}):await this._useSession(async t=>{var r,s,i;const{data:a,error:o}=t;if(o)throw o;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Lt}:await ae(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:$t})})}catch(t){if(ee(t))return of(t)&&(await this._removeSession(),await xt(this.storage,"".concat(this.storageKey,"-code-verifier"))),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new Lt;const a=s.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await hr(this.storage,this.storageKey));const{data:u,error:c}=await ae(this.fetch,"PUT","".concat(this.url,"/user"),{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:$t});if(c)throw c;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(r){if(ee(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Lt;const t=Date.now()/1e3;let r=t,s=!0,i=null;const{payload:a}=Bs(e.access_token);if(a.exp&&(r=a.exp,s=r<=t),s){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(ee(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Lt;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(ee(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!rt())throw new Wn("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Wn(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new na("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Wn("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new na("No code detected.");const{data:q,error:U}=await this._exchangeCodeForSession(e.code);if(U)throw U;const Y=new URL(window.location.href);return Y.searchParams.delete("code"),window.history.replaceState(window.history.state,"",Y.toString()),{data:{session:q.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:u}=e;if(!i||!o||!a||!u)throw new Wn("No session defined in URL");const c=Math.round(Date.now()/1e3),f=parseInt(o);let v=c+f;l&&(v=parseInt(l));const T=v-c;T*1e3<=vr&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(T,"s, should have been closer to ").concat(f,"s"));const N=v-f;c-N>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",N,v,c):c-N<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",N,v,c);const{data:D,error:I}=await this._getUser(i);if(I)throw I;const F={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:f,expires_at:v,refresh_token:a,token_type:u,user:D.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:F,redirectType:e.type},error:null}}catch(r){if(ee(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Xt(this.storage,"".concat(this.storageKey,"-code-verifier"));return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{error:i};const a=(r=s.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(af(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await xt(this.storage,"".concat(this.storageKey,"-code-verifier"))),{error:null}})}onAuthStateChange(e){const t=vf(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:i},error:a}=t;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await hr(this.storage,this.storageKey,!0));try{return await ae(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(ee(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(ee(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:s}=await this._useSession(async i=>{var a,o,l,u,c;const{data:f,error:v}=i;if(v)throw v;const T=await this._getUrlForProvider("".concat(this.url,"/user/identities/authorize"),e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ae(this.fetch,"GET",T,{headers:this.headers,jwt:(c=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(s)throw s;return rt()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(ee(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:a}=t;if(a)throw a;return await ae(this.fetch,"DELETE","".concat(this.url,"/user/identities/").concat(e.identity_id),{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(ee(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t="#_refreshAccessToken(".concat(e.substring(0,5),"...)");this._debug(t,"begin");try{const r=Date.now();return await wf(async s=>(s>0&&await bf(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await ae(this.fetch,"POST","".concat(this.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:this.headers,xform:At})),(s,i)=>{const a=200*Math.pow(2,s);return i&&Cs(i)&&Date.now()+a-r<vr})}catch(r){if(this._debug(t,"error",r),ee(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider("".concat(this.url,"/authorize"),e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),rt()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await Xt(this.storage,this.storageKey);if(s&&this.userStorage){let a=await Xt(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:s.user},await _r(this.userStorage,this.storageKey+"-user",a)),s.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:Gs()}else if(s&&!s.user&&!s.user){const a=await Xt(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(s.user=a.user,await xt(this.storage,this.storageKey+"-user"),await _r(this.storage,this.storageKey,s)):s.user=Gs()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const i=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<$s;if(this._debug(r,"session has".concat(i?"":" not"," expired with margin of ").concat($s,"s")),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),Cs(a)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(s.access_token);!o&&(a!=null&&a.user)?(s.user=a.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(r,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Lt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s="#_callRefreshToken(".concat(e.substring(0,5),"...)");this._debug(s,"begin");try{this.refreshingDeferred=new ps;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new Lt;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),ee(i)){const a={session:null,error:i};return Cs(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s="#_notifyAllSubscribers(".concat(e,")");this._debug(s,"begin",t,"broadcast = ".concat(r));try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await _r(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const i=la(s);await _r(this.storage,this.storageKey,i)}else{const s=la(t);await _r(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await xt(this.storage,this.storageKey),await xt(this.storage,this.storageKey+"-code-verifier"),await xt(this.storage,this.storageKey+"-user"),this.userStorage&&await xt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&rt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),vr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/vr);this._debug("#_autoRefreshTokenTick()","access token expires in ".concat(s," ticks, a tick lasts ").concat(vr,"ms, refresh threshold is ").concat(si," ticks")),s<=si&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Ao)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!rt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t="#_onVisibilityChanged(".concat(e,")");this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=["provider=".concat(encodeURIComponent(t))];if(r!=null&&r.redirectTo&&s.push("redirect_to=".concat(encodeURIComponent(r.redirectTo))),r!=null&&r.scopes&&s.push("scopes=".concat(encodeURIComponent(r.scopes))),this.flowType==="pkce"){const[i,a]=await hr(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(i)),code_challenge_method:"".concat(encodeURIComponent(a))});s.push(o.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push("skip_http_redirect=".concat(r.skipBrowserRedirect)),"".concat(e,"?").concat(s.join("&"))}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await ae(this.fetch,"DELETE","".concat(this.url,"/factors/").concat(e.factorId),{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(ee(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await ae(this.fetch,"POST","".concat(this.url,"/factors"),{body:o,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code="data:image/svg+xml;utf-8,".concat(l.totp.qr_code)),{data:l,error:null})})}catch(t){if(ee(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:o}=await ae(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/verify"),{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(ee(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await ae(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/challenge"),{body:{channel:e.channel},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(ee(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],s=r.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=r.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:r,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Bs(s.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(f=>f.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const c=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(o=>o.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(o=>o.kid===e),r&&this.jwks_cached_at+nf>s)return r;const{data:i,error:a}=await ae(this.fetch,"GET","".concat(this.url,"/.well-known/jwks.json"),{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,r=i.keys.find(o=>o.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:T,error:N}=await this.getSession();if(N||!T.session)return{data:null,error:N};r=T.session.access_token}const{header:s,payload:i,signature:a,raw:{header:o,payload:l}}=Bs(r);t!=null&&t.allowExpired||Of(i.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!u){const{error:T}=await this.getUser(r);if(T)throw T;return{data:{claims:i,header:s,signature:a},error:null}}const c=Rf(s.alg),f=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,f,a,pf("".concat(o,".").concat(l))))throw new oi("Invalid JWT signature");return{data:{claims:i,header:s,signature:a},error:null}}catch(r){if(ee(r))return{data:null,error:r};throw r}}}pn.nextInstanceID=0;const Vf=pn;class Kf extends Vf{constructor(e){super(e)}}var Zf=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(c){try{u(r.next(c))}catch(f){a(f)}}function l(c){try{u(r.throw(c))}catch(f){a(f)}}function u(c){c.done?i(c.value):s(c.value).then(o,l)}u((r=r.apply(n,e||[])).next())})};class Wf{constructor(e,t,r){var s,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=Yh(e),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u="sb-".concat(l.hostname.split(".")[0],"-auth-token"),c={db:Fh,realtime:Vh,auth:Object.assign(Object.assign({},qh),{storageKey:u}),global:Hh},f=Xh(r!=null?r:{},c);this.storageKey=(s=f.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(v,T)=>{throw new Error("@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.".concat(String(T)," is not possible"))}})):this.auth=this._initSupabaseAuthClient((a=f.auth)!==null&&a!==void 0?a:{},this.headers,f.global.fetch),this.fetch=zh(t,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new ch(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new Ch(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new Bd(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Zf(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:i,flowType:a,lock:o,debug:l},u,c){const f={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new Kf({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:a,lock:o,debug:l,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Ih(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const zf=(n,e,t)=>new Wf(n,e,t);function Jf(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Jf()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");class Yf extends gn{constructor(t){super();ue(this,"client");ue(this,"roomsChannel",null);ue(this,"playersChannel",null);ue(this,"connected",!1);const r=(t==null?void 0:t.url)||void 0||"",s=(t==null?void 0:t.anonKey)||void 0||"";if(!r||!s){console.warn("🔧 No Supabase config found, using local-only mode"),this.client=null;return}this.client=zf(r,s),console.log("🔗 Supabase client initialized")}async initialize(){if(!this.client)return console.log("🔧 Running in local-only mode"),!1;try{const{error:t}=await this.client.from("rooms").select("count",{count:"exact",head:!0});return t?(console.error("❌ Supabase connection failed:",t),!1):(await this.setupRealTimeSubscriptions(),this.connected=!0,console.log("✅ Connected to Supabase"),!0)}catch(t){return console.error("❌ Failed to initialize Supabase:",t),!1}}async setupRealTimeSubscriptions(){this.client&&(this.roomsChannel=this.client.channel("rooms").on("postgres_changes",{event:"*",schema:"public",table:"rooms"},t=>{console.log("🏠 Room change:",t),this.emit("roomUpdate",t)}).subscribe(),this.playersChannel=this.client.channel("players").on("postgres_changes",{event:"*",schema:"public",table:"room_players"},t=>{console.log("👤 Player change:",t),this.emit("playerUpdate",t)}).subscribe(),console.log("📡 Real-time subscriptions active"))}async createRoom(t){var r;if(!this.client)return!1;try{const{error:s}=await this.client.from("rooms").insert([{id:t.id,name:t.name,game_type:t.gameType,max_players:t.maxPlayers,status:t.status,is_private:t.isPrivate,created_at:t.created.toISOString(),last_activity:t.lastActivity.toISOString(),host_id:(r=t.players.find(i=>i.isHost))==null?void 0:r.id}]);return s?(console.error("❌ Failed to create room:",s),!1):(await this.addPlayersToRoom(t.id,t.players),console.log("✅ Room created:",t.id),!0)}catch(s){return console.error("❌ Error creating room:",s),!1}}async joinRoom(t,r){if(!this.client)return!1;try{const{error:s}=await this.client.from("room_players").insert([{room_id:t,player_id:r.id,player_name:r.name,player_avatar:r.avatar,is_host:r.isHost||!1,is_ready:r.isReady||!1,joined_at:new Date().toISOString()}]);return s?(console.error("❌ Failed to join room:",s),!1):(await this.client.from("rooms").update({last_activity:new Date().toISOString()}).eq("id",t),console.log("✅ Player joined room:",t),!0)}catch(s){return console.error("❌ Error joining room:",s),!1}}async leaveRoom(t,r){if(!this.client)return!1;try{const{error:s}=await this.client.from("room_players").delete().eq("room_id",t).eq("player_id",r);if(s)return console.error("❌ Failed to leave room:",s),!1;const{data:i}=await this.client.from("room_players").select("player_id").eq("room_id",t);return(!i||i.length===0)&&(await this.client.from("rooms").delete().eq("id",t),console.log("🗑️ Deleted empty room:",t)),console.log("✅ Player left room:",t),!0}catch(s){return console.error("❌ Error leaving room:",s),!1}}async getPublicRooms(){if(!this.client)return[];try{const{data:t,error:r}=await this.client.from("rooms").select("\n          *,\n          room_players (\n            player_id,\n            player_name,\n            player_avatar,\n            is_host,\n            is_ready\n          )\n        ").eq("is_private",!1).eq("status","waiting").order("last_activity",{ascending:!1});return r?(console.error("❌ Failed to get rooms:",r),[]):t.map(s=>({id:s.id,name:s.name,gameType:s.game_type,players:s.room_players.map(i=>({id:i.player_id,name:i.player_name,avatar:i.player_avatar,isHost:i.is_host,isReady:i.is_ready})),maxPlayers:s.max_players,status:s.status,isPrivate:s.is_private,created:new Date(s.created_at),lastActivity:new Date(s.last_activity)}))}catch(t){return console.error("❌ Error getting rooms:",t),[]}}async getRoom(t){if(!this.client)return null;try{const{data:r,error:s}=await this.client.from("rooms").select("\n          *,\n          room_players (\n            player_id,\n            player_name,\n            player_avatar,\n            is_host,\n            is_ready\n          )\n        ").eq("id",t).single();return s||!r?(console.error("❌ Room not found:",t,s),null):{id:r.id,name:r.name,gameType:r.game_type,players:r.room_players.map(i=>({id:i.player_id,name:i.player_name,avatar:i.player_avatar,isHost:i.is_host,isReady:i.is_ready})),maxPlayers:r.max_players,status:r.status,isPrivate:r.is_private,created:new Date(r.created_at),lastActivity:new Date(r.last_activity)}}catch(r){return console.error("❌ Error getting room:",r),null}}async updatePlayerReady(t,r,s){if(!this.client)return!1;try{const{error:i}=await this.client.from("room_players").update({is_ready:s}).eq("room_id",t).eq("player_id",r);return i?(console.error("❌ Failed to update ready status:",i),!1):(console.log("✅ Player ready status updated:",r,s),!0)}catch(i){return console.error("❌ Error updating ready status:",i),!1}}async addPlayersToRoom(t,r){if(!this.client||!r.length)return;const s=r.map(a=>({room_id:t,player_id:a.id,player_name:a.name,player_avatar:a.avatar,is_host:a.isHost||!1,is_ready:a.isReady||!1,joined_at:new Date().toISOString()})),{error:i}=await this.client.from("room_players").insert(s);i&&console.error("❌ Failed to add players to room:",i)}isConnected(){return this.connected}async disconnect(){var t,r;this.roomsChannel&&await((t=this.client)==null?void 0:t.removeChannel(this.roomsChannel)),this.playersChannel&&await((r=this.client)==null?void 0:r.removeChannel(this.playersChannel)),this.connected=!1,console.log("🔌 Disconnected from Supabase")}}class Xf extends gn{constructor(t,r){var s;super();ue(this,"gameId");ue(this,"players");ue(this,"currentPlayerIndex");ue(this,"gameState");ue(this,"moves");ue(this,"isStarted");ue(this,"isFinished");this.gameId=t,this.players=r,this.currentPlayerIndex=0,this.moves=[],this.isStarted=!1,this.isFinished=!1,this.gameState={gameId:t,currentPlayer:((s=r[0])==null?void 0:s.id)||"",players:r,status:"waiting",data:this.initializeGameData(),moves:[],timestamp:new Date}}startGame(){return this.players.length<this.getConfig().minPlayers?!1:(this.isStarted=!0,this.gameState.status="playing",this.gameState.timestamp=new Date,this.emit("gameStarted",this.gameState),!0)}addPlayer(t){return this.players.length>=this.getConfig().maxPlayers||this.isStarted?!1:(this.players.push(t),this.gameState.players=[...this.players],this.emit("playerJoined",t),!0)}removePlayer(t){const r=this.players.findIndex(i=>i.id===t);if(r===-1)return!1;const s=this.players.splice(r,1)[0];return this.gameState.players=[...this.players],this.currentPlayerIndex>=r&&(this.currentPlayerIndex=Math.max(0,this.currentPlayerIndex-1)),this.emit("playerLeft",s),this.isStarted&&this.players.length<this.getConfig().minPlayers&&this.endGame("abandoned"),!0}attemptMove(t,r){if(!this.isStarted||this.isFinished||this.gameState.currentPlayer!==r||!this.isValidMove(t,r)||!this.makeMove(t))return!1;t.sequence=this.moves.length,t.timestamp=new Date,this.moves.push(t),this.gameState.moves=[...this.moves];const i=this.checkGameEnd();return i.isGameOver?this.endGame("completed",i.winner,i.reason):this.nextPlayer(),this.gameState.timestamp=new Date,this.emit("moveMade",t),!0}nextPlayer(){this.currentPlayerIndex=(this.currentPlayerIndex+1)%this.players.length,this.gameState.currentPlayer=this.players[this.currentPlayerIndex].id}endGame(t,r,s){this.isFinished=!0,this.gameState.status="finished",this.gameState.winner=r,this.gameState.timestamp=new Date,this.emit("gameEnded",{gameId:this.gameId,winner:r,reason:t,details:s,gameState:this.gameState})}getState(){return{...this.gameState}}getPlayers(){return[...this.players]}getCurrentPlayer(){return this.players[this.currentPlayerIndex]||null}getMoves(){return[...this.moves]}isPlayerTurn(t){return this.gameState.currentPlayer===t}getGameId(){return this.gameId}hasPlayer(t){return this.players.some(r=>r.id===t)}canStart(){return!this.isStarted&&this.players.length>=this.getConfig().minPlayers&&this.players.length<=this.getConfig().maxPlayers}}const be=class be extends Xf{getConfig(){return{id:"connect4",name:"connect4",displayName:"Connect 4",description:"Drop pieces to connect 4 in a row - horizontally, vertically, or diagonally!",minPlayers:2,maxPlayers:2,estimatedDuration:"5-10 minutes",difficulty:"easy",category:"board",thumbnail:"🔴",rules:"\n# Connect 4 Rules\n\n## Objective\nBe the first player to connect 4 of your pieces in a row - horizontally, vertically, or diagonally.\n\n## How to Play\n1. Players take turns dropping colored pieces into columns\n2. Pieces fall to the lowest available position in the chosen column\n3. First player to get 4 pieces in a row wins!\n4. If the board fills up with no winner, it's a draw\n\n## Strategy Tips\n- Block your opponent's potential winning moves\n- Try to create multiple winning threats at once\n- Control the center columns for more opportunities\n      ".trim()}}initializeGameData(){const e=[];for(let t=0;t<be.ROWS;t++){e[t]=[];for(let r=0;r<be.COLS;r++)e[t][r]=be.EMPTY}return{board:e,rows:be.ROWS,cols:be.COLS,winningCells:[],moveCount:0}}isValidMove(e,t){const r=e.data;return r.column<0||r.column>=be.COLS?!1:this.gameState.data.board[0][r.column]===be.EMPTY}makeMove(e){const t=e.data,r=this.gameState.data,s=this.getPlayerIndex(e.playerId);if(s===-1)return!1;let i=-1;for(let o=be.ROWS-1;o>=0;o--)if(r.board[o][t.column]===be.EMPTY){i=o;break}if(i===-1)return!1;const a=s+1;return r.board[i][t.column]=a,r.lastMove={row:i,col:t.column,player:a},r.moveCount++,this.gameState.data=r,!0}checkGameEnd(){const e=this.gameState.data;if(!e.lastMove)return{isGameOver:!1};const t=this.checkWinFromPosition(e.lastMove.row,e.lastMove.col,e.lastMove.player,e.board);if(t.hasWin){e.winningCells=t.winningCells;const r=e.lastMove.player-1;return{isGameOver:!0,winner:this.players[r].id,reason:"Connected ".concat(be.CONNECT_COUNT," pieces!")}}return this.isBoardFull(e.board)?{isGameOver:!0,reason:"Board is full - it's a draw!"}:{isGameOver:!1}}getGameStateForPlayer(e){var s;const t=this.gameState.data,r=this.getPlayerIndex(e);return{board:t.board.map(i=>[...i]),isYourTurn:this.isPlayerTurn(e),playerNumber:r+1,currentPlayer:((s=this.getCurrentPlayer())==null?void 0:s.name)||"",moveCount:t.moveCount,lastMove:t.lastMove,winningCells:t.winningCells,availableColumns:this.getAvailableColumns(t.board)}}serialize(){return JSON.stringify({gameState:this.gameState,moves:this.moves,players:this.players,currentPlayerIndex:this.currentPlayerIndex,isStarted:this.isStarted,isFinished:this.isFinished})}deserialize(e){try{const t=JSON.parse(e);return this.gameState=t.gameState,this.moves=t.moves,this.players=t.players,this.currentPlayerIndex=t.currentPlayerIndex,this.isStarted=t.isStarted,this.isFinished=t.isFinished,!0}catch(t){return console.error("Failed to deserialize Connect4 game:",t),!1}}getPlayerIndex(e){return this.players.findIndex(t=>t.id===e)}checkWinFromPosition(e,t,r,s){const i=[[0,1],[1,0],[1,1],[1,-1]];for(const[a,o]of i){const l=this.checkDirection(e,t,a,o,r,s);if(l.length>=be.CONNECT_COUNT)return{hasWin:!0,winningCells:l}}return{hasWin:!1,winningCells:[]}}checkDirection(e,t,r,s,i,a){const o=[{row:e,col:t,player:i}];let l=e+r,u=t+s;for(;this.isValidPosition(l,u)&&a[l][u]===i;)o.push({row:l,col:u,player:i}),l+=r,u+=s;for(l=e-r,u=t-s;this.isValidPosition(l,u)&&a[l][u]===i;)o.unshift({row:l,col:u,player:i}),l-=r,u-=s;return o}isValidPosition(e,t){return e>=0&&e<be.ROWS&&t>=0&&t<be.COLS}isBoardFull(e){for(let t=0;t<be.COLS;t++)if(e[0][t]===be.EMPTY)return!1;return!0}getAvailableColumns(e){const t=[];for(let r=0;r<be.COLS;r++)e[0][r]===be.EMPTY&&t.push(r);return t}getBoardState(){return this.gameState.data.board.map(t=>[...t])}getWinningCells(){return[...this.gameState.data.winningCells]}getAvailableMoves(){const e=this.gameState.data;return this.getAvailableColumns(e.board)}getMoveCount(){return this.gameState.data.moveCount}getLastMove(){return this.gameState.data.lastMove}};ue(be,"EMPTY",0),ue(be,"ROWS",6),ue(be,"COLS",7),ue(be,"CONNECT_COUNT",4);let is=be;class Qf extends gn{constructor(){super();ue(this,"lobby");ue(this,"discordService");ue(this,"supabaseService");ue(this,"currentPlayer",null);ue(this,"currentRoom",null);this.supabaseService=new Yf,this.lobby=new Ul(this.supabaseService),this.discordService=new Ld({clientId:"1407945986424307713",scopes:["identify","guilds"],forceDiscordMode:!1}),this.setupEventHandlers(),this.registerGames()}setupEventHandlers(){this.discordService.on("connected",t=>{this.currentPlayer={id:t.id,name:t.globalName||t.username,avatar:t.avatar?"https://cdn.discordapp.com/avatars/".concat(t.id,"/").concat(t.avatar,".png"):void 0},this.lobby.addPlayer(this.currentPlayer),this.emit("playerConnected",this.currentPlayer)}),this.discordService.on("disconnected",()=>{this.currentPlayer&&this.lobby.removePlayer(this.currentPlayer.id),this.currentPlayer=null,this.emit("playerDisconnected")}),this.lobby.on("broadcast",t=>{this.emit("lobbyMessage",t)})}registerGames(){this.lobby.registerGame(new is("temp",[]).getConfig(),is)}async initialize(){try{console.log("🚀 Initializing Game Hub...");const t=await this.supabaseService.initialize(),r=await this.discordService.initialize();return console.log("✅ Game Hub initialized (Discord: ".concat(r?"Connected":"Demo Mode",", Backend: ").concat(t?"Supabase":"Local Only",")")),this.emit("initialized",{discordConnected:r,backendConnected:t,isMultiplayer:t}),!0}catch(t){return console.error("❌ Failed to initialize Game Hub:",t),this.emit("error",t),!1}}getAvailableGames(){return this.lobby.getAvailableGames()}async getPublicRooms(){return await this.lobby.getPublicRooms()}async createRoom(t,r){if(!this.currentPlayer)return null;const s=await this.lobby.createRoom(this.currentPlayer.id,t,r);return s&&(this.currentRoom=s,this.discordService.updateActivity("Creating ".concat(t," game"),"Setting up room")),s}async joinRoom(t){if(!this.currentPlayer)return!1;const r=await this.lobby.joinRoom(this.currentPlayer.id,t);if(r){this.currentRoom=t;const s=await this.lobby.getRoom(t);s&&this.discordService.updateActivity("Joining ".concat(s.gameType," game"),"Waiting for game to start")}return r}leaveRoom(){if(!this.currentPlayer||!this.currentRoom)return!1;const t=this.lobby.leaveRoom(this.currentPlayer.id,this.currentRoom);return t&&(this.currentRoom=null,this.discordService.updateActivity("In lobby","Looking for games")),t}setReady(t){return!this.currentPlayer||!this.currentRoom?!1:this.lobby.setPlayerReady(this.currentPlayer.id,this.currentRoom,t)}makeMove(t){return!this.currentPlayer||!this.currentRoom?!1:this.lobby.makeMove(this.currentPlayer.id,this.currentRoom,t)}getCurrentPlayer(){return this.currentPlayer}async getCurrentRoom(){return this.currentRoom?await this.lobby.getRoom(this.currentRoom):null}getCurrentGame(){return this.currentRoom?this.lobby.getGame(this.currentRoom):null}isInRoom(){return this.currentRoom!==null}getDiscordService(){return this.discordService}getLobbyStats(){return this.lobby.getStats()}destroy(){this.currentPlayer&&this.lobby.removePlayer(this.currentPlayer.id),this.discordService.disconnect(),this.removeAllListeners(),console.log("🧹 Game Hub destroyed")}}class Io{constructor(){ue(this,"gameHub");this.gameHub=new Qf,this.setupEventHandlers()}setupEventHandlers(){this.gameHub.on("initialized",e=>{this.showLobby(),this.updateConnectionStatus(e.discordConnected)}),this.gameHub.on("playerConnected",e=>{this.updatePlayerInfo(e)}),this.gameHub.on("lobbyMessage",e=>{this.handleLobbyMessage(e)}),this.gameHub.on("error",e=>{console.error("Game Hub Error:",e),this.showError("Failed to connect to game services")})}async initialize(){try{console.log("🎮 Starting Discord Game App..."),this.showLoading(),await this.gameHub.initialize()}catch(e){console.error("Failed to initialize app:",e),this.showError("Failed to start the application")}}showLoading(){const e=document.getElementById("app");e&&(e.innerHTML='\n        <div class="loading-screen">\n          <div class="loading-content">\n            <div class="loading-spinner"></div>\n            <h2>🎮 Discord Game Hub</h2>\n            <p>Connecting to game services...</p>\n          </div>\n        </div>\n      ')}showLobby(){const e=document.getElementById("app");e&&(e.innerHTML='\n        <div class="lobby-screen">\n          <header class="lobby-header">\n            <div class="header-content">\n              <h1>🎮 Discord Game Hub</h1>\n              <div class="player-info" id="player-info">\n                <div class="player-avatar" id="player-avatar"></div>\n                <span id="player-name">Loading...</span>\n              </div>\n            </div>\n            <div class="connection-status" id="connection-status">\n              <span class="status-indicator"></span>\n              <span class="status-text">Connecting...</span>\n            </div>\n          </header>\n\n          <main class="lobby-main">\n            <div class="lobby-sidebar">\n              <h3>🎯 Available Games</h3>\n              <div class="game-list" id="game-list">\n                Loading games...\n              </div>\n              \n              <div class="lobby-stats" id="lobby-stats">\n                <h4>📊 Lobby Stats</h4>\n                <div class="stats-content">\n                  <div class="stat">\n                    <span class="stat-label">Players Online:</span>\n                    <span class="stat-value" id="players-count">0</span>\n                  </div>\n                  <div class="stat">\n                    <span class="stat-label">Active Games:</span>\n                    <span class="stat-value" id="games-count">0</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div class="lobby-content">\n              <div class="room-list-section">\n                <div class="section-header">\n                  <h3>🏠 Open Rooms</h3>\n                  <button class="btn btn-primary" id="refresh-rooms">🔄 Refresh</button>\n                </div>\n                <div class="room-list" id="room-list">\n                  <div class="empty-state">\n                    <p>No open rooms yet. Create one to get started!</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </main>\n\n          <div class="create-room-modal" id="create-room-modal" style="display: none;">\n            <div class="modal-content">\n              <div class="modal-header">\n                <h3>Create New Room</h3>\n                <button class="btn-close" id="close-modal">×</button>\n              </div>\n              <div class="modal-body">\n                <div class="form-group">\n                  <label for="game-type">Game Type:</label>\n                  <select id="game-type" class="form-control">\n                    <option value="">Select a game...</option>\n                  </select>\n                </div>\n                <div class="form-group">\n                  <label for="room-name">Room Name (optional):</label>\n                  <input type="text" id="room-name" class="form-control" placeholder="My awesome game room">\n                </div>\n              </div>\n              <div class="modal-footer">\n                <button class="btn btn-secondary" id="cancel-create">Cancel</button>\n                <button class="btn btn-primary" id="confirm-create">Create Room</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      '),this.setupLobbyEventHandlers(),this.loadAvailableGames(),this.refreshRooms(),this.updateLobbyStats()}setupLobbyEventHandlers(){const e=document.getElementById("refresh-rooms");e==null||e.addEventListener("click",()=>this.refreshRooms());const t=document.getElementById("game-list");t==null||t.addEventListener("click",o=>{const l=o.target;if(l.classList.contains("create-game-btn")){const u=l.dataset.gameType;u&&this.showCreateRoomModal(u)}});const r=document.getElementById("close-modal"),s=document.getElementById("cancel-create"),i=document.getElementById("confirm-create");r==null||r.addEventListener("click",()=>this.hideCreateRoomModal()),s==null||s.addEventListener("click",()=>this.hideCreateRoomModal()),i==null||i.addEventListener("click",()=>this.handleCreateRoom());const a=document.getElementById("room-list");a==null||a.addEventListener("click",o=>{const l=o.target;if(l.classList.contains("join-room-btn")){const u=l.dataset.roomId;u&&this.joinRoom(u)}})}loadAvailableGames(){const e=document.getElementById("game-list");if(!e)return;const t=this.gameHub.getAvailableGames();if(t.length===0){e.innerHTML="<p>No games available</p>";return}e.innerHTML=t.map(r=>'\n      <div class="game-card">\n        <div class="game-info">\n          <div class="game-icon">'.concat(r.thumbnail,'</div>\n          <div class="game-details">\n            <h4>').concat(r.displayName,'</h4>\n            <p class="game-description">').concat(r.description,'</p>\n            <div class="game-meta">\n              <span class="players">').concat(r.minPlayers,"-").concat(r.maxPlayers,' players</span>\n              <span class="duration">').concat(r.estimatedDuration,'</span>\n            </div>\n          </div>\n        </div>\n        <button class="btn btn-primary create-game-btn" data-game-type="').concat(r.id,'">\n          Create Room\n        </button>\n      </div>\n    ')).join("")}async refreshRooms(){const e=document.getElementById("room-list");if(!e)return;const t=await this.gameHub.getPublicRooms();if(t.length===0){e.innerHTML='\n        <div class="empty-state">\n          <p>No open rooms yet. Create one to get started!</p>\n        </div>\n      ';return}e.innerHTML=t.map(r=>'\n      <div class="room-card">\n        <div class="room-info">\n          <h4>'.concat(r.name,'</h4>\n          <div class="room-meta">\n            <span class="game-type">').concat(r.gameType,'</span>\n            <span class="players">').concat(r.players.length,"/").concat(r.maxPlayers,' players</span>\n            <span class="created">').concat(this.formatTime(r.created),'</span>\n          </div>\n          <div class="room-players">\n            ').concat(r.players.map(s=>'<span class="player-tag">'.concat(s.name,"</span>")).join(""),'\n          </div>\n        </div>\n        <button class="btn btn-success join-room-btn" data-room-id="').concat(r.id,'">\n          Join Room\n        </button>\n      </div>\n    ')).join("")}showCreateRoomModal(e){const t=document.getElementById("create-room-modal"),r=document.getElementById("game-type");if(t&&r){const s=this.gameHub.getAvailableGames();r.innerHTML=s.map(i=>'<option value="'.concat(i.id,'" ').concat(i.id===e?"selected":"",">").concat(i.displayName,"</option>")).join(""),t.style.display="flex"}}hideCreateRoomModal(){const e=document.getElementById("create-room-modal");e&&(e.style.display="none")}async handleCreateRoom(){var s,i;const e=(s=document.getElementById("game-type"))==null?void 0:s.value,t=(i=document.getElementById("room-name"))==null?void 0:i.value;if(!e){alert("Please select a game type");return}const r=await this.gameHub.createRoom(e,t||void 0);r?(this.hideCreateRoomModal(),console.log("Created room: ".concat(r)),await this.showGameRoom(r)):alert("Failed to create room")}async joinRoom(e){await this.gameHub.joinRoom(e)?(console.log("Joined room: ".concat(e)),await this.showGameRoom(e)):alert("Failed to join room")}async showGameRoom(e){const t=await this.gameHub.getCurrentRoom();if(!t){console.error("No room data found");return}const r=document.getElementById("app");r&&(r.innerHTML='\n        <div class="game-room">\n          <header class="room-header">\n            <div class="room-info">\n              <h2>🎮 '.concat(t.name,"</h2>\n              <p>Game: ").concat(t.gameType," • Status: ").concat(t.status,'</p>\n            </div>\n            <button class="btn btn-secondary" id="leave-room">← Leave Room</button>\n          </header>\n\n          <div class="room-content">\n            <div class="game-area">\n              <div class="players-bar">\n                ').concat(t.players.map(s=>'\n                  <div class="player-info '.concat(s.isHost?"host":""," ").concat(s.isReady?"ready":"",'">\n                    <div class="player-avatar">\n                      ').concat(s.avatar?'<img src="'.concat(s.avatar,'" alt="').concat(s.name,'">'):"👤",'\n                    </div>\n                    <span class="player-name">').concat(s.name,"</span>\n                    ").concat(s.isHost?'<span class="host-badge">HOST</span>':"","\n                    ").concat(s.isReady?'<span class="ready-badge">✓</span>':'<span class="not-ready-badge">⏳</span>',"\n                  </div>\n                ")).join(""),"\n              </div>\n\n              ").concat(t.status==="waiting"?'\n                <div class="waiting-area">\n                  <h3>Waiting for players...</h3>\n                  <p>Players: '.concat(t.players.length,"/").concat(t.maxPlayers,'</p>\n                  <div class="waiting-controls">\n                    <button class="btn btn-success" id="ready-toggle">\n                      ').concat(this.isPlayerReady(t)?"Not Ready":"Ready","\n                    </button>\n                    ").concat(this.isCurrentPlayerHost(t)?'<button class="btn btn-primary" id="start-game">Start Game</button>':"","\n                  </div>\n                </div>\n              "):t.gameType==="connect4"?'\n                <div class="connect4-game">\n                  <div id="connect4-board" class="connect4-board">\n                    <!-- Game board will be rendered here -->\n                  </div>\n                </div>\n              ':'\n                <div class="game-placeholder">\n                  <p>Game interface for '.concat(t.gameType," coming soon!</p>\n                </div>\n              "),'\n            </div>\n\n            <div class="room-sidebar">\n              <div class="room-chat">\n                <h4>Room Chat</h4>\n                <div class="chat-messages" id="chat-messages">\n                  <div class="system-message">Welcome to ').concat(t.name,'!</div>\n                </div>\n                <div class="chat-input">\n                  <input type="text" id="chat-input" placeholder="Type a message...">\n                  <button id="send-chat">Send</button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      '),this.setupRoomEventHandlers(),t.status==="playing"&&t.gameType==="connect4"&&this.renderConnect4Game())}setupRoomEventHandlers(){const e=document.getElementById("leave-room"),t=document.getElementById("ready-toggle"),r=document.getElementById("start-game"),s=document.getElementById("chat-input"),i=document.getElementById("send-chat");e==null||e.addEventListener("click",()=>{confirm("Are you sure you want to leave this room?")&&(this.gameHub.leaveRoom(),this.showLobby())}),t==null||t.addEventListener("click",async()=>{const a=await this.gameHub.getCurrentRoom(),o=this.isPlayerReady(a);this.gameHub.setReady(!o),setTimeout(async()=>await this.showGameRoom((a==null?void 0:a.id)||""),100)}),r==null||r.addEventListener("click",()=>{console.log("Starting game...")}),s==null||s.addEventListener("keypress",a=>{a.key==="Enter"&&(this.sendChatMessage(s.value),s.value="")}),i==null||i.addEventListener("click",()=>{s.value.trim()&&(this.sendChatMessage(s.value),s.value="")})}renderConnect4Game(){console.log("Rendering Connect4 game...")}isPlayerReady(e){const t=this.gameHub.getCurrentPlayer(),r=e==null?void 0:e.players.find(s=>s.id===(t==null?void 0:t.id));return(r==null?void 0:r.isReady)||!1}isCurrentPlayerHost(e){const t=this.gameHub.getCurrentPlayer(),r=e==null?void 0:e.players.find(s=>s.id===(t==null?void 0:t.id));return(r==null?void 0:r.isHost)||!1}sendChatMessage(e){const t=document.getElementById("chat-messages"),r=this.gameHub.getCurrentPlayer();if(t&&r){const s=document.createElement("div");s.className="chat-message",s.innerHTML='\n        <span class="message-author">'.concat(r.name,':</span>\n        <span class="message-text">').concat(e,"</span>\n      "),t.appendChild(s),t.scrollTop=t.scrollHeight}}updateConnectionStatus(e){const t=document.querySelector(".status-indicator"),r=document.querySelector(".status-text");t&&r&&(e?(t.className="status-indicator connected",r.textContent="Connected to Discord"):(t.className="status-indicator demo",r.textContent="Demo Mode"))}updatePlayerInfo(e){const t=document.getElementById("player-name"),r=document.getElementById("player-avatar");t&&(t.textContent=e.name),r&&e.avatar&&(r.innerHTML='<img src="'.concat(e.avatar,'" alt="').concat(e.name,'" class="avatar-img">'))}updateLobbyStats(){const e=this.gameHub.getLobbyStats(),t=document.getElementById("players-count"),r=document.getElementById("games-count");t&&(t.textContent=e.totalPlayers.toString()),r&&(r.textContent=e.gamesInProgress.toString()),setTimeout(()=>this.updateLobbyStats(),5e3)}handleLobbyMessage(e){switch(console.log("Lobby message:",e),e.type){case"game_created":case"player_joined":case"player_left":this.refreshRooms();break}}showError(e){const t=document.getElementById("app");t&&(t.innerHTML='\n        <div class="error-screen">\n          <div class="error-content">\n            <h2>❌ Error</h2>\n            <p>'.concat(e,'</p>\n            <button class="btn btn-primary" onclick="location.reload()">Retry</button>\n          </div>\n        </div>\n      '))}formatTime(e){const r=new Date().getTime()-e.getTime(),s=Math.floor(r/6e4);if(s<1)return"Just now";if(s<60)return"".concat(s,"m ago");const i=Math.floor(s/60);if(i<24)return"".concat(i,"h ago");const a=Math.floor(i/24);return"".concat(a,"d ago")}}document.addEventListener("DOMContentLoaded",()=>{new Io().initialize()});window.gameApp=Io;export{tp as __vite_legacy_guard};
//# sourceMappingURL=index-B4jTYd3-.js.map
